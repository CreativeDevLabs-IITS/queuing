import{ad as It,ae as e,r as o,af as je,ag as Tt,ah as pt,ai as ut,aj as Dt,ak as zt,al as Rt,am as nt,an as ge,ao as Wt,ap as Pt,aq as xt,ar as gt,as as Xe,at as ot,au as ft,av as At,aw as Et,ax as ht,ay as mt,az as Bt,aA as Nt,aB as Lt,aC as Ot,aD as Mt,aE as Ft,aF as Ut,aG as Vt,aH as Oe,aI as Me,aJ as at,aK as Ht,aL as _e,aM as Ze,aN as qt,aO as $t,aP as ve,aQ as Yt,R as _t,aR as Gt}from"./vendor-C_KfLnct.js";import{R as Ae,B as et,C as qe,X as $e,Y as Ye,T as Ee,a as tt,P as yt,b as bt,c as vt,L as Qt,d as Kt}from"./recharts-SttVB7A8.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const k of d.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&n(k)}).observe(document,{childList:!0,subtree:!0});function i(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(a){if(a.ep)return;a.ep=!0;const d=i(a);fetch(a.href,d)}})();const Jt="/api",C=It.create({baseURL:Jt,headers:{"Content-Type":"application/json"}});C.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t});C.interceptors.response.use(t=>t,t=>{var i,n,a;const r=(i=t.response)==null?void 0:i.status;if(r===401||r===403){localStorage.removeItem("token"),localStorage.removeItem("user");const d=window.location.pathname;if(d.startsWith("/admin"))d!=="/admin/login"&&(window.location.href="/admin/login");else if(d.startsWith("/staff")&&d!=="/staff/login"){const f=((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.code)==="STAFF_LOGOUT_9PM"?"?reason=logout_9pm":"";window.location.href="/staff/login"+f}}return Promise.reject(t)});function ze(){const t=localStorage.getItem("user");if(t==null||t===""||t==="undefined")return null;try{return JSON.parse(t)}catch{return null}}const it="queueEntry",st="queueDate",wt=t=>{const r=new Date().toISOString().split("T")[0];localStorage.setItem(it,JSON.stringify(t)),localStorage.setItem(st,r)},Ge=()=>{const t=localStorage.getItem(it),r=localStorage.getItem(st),i=new Date().toISOString().split("T")[0];if(!t||r!==i)return r!==i&&Fe(),null;try{return JSON.parse(t)}catch{return Fe(),null}},Fe=()=>{localStorage.removeItem(it),localStorage.removeItem(st)};function le({label:t,error:r,style:i,disabled:n,...a}){const d={width:"100%",padding:"12px",borderRadius:"8px",border:r?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",transition:"border-color 0.2s",...n&&{background:"#f1f5f9",color:"#64748b",cursor:"not-allowed"},...i};return e.jsxs("div",{style:{marginBottom:"16px"},children:[t&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:t}),e.jsx("input",{style:d,disabled:n,...a}),r&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:r})]})}function M({children:t,onClick:r,variant:i="primary",disabled:n=!1,fullWidth:a=!1,icon:d,iconPosition:k="left",type:f,style:c,...x}){const u={padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",opacity:n?.6:1,width:a?"100%":"auto",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:i==="primary"||i==="success"||i==="danger"||i==="gradient"?"0 2px 4px rgba(0,0,0,0.1)":"none",...c},s={primary:{background:n?"#cbd5e1":"#2563eb",color:"white"},gradient:{background:n?"#cbd5e1":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",boxShadow:n?"none":"0 4px 12px rgba(102, 126, 234, 0.4)"},secondary:{background:n?"#cbd5e1":"#64748b",color:"white"},success:{background:n?"#cbd5e1":"#10b981",color:"white"},danger:{background:n?"#cbd5e1":"#ef4444",color:"white"},outline:{background:"transparent",color:n?"#cbd5e1":"#2563eb",border:`2px solid ${n?"#cbd5e1":"#2563eb"}`}},v=s[i]||s.primary,w=d&&e.jsx(d,{size:18,strokeWidth:2.5}),R=k==="left"?e.jsxs(e.Fragment,{children:[" ",w," ",t," "]}):e.jsxs(e.Fragment,{children:[" ",t," ",w," "]});return e.jsx("button",{type:f||"button",style:{...u,...v},onClick:n?void 0:r,disabled:n,onMouseOver:g=>{n||(i==="primary"?(g.target.style.background="#1e40af",g.target.style.boxShadow="0 4px 8px rgba(37, 99, 235, 0.3)"):i==="outline"?g.target.style.background="#eff6ff":i==="danger"?(g.target.style.background="#dc2626",g.target.style.boxShadow="0 4px 8px rgba(239, 68, 68, 0.3)"):i==="success"?(g.target.style.background="#059669",g.target.style.boxShadow="0 4px 8px rgba(16, 185, 129, 0.3)"):i==="gradient"&&(g.target.style.background="linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)",g.target.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)"))},onMouseOut:g=>{n||(g.target.style.background=v.background,g.target.style.boxShadow=i==="gradient"?"0 4px 12px rgba(102, 126, 234, 0.4)":i==="primary"||i==="success"||i==="danger"?"0 2px 4px rgba(0,0,0,0.1)":"none")},...x,children:R})}function Se(){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #2563eb",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})}function Ce({size:t="medium",showText:r=!0,gap:i="12px"}){const[n,a]=o.useState(null),[d,k]=o.useState(!0),[f,c]=o.useState(!1);o.useEffect(()=>{x();const v=setInterval(x,3e4);return()=>clearInterval(v)},[]);const x=async()=>{try{const v=await C.get("/admin/settings/logo");if(v.data.logoUrl){let w=v.data.logoUrl;w&&!w.startsWith("http")&&!w.startsWith("/")&&(w="/"+w);const R=w.includes("?")?"&":"?";w=w+R+"_t="+Date.now(),a(w),c(!1)}else a(null),c(!1)}catch(v){console.error("Failed to load logo:",v),c(!0)}finally{k(!1)}},u={small:{width:"80px",height:"40px"},medium:{width:"120px",height:"60px"},large:{width:"180px",height:"90px"},monitor:{width:"88px",height:"80px"}},s=u[t]||u.medium;return d?null:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i},children:[n&&!f?e.jsx("img",{src:n,alt:"Logo",style:{...s,objectFit:"contain",maxWidth:"100%"},onError:v=>{console.error("Failed to load logo image:",n),c(!0),a(null)}}):e.jsx("div",{style:{...s,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",fontWeight:"700",fontSize:t==="small"?"14px":t==="large"?"24px":"18px"},children:"Q"}),r&&e.jsx("span",{style:{fontSize:t==="small"?"18px":t==="large"?"28px":"24px",fontWeight:"700",color:"#1e293b"}})]})}const Xt=[{value:"REGULAR",label:"Regular"},{value:"SENIOR_CITIZEN",label:"Senior Citizen"},{value:"PWD",label:"PWD"},{value:"PREGNANT",label:"Pregnant"}];function Zt(){var N;const t=je(),[r,i]=o.useState(!0),[n,a]=o.useState(!1),[d,k]=o.useState([]),[f,c]=o.useState({clientName:"",clientType:"REGULAR",categoryIds:[],subCategoryIds:[]}),[x,u]=o.useState({});o.useEffect(()=>{s()},[]);const s=async()=>{var y;try{const l=await C.get("/categories");k(Array.isArray((y=l.data)==null?void 0:y.categories)?l.data.categories:[])}catch(l){console.error("Failed to load categories:",l)}finally{i(!1)}},v=o.useMemo(()=>{var D;if(!((D=f.categoryIds)!=null&&D.length))return[];const y=(d||[]).filter(B=>f.categoryIds.includes(B.id)),l=new Map;return y.forEach(B=>{(B.subCategories||[]).forEach(j=>{l.has(j.id)||l.set(j.id,{...j,categoryName:B.name})})}),Array.from(l.values())},[f.categoryIds,d]),w=y=>{const l=f.categoryIds||[],D=l.includes(y)?l.filter(V=>V!==y):[...l,y],B=(d||[]).filter(V=>D.includes(V.id)),j=new Set;B.forEach(V=>{(V.subCategories||[]).forEach(q=>j.add(q.id))}),c({...f,categoryIds:D,subCategoryIds:(f.subCategoryIds||[]).filter(V=>j.has(V))})},R=y=>{const l=f.subCategoryIds||[],D=l.includes(y)?l.filter(B=>B!==y):[...l,y];c({...f,subCategoryIds:D})},g=async y=>{var D,B,j,V;y.preventDefault(),u({});const l={};if(f.clientName.trim()||(l.clientName="Name is required"),(D=f.categoryIds)!=null&&D.length||(l.categoryId="Select at least one category"),Object.keys(l).length>0){u(l);return}a(!0);try{const Z=(await C.post("/queue/join",{clientName:f.clientName.trim(),clientType:f.clientType,categoryIds:f.categoryIds,subCategoryIds:(B=f.subCategoryIds)!=null&&B.length?f.subCategoryIds:void 0})).data.queueEntry,de=(Z.concernCategories||[Z.category]).map(ie=>ie.name).join(", "),se=(Z.concernSubCategories||[]).map(ie=>ie.name).join(", ")||null;wt({queueNumber:Z.queueNumber,clientName:Z.clientName,date:Z.date,category:de,subCategory:se,clientType:Z.clientType,status:Z.status}),t("/success")}catch(q){console.error("Failed to join queue:",q),u({submit:((V=(j=q.response)==null?void 0:j.data)==null?void 0:V.error)||"Failed to join queue"})}finally{a(!1)}};return r?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})}):e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(Ce,{size:"medium"})}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Join Queue"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Fill in your details to get a queue number"}),e.jsxs("form",{onSubmit:g,children:[e.jsx(le,{label:"Your Name",value:f.clientName,onChange:y=>c({...f,clientName:y.target.value}),error:x.clientName,placeholder:"Enter your full name",required:!0}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Client Type"}),e.jsx("div",{className:"client-type-pills",children:Xt.map(({value:y,label:l})=>e.jsxs("label",{className:`pill-radio ${f.clientType===y?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"clientType",value:y,checked:f.clientType===y,onChange:()=>c({...f,clientType:y})}),e.jsx("span",{children:l})]},y))})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:["Concern Category ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),x.categoryId&&e.jsx("div",{style:{fontSize:"12px",color:"#ef4444",marginBottom:"8px"},children:x.categoryId}),e.jsx("div",{className:"checkbox-group",children:(d||[]).map(y=>e.jsxs("label",{className:`checkbox-row ${(f.categoryIds||[]).includes(y.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(f.categoryIds||[]).includes(y.id),onChange:()=>w(y.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:y.name})]},y.id))})]}),v.length>0&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Sub-Concern (Optional)"}),e.jsx("div",{className:"checkbox-group",children:v.map(y=>e.jsxs("label",{className:`checkbox-row ${(f.subCategoryIds||[]).includes(y.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(f.subCategoryIds||[]).includes(y.id),onChange:()=>R(y.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:y.name})]},y.id))})]}),x.submit&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:x.submit}),e.jsx(M,{type:"submit",variant:"gradient",fullWidth:!0,disabled:n||!f.clientType||!((N=f.categoryIds)!=null&&N.length),style:{marginTop:"8px",padding:"14px 24px",fontSize:"16px"},children:n?"Joining...":"Join Queue"})]}),e.jsx("div",{style:{marginTop:"24px",textAlign:"center"},children:e.jsx("a",{href:"/monitor",style:{color:"#2563eb",textDecoration:"none",fontSize:"14px"},children:"View Queue Status â†’"})})]})})}function Qe(t){if(!t)return"";const r=t.split("-");return r.length>1?r[1]:t}function en(t){return t?t.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):""}function jt({window:t,compact:r=!1}){const{label:i,staff:n,currentServing:a}=t,d=x=>{const u=x.trim().split(" ");return u.length>=2?(u[0][0]+u[u.length-1][0]).toUpperCase():x.substring(0,2).toUpperCase()},k=(n==null?void 0:n.name)||"â€”",f=a?Qe(a.queueNumber):null,c=a&&[a.clientName||"",a.clientType?`(${en(a.clientType)})`:""].filter(Boolean).join(" ").trim()||null;return e.jsxs("div",{style:{background:"#0b1120",borderRadius:"12px",padding:0,boxShadow:"0 4px 12px rgba(15,23,42,0.6)",border:"1px solid #1e293b",transition:"all 0.2s",display:"flex",alignItems:"stretch",minHeight:r?0:"96px",flex:1,overflow:"hidden"},children:[e.jsx("div",{style:{flex:"0 0 34%",maxWidth:"110px",borderRadius:"12px",background:n!=null&&n.profilePicture?void 0:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:n!=null&&n.profilePicture?e.jsx("img",{src:n.profilePicture,alt:k,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}}):e.jsx("span",{style:{color:"white",fontWeight:"700",fontSize:"24px"},children:d(k)})}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0,padding:"6px 8px 6px 8px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#e5e7eb",marginBottom:"2px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k}),a?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#cbd5f5",marginBottom:"4px"},children:"is now serving:"}),e.jsx("div",{style:{fontSize:"clamp(22px, 2.8vw, 34px)",fontWeight:"700",color:"#fbbf24",lineHeight:1.05,marginBottom:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:f}),c&&e.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#cbd5f5",marginBottom:"4px",maxHeight:"2.6em",overflow:"hidden"},children:c})]}):e.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748b",fontStyle:"italic"},children:"No active service"}),e.jsx("div",{style:{marginTop:"auto",paddingTop:"2px",fontSize:"15px",fontWeight:"700",color:"#38bdf8",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i})]})]})}function St({clientType:t}){const r={REGULAR:{bg:"#e2e8f0",color:"#475569"},SENIOR_CITIZEN:{bg:"#fef3c7",color:"#92400e"},PWD:{bg:"#dbeafe",color:"#1e40af"},PREGNANT:{bg:"#fce7f3",color:"#9f1239"}},i={REGULAR:"Regular",SENIOR_CITIZEN:"Senior",PWD:"PWD",PREGNANT:"Pregnant"},n=r[t]||r.REGULAR;return e.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:n.bg,color:n.color},children:i[t]})}function tn(){const t=je(),[r,i]=o.useState(null),[n,a]=o.useState([]),[d,k]=o.useState(!0),[f,c]=o.useState(0);o.useEffect(()=>{const v=Ge();if(!v){t("/");return}i(v),x();const w=setInterval(x,2e3);return()=>clearInterval(w)},[t]),o.useEffect(()=>{(r==null?void 0:r.status)==="SERVED"&&t("/thank-you")},[r==null?void 0:r.status,t]);const x=async()=>{var v;try{const w=Ge()||r;if(w!=null&&w.queueNumber){const N=(await C.get(`/queue/${w.queueNumber}`)).data.queueEntry,y={...w,status:N.status};if(i(y),wt(y),N.status==="SERVED"){t("/thank-you");return}if(N.status==="WAITING")try{const l=await C.get(`/queue/${w.queueNumber}/ahead`);c(l.data.peopleAhead||0)}catch{const D=await C.get("/queue/public/stats");c(D.data.waiting||0)}else c(0)}const R=await C.get("/queue/public/windows");a(R.data.windows)}catch(w){console.error("Failed to load data:",w),((v=w.response)==null?void 0:v.status)===404&&(Fe(),t("/"))}finally{k(!1)}};if(d||!r)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})});const u={WAITING:{bg:"#fef3c7",color:"#92400e",text:"Waiting"},NOW_SERVING:{bg:"#dbeafe",color:"#1e40af",text:"Being served"},SERVED:{bg:"#d1fae5",color:"#065f46",text:"Served"},SKIPPED:{bg:"#fee2e2",color:"#991b1b",text:"Skipped"}},s=u[r.status]||u.WAITING;return e.jsx("div",{style:{minHeight:"100vh",background:"#f8fafc",padding:"20px"},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(Ce,{size:"medium"})}),e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:["Hello, ",r.clientName]}),e.jsx("div",{style:{fontSize:"48px",fontWeight:"700",color:"#2563eb",marginBottom:"16px",letterSpacing:"2px"},children:Qe(r.queueNumber)}),e.jsx("div",{style:{display:"inline-block",padding:"8px 16px",borderRadius:"20px",backgroundColor:s.bg,color:s.color,fontSize:"14px",fontWeight:"600",marginBottom:"16px"},children:s.text}),e.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(St,{clientType:r.clientType}),e.jsxs("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:"#e2e8f0",color:"#475569"},children:[r.category,r.subCategory&&` - ${r.subCategory}`]})]}),r.status==="WAITING"&&f>0&&e.jsxs("div",{style:{marginTop:"16px",fontSize:"14px",color:"#64748b"},children:["Approximately ",f," ",f===1?"person":"people"," ahead"]}),e.jsx("div",{style:{marginTop:"24px",padding:"16px",background:"#f1f5f9",borderRadius:"8px",fontSize:"14px",color:"#475569"},children:"ðŸ’¡ You can leave and monitor your queue status from this page. We'll update automatically."})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px",color:"#1e293b"},children:"Active Windows"}),e.jsx("div",{className:"grid-responsive",style:{display:"grid",gap:"16px"},children:n.length>0?n.map(v=>e.jsx(jt,{window:v},v.id)):e.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",color:"#64748b"},children:"No active windows at the moment"})})]})]})})}function nn(){const t=je();o.useEffect(()=>{const i=Ge();if(!i||i.status!=="SERVED"){t("/");return}const n=setTimeout(()=>{Fe()},5e3);return()=>clearTimeout(n)},[t]);const r=Ge();return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"48px",maxWidth:"600px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(Ce,{size:"medium"})}),e.jsx("div",{style:{fontSize:"64px",marginBottom:"24px"},children:"âœ…"}),e.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"16px",color:"#1e293b"},children:"Thank You!"}),r&&e.jsxs("p",{style:{fontSize:"18px",color:"#64748b",marginBottom:"24px"},children:["Thank you, ",e.jsx("strong",{children:r.clientName}),", for your visit."]}),e.jsx("p",{style:{fontSize:"16px",color:"#475569",marginBottom:"32px",lineHeight:"1.6"},children:"We appreciate your business and look forward to serving you again."}),e.jsx("div",{style:{padding:"20px",background:"#f1f5f9",borderRadius:"12px",marginBottom:"32px"},children:e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:"Your service has been completed. Have a wonderful day!"})}),e.jsx("button",{onClick:()=>{Fe(),t("/")},style:{padding:"12px 32px",borderRadius:"8px",border:"none",background:"#2563eb",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:i=>{i.target.style.background="#1e40af"},onMouseOut:i=>{i.target.style.background="#2563eb"},children:"Return to Home"})]})})}function on(){const[t,r]=o.useState([]),[i,n]=o.useState([]),[a,d]=o.useState(null),[k,f]=o.useState(!0),[c,x]=o.useState(!1),[u,s]=o.useState("youtube"),[v,w]=o.useState(null),R=o.useRef(null),g=o.useRef(null),N=o.useRef(null),y=o.useRef([]);y.current=i;const l=o.useRef([]),D=o.useRef(!1),B=o.useRef([]),j=o.useRef(!1),V=o.useRef(null),q=o.useRef(0),Z=8e3,de=.5,[se,ie]=o.useState(null),pe=o.useRef(null),m=o.useRef(!1),T=o.useRef(null),[G,H]=o.useState(!1),[P,U]=o.useState(50);o.useEffect(()=>{h(),L();const b=setInterval(h,2e3);return()=>clearInterval(b)},[]),o.useEffect(()=>{Ue()},[]),o.useEffect(()=>{i.length>0&&!m.current&&H(!0)},[i]);const X=o.useRef(null);o.useEffect(()=>{const b=()=>{var A;return(A=X.current)==null?void 0:A.call(X)};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[]),o.useEffect(()=>{i.length>0&&!a&&d(i[0])},[i,a]),o.useEffect(()=>()=>{i.forEach(b=>{b._blobUrl&&b.url&&URL.revokeObjectURL(b.url)})},[i]),o.useEffect(()=>{if(u!=="local"||!R.current||!a)return;const b=R.current,A=()=>{const Y=(i.findIndex(Q=>Q.url===a.url)+1)%i.length;d(i[Y])};b.addEventListener("ended",A),b.volume=de,b.load();const I=b.play();return I!==void 0&&I.then(()=>{b.muted=!1}).catch(()=>{b.muted=!0,b.play().catch(console.error)}),()=>b.removeEventListener("ended",A)},[a,i,u]),o.useEffect(()=>{var Y;if(u!=="youtube"||!(a!=null&&a.id))return;const b=Q=>{if(g.current){g.current.loadVideoById(Q);const z=Math.max(0,Math.min(100,P))/100;g.current.setVolume(Math.round(z*100));return}const K=N.current;if(!K)return;const ee=document.createElement("div");ee.id="youtube-player-"+Date.now(),K.innerHTML="",K.appendChild(ee),g.current=new window.YT.Player(ee.id,{videoId:Q,width:"100%",height:"100%",playerVars:{autoplay:1,mute:1,rel:0,modestbranding:1},events:{onReady:z=>{const ae=Math.max(0,Math.min(100,P))/100;z.target.setVolume(Math.round(ae*100)),m.current&&z.target.unMute()},onStateChange:z=>{if(z.data===0){const ae=y.current,ce=(ae.findIndex(ne=>ne.id===Q)+1)%ae.length;ae[ce]&&d(ae[ce])}}}})};if((Y=window.YT)!=null&&Y.Player)return b(a.id),()=>{};if(window.YTLoadReady)return window.YT.ready(()=>b(a.id)),()=>{};const A=document.createElement("script");A.src="https://www.youtube.com/iframe_api";const I=document.getElementsByTagName("script")[0];I.parentNode.insertBefore(A,I);const $=window.onYouTubeIframeAPIReady;return window.onYouTubeIframeAPIReady=()=>{window.YTLoadReady=!0,$&&$(),b(a.id)},()=>{}},[a,i,u,P]),o.useEffect(()=>()=>{if(g.current){try{g.current.destroy()}catch{}g.current=null}N.current&&(N.current.innerHTML="")},[]);const h=async()=>{try{const A=(await C.get("/queue/public/windows")).data.windows||[],I=l.current;r(A),l.current=A,setTimeout(()=>{try{ke(I,A)}catch($){console.error("Failed to run TTS announcements:",$)}},0)}catch(b){console.error("Failed to load windows:",b)}finally{f(!1)}},L=async()=>{try{const A=(await C.get("/admin/settings/ding-sound")).data.dingSoundUrl||null;ie(A),pe.current=A}catch(b){console.error("Failed to load ding sound URL:",b),ie(null),pe.current=null}},oe=b=>{if(typeof window>"u"){console.log("playDing: window undefined"),b&&setTimeout(b,7e3);return}console.log("playDing: starting");let I=!1,$=null;$=setTimeout(()=>{if(!I&&(console.warn("playDing: Ultimate timeout reached, forcing safeDone"),I=!0,b))try{b()}catch(Q){console.error("playDing: Error in onDone callback:",Q)}},7e3);const Y=()=>{if(I){console.log("playDing: safeDone called but already done");return}if(I=!0,$&&(clearTimeout($),$=null),console.log("playDing: done - calling onDone callback"),b)try{b()}catch(Q){console.error("playDing: Error in onDone callback:",Q)}else console.warn("playDing: No onDone callback provided")};try{const Q=pe.current||se;if(Q&&typeof Q=="string"){const ee=Q.startsWith("http")?Q:`${window.location.origin}${Q.startsWith("/")?"":"/"}${Q}`;console.log("playDing: Using custom ding sound:",ee);const z=new Audio(ee);z.volume=1;let ae=!1;const xe=()=>{if(I)return;console.log("playDing: Trying synthesized chime fallback");const ye=window.AudioContext||window.webkitAudioContext;if(!ye){console.warn("playDing: No AudioContext available"),Y();return}let p=T.current;if(!p)try{p=new ye,p.state,T.current=p}catch(E){console.warn("playDing: Cannot create AudioContext (needs user gesture):",E),I||Y();return}if(!p){console.warn("playDing: No AudioContext available"),I||Y();return}const S=()=>{if(!I)try{console.log("playDing: Playing synthesized chime");const E=p.createOscillator(),O=p.createOscillator(),J=p.createGain();E.type="sine",O.type="sine";const fe=p.currentTime;E.frequency.setValueAtTime(880,fe),O.frequency.setValueAtTime(1175,fe+.08),E.connect(J),O.connect(J),J.connect(p.destination),J.gain.setValueAtTime(1e-4,fe),J.gain.exponentialRampToValueAtTime(.25,fe+.03),J.gain.exponentialRampToValueAtTime(1e-4,fe+.4),E.start(fe),O.start(fe+.08),E.stop(fe+.4),O.stop(fe+.4),setTimeout(()=>{I||(console.log("playDing: Synthesized chime finished"),Y())},500)}catch(E){console.error("playDing: Failed to play chime:",E),I||Y()}};p.state==="suspended"&&p.resume?p.resume().then(()=>{I||S()}).catch(E=>{console.warn("playDing: AudioContext resume failed:",E),I||Y()}):S()},ce=()=>{if(I)return;console.log("playDing: Audio ended event fired, currentTime:",z.currentTime,"duration:",z.duration),z.removeEventListener("ended",ce),z.removeEventListener("error",ne),z.removeEventListener("canplaythrough",me),z.removeEventListener("loadeddata",me),z.currentTime>=Math.min(.1,z.duration*.1)||z.duration===0?(console.log("playDing: Custom ding played successfully"),ae=!0,Y()):(console.warn("playDing: Custom ding ended immediately, trying fallback chime"),xe())},ne=ye=>{console.error("Failed to play custom ding sound:",ye),z.removeEventListener("ended",ce),z.removeEventListener("error",ne),z.removeEventListener("canplaythrough",me),z.removeEventListener("loadeddata",me),xe()},be=()=>{console.log("playDing: Audio ready, attempting to play, readyState:",z.readyState,"duration:",z.duration,"currentTime:",z.currentTime),z.currentTime=0,setTimeout(()=>{const ye=z.play();ye!==void 0?ye.then(()=>{console.log("playDing: Audio playing successfully, paused:",z.paused,"currentTime:",z.currentTime,"duration:",z.duration),setTimeout(()=>{z.paused&&!I&&!ae?(console.warn("playDing: Audio paused after play() promise resolved, may be blocked by autoplay policy. Will try fallback chime."),ne(new Error("Autoplay blocked"))):z.paused||console.log("playDing: Audio confirmed playing, currentTime:",z.currentTime)},100)}).catch(p=>{console.error("Failed to start custom ding sound:",p),ne(p)}):(console.warn("playDing: play() returned undefined"),setTimeout(()=>{z.paused&&!I&&!ae&&(console.warn("playDing: Audio is paused after play(), treating as error. Will try fallback chime."),ne(new Error("Audio did not start playing")))},100))},10)},me=()=>{z.removeEventListener("canplaythrough",me),z.removeEventListener("loadeddata",me),be()};z.addEventListener("ended",ce),z.addEventListener("error",ne),z.readyState>=2?(console.log("playDing: Audio already loaded, playing immediately"),be()):(z.addEventListener("canplaythrough",me),z.addEventListener("loadeddata",me),z.load()),setTimeout(()=>{!I&&!ae&&(console.warn("playDing: Custom ding timeout (2s), trying fallback chime"),z.removeEventListener("ended",ce),z.removeEventListener("error",ne),z.removeEventListener("canplaythrough",me),z.removeEventListener("loadeddata",me),xe())},2e3);return}const K=window.AudioContext||window.webkitAudioContext;if(K){const ee=T.current||new K,z=()=>{console.log("playDing: Playing synthesized chime");const ae=ee.createOscillator(),xe=ee.createOscillator(),ce=ee.createGain();ae.type="sine",xe.type="sine";const ne=ee.currentTime;ae.frequency.setValueAtTime(880,ne),xe.frequency.setValueAtTime(1175,ne+.08),ae.connect(ce),xe.connect(ce),ce.connect(ee.destination),ce.gain.setValueAtTime(1e-4,ne),ce.gain.exponentialRampToValueAtTime(.25,ne+.03),ce.gain.exponentialRampToValueAtTime(1e-4,ne+.4),ae.start(ne),xe.start(ne+.08),ae.stop(ne+.4),xe.stop(ne+.4),setTimeout(()=>{console.log("playDing: Synthesized chime finished"),Y()},500)};ee.state==="suspended"&&ee.resume?ee.resume().then(()=>{z()}).catch(()=>{z()}):z();return}console.warn("playDing: No AudioContext available, cannot play chime"),Y()}catch(Q){console.error("Failed to play ding sound:",Q)}setTimeout(Y,7e3)},W=b=>{const A=R.current;A&&(A.volume=Math.max(0,Math.min(1,b)));const I=g.current;I&&typeof I.setVolume=="function"&&I.setVolume(Math.round(Math.max(0,Math.min(1,b))*100))},_=(b,A)=>{if(typeof window<"u"&&window.speechSynthesis){window.speechSynthesis.cancel();const I=new SpeechSynthesisUtterance(b);I.lang="en-US",I.rate=1,I.pitch=1,I.onend=A,I.onerror=A,window.speechSynthesis.speak(I)}else A()},re=b=>new Promise(A=>{if(!b||typeof b!="string"||!b.trim()){console.warn("TTS: Empty or invalid text provided"),A();return}C.post("/tts",{text:b},{responseType:"arraybuffer"}).then(I=>{const $=I.headers&&I.headers["content-type"]||"",Y=$.includes("audio/")||$.includes("mpeg");if(I.status!==200||!Y||!I.data){console.warn("TTS: Invalid response, falling back to speechSynthesis"),_(b,A);return}const Q=I.data,K=new Blob([Q],{type:"audio/mpeg"}),ee=URL.createObjectURL(K),z=new Audio(ee);z.volume=1;const ae=()=>{z.src="",z.removeEventListener("ended",xe),z.removeEventListener("error",ce),setTimeout(()=>URL.revokeObjectURL(ee),100)},xe=()=>{ae(),A()},ce=be=>{console.error("TTS audio playback error:",be),ae(),_(b,A)};z.addEventListener("ended",xe),z.addEventListener("error",ce);const ne=z.play();ne!==void 0&&ne.catch(be=>{console.error("TTS audio play() failed:",be),ae(),_(b,A)})}).catch(I=>{console.error("TTS API call failed:",I),_(b,A)})}),he=()=>new Promise(b=>oe(b)),ue=async()=>{if(j.current){console.log("Already processing announcement, skipping");return}if(B.current.length===0){console.log("No announcements in queue");return}console.log(`Processing announcement, queue length: ${B.current.length}`),j.current=!0;const b=B.current.shift();if(!b){console.log("No item to process"),j.current=!1,B.current.length>0&&ue();return}const{text:A}=b;console.log("Starting announcement:",A);try{W(.05),console.log("Playing ding..."),await he(),console.log("Ding finished, playing TTS..."),await re(A),console.log("TTS finished"),Te(b.key)}catch(I){console.error("Announcement playback error:",I)}finally{W(de),j.current=!1,B.current.length>0&&ue()}},ke=(b,A)=>{if(typeof window>"u")return;if(!D.current){D.current=!0;return}const I=new Map;(b||[]).forEach(K=>{K&&K.id&&K.currentServing&&I.set(K.id,K.currentServing.queueNumber)});const $=Date.now(),Y=new Set(B.current.map(K=>K.key).filter(Boolean)),Q=[];(A||[]).forEach(K=>{if(!K||!K.id||!K.currentServing)return;const ee=K.currentServing.queueNumber,z=K.currentServing.clientName,ae=I.get(K.id);if(!ee||ee===ae)return;const xe=`${K.id}:${ee}`;if(Y.has(xe)||V.current===xe&&$-q.current<Z)return;Y.add(xe);const ce=Qe?Qe(ee):ee;let ne=ce;const be=parseInt(ce,10);Number.isNaN(be)||(ne=String(be));const me=K.label||"Window",ye=z?`, ${z}`:"",S="Ang atong {{window}},... mu assist na sa kyu number, {{queueNumber}}. {{clientNamePart}}, please proceed to {{window}}.".replace(/{{\s*window\s*}}/gi,me).replace(/{{\s*queueNumber\s*}}/gi,ne).replace(/{{\s*clientNamePart\s*}}/gi,ye);console.log("Announcement queued:",{windowLabel:me,spokenCounter:ne,text:S}),Q.push({text:S,key:xe})}),Q.length>0&&(console.log(`Adding ${Q.length} announcement(s) to queue`),Q.forEach(K=>B.current.push(K)),ue())},Te=b=>{b&&(V.current=b,q.current=Date.now())},Ie=[".mp4",".webm",".ogg",".mov",".avi"];function Ne(b){if(!b||typeof b!="string")return null;const A=b.trim(),I=A.match(/[?&]v=([^&]+)/);if(I)return I[1];const $=A.match(/youtu\.be\/([^?&]+)/);if($)return $[1];const Y=A.match(/youtube\.com\/embed\/([^?&]+)/);return Y?Y[1]:null}const Ue=async()=>{var b;try{const[A,I]=await Promise.all([C.get("/admin/settings/video-source"),C.get("/admin/settings/video-volume").catch(()=>null)]),$=A.data.videoSource||"youtube";if(s($),I&&typeof((b=I.data)==null?void 0:b.videoVolumePercent)=="number"){const Y=I.data.videoVolumePercent;U(Math.max(0,Math.min(100,Math.round(Y))))}if($==="youtube"){const K=((await C.get("/admin/settings/youtube-playlist")).data.urls||[]).map(ee=>{const z=Ne(ee);return z?{id:z,url:ee,name:z}:null}).filter(Boolean);n(K),x(!1),w(null)}else n([]),w(null)}catch(A){console.error("Failed to load videos:",A),x(!0),n([])}},Ve=async()=>{if(!("showDirectoryPicker"in window)){w("Not supported in this browser. Use Chrome or Edge.");return}try{w(null);const b=await window.showDirectoryPicker(),A=[];for await(const I of b.values())if(I.kind==="file"){const $="."+(I.name.split(".").pop()||"").toLowerCase();if(Ie.includes($)){const Y=await I.getFile(),Q=URL.createObjectURL(Y);A.push({filename:I.name,name:I.name.replace(/\.[^/.]+$/,""),url:Q,_blobUrl:!0})}}A.length>0?(n(A),x(!1)):w("No video files found in that folder.")}catch(b){b.name!=="AbortError"&&(console.error("Failed to pick folder:",b),w(b.message||"Failed to access folder."))}},Re=()=>{if(!m.current){m.current=!0,H(!1);try{const b=Math.max(0,Math.min(100,P))/100,A=window.AudioContext||window.webkitAudioContext;if(A&&!T.current){const Y=new A;T.current=Y,Y.resume&&Y.resume()}const I=g.current;I&&typeof I.unMute=="function"&&(I.unMute(),I.setVolume(Math.round(b*100)));const $=R.current;$&&($.muted=!1,$.volume=b)}catch{}}};return X.current=Re,e.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"#0f172a",overflow:"hidden"},onClick:Re,onTouchStart:Re,role:"presentation",children:[G&&i.length>0&&e.jsxs("div",{role:"button",tabIndex:0,onClick:Re,onKeyDown:b=>{b.key!=="Tab"&&Re()},style:{position:"fixed",inset:0,zIndex:9999,background:"rgba(0,0,0,0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",cursor:"pointer"},children:[e.jsx("div",{style:{color:"#e5e7eb",fontSize:"24px",fontWeight:600,textAlign:"center",padding:"0 24px"},children:"Press any key or tap to start"}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"16px",textAlign:"center",padding:"0 24px"},children:"Use your remote's OK/Enter button, or tap the screen"})]}),e.jsxs("div",{style:{flex:1,display:"flex",minHeight:0},children:[e.jsxs("div",{style:{flex:3,minWidth:0,background:"#000",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsxs("div",{style:{position:"absolute",top:16,left:16,zIndex:10,display:"flex",alignItems:"center",gap:0,pointerEvents:"none"},children:[e.jsx("div",{children:e.jsx(Ce,{size:"monitor",showText:!1,gap:"0px"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",lineHeight:1.1,marginLeft:0},children:[e.jsx("span",{style:{fontSize:"18px",fontWeight:700,color:"#e5e7eb",textShadow:"0 2px 4px rgba(0,0,0,0.6)",whiteSpace:"nowrap"},children:"Hilongos Treasury Office"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#e5e7eb",textShadow:"0 2px 4px rgba(0,0,0,0.6)",textTransform:"uppercase",letterSpacing:"0.12em",whiteSpace:"nowrap"},children:"Queue Monitoring"})]})]}),i.length>0&&!c?u==="youtube"?e.jsx("div",{ref:N,style:{position:"relative",width:"100%",height:"100%"}}):e.jsx("video",{ref:R,src:a==null?void 0:a.url,controls:!0,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsxs("div",{style:{textAlign:"center",padding:"40px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{color:"#9ca3af",fontSize:"22px",fontWeight:600,marginBottom:"8px"},children:u==="local"?"Select a video folder":"No YouTube playlist configured"}),e.jsx("div",{style:{color:"#6b7280",fontSize:"16px"},children:u==="local"?"Choose a folder on this computer containing video files (mp4, webm, ogg, mov, avi).":"Add YouTube URLs in Admin â†’ Settings â†’ Videos."}),u==="local"&&v&&e.jsx("div",{style:{color:"#ef4444",fontSize:"14px"},children:v}),u==="local"&&e.jsx("button",{type:"button",onClick:Ve,style:{padding:"12px 24px",fontSize:"16px",fontWeight:600,color:"white",background:"#6366f1",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Select folder"})]})]}),e.jsx("div",{style:{flex:1,minWidth:0,borderLeft:"1px solid #1f2937",background:"#020617",padding:"12px",display:"flex",flexDirection:"column",gap:"12px",overflowY:"auto"},children:k?e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})}):(()=>{const b=t.filter($=>$.staff);if(b.length===0)return e.jsx("div",{style:{textAlign:"center",padding:"24px 16px",background:"#0b1120",borderRadius:"12px",color:"#64748b",border:"1px solid #1f2937"},children:"No active windows at the moment"});const A=b.length,I=A<=3?"0 0 20vh":"1 1 0";return b.map($=>e.jsx("div",{style:{flex:I,minHeight:A>3?0:void 0,display:"flex"},children:e.jsx(jt,{window:$,compact:A>3})},$.id))})()})]})]})}function an(){const t=je(),[r]=Tt(),i=r.get("reason")==="logout_9pm",[n,a]=o.useState({username:"",password:""}),[d,k]=o.useState(""),[f,c]=o.useState(!1);o.useEffect(()=>{const u=localStorage.getItem("token"),s=ze();u&&(s==null?void 0:s.role)==="STAFF"&&t("/staff/dashboard")},[t]);const x=async u=>{var s,v;u.preventDefault(),k(""),c(!0);try{const w=await C.post("/auth/staff/login",n);localStorage.setItem("token",w.data.token),localStorage.setItem("user",JSON.stringify(w.data.user)),t("/staff/dashboard")}catch(w){k(((v=(s=w.response)==null?void 0:s.data)==null?void 0:v.error)||"Login failed")}finally{c(!1)}};return e.jsxs("div",{className:"staff-login-root",style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",paddingLeft:"max(20px, env(safe-area-inset-left))",paddingRight:"max(20px, env(safe-area-inset-right))"},children:[e.jsx("style",{children:`
        @media (max-width: 480px) {
          .staff-login-root { padding: 16px !important; }
          .staff-login-card { padding: 24px !important; }
          .staff-login-title { font-size: 22px !important; }
        }
      `}),e.jsxs("div",{className:"staff-login-card",style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(Ce,{size:"medium"})}),e.jsx("h1",{className:"staff-login-title",style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Staff Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage your queue"}),i&&e.jsx("div",{style:{padding:"12px",background:"#fef3c7",color:"#92400e",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:"You were automatically logged out. Staff sessions end at 9pm."}),e.jsxs("form",{onSubmit:x,children:[e.jsx(le,{label:"Username",value:n.username,onChange:u=>a({...n,username:u.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(le,{label:"Password",type:"password",value:n.password,onChange:u=>a({...n,password:u.target.value}),placeholder:"Enter your password",required:!0}),d&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:d}),e.jsx(M,{type:"submit",fullWidth:!0,disabled:f,children:f?"Logging in...":"Login"})]})]})]})}function Ke({label:t,error:r,children:i,...n}){return e.jsxs("div",{style:{marginBottom:"16px"},children:[t&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:t}),e.jsx("select",{style:{width:"100%",padding:"12px",borderRadius:"8px",border:r?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",backgroundColor:"white",cursor:"pointer"},...n,children:i}),r&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:r})]})}function sn({onProfileClick:t,onLogout:r}){const[i,n]=o.useState(!1),[a,d]=o.useState(null),[k,f]=o.useState(!0),c=o.useRef(null);o.useEffect(()=>{x()},[]),o.useEffect(()=>{const s=v=>{c.current&&!c.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const x=async()=>{try{const s=await C.get("/staff/profile");d(s.data.staff)}catch(s){console.error("Failed to load profile:",s)}finally{f(!1)}},u=s=>{if(!s)return"?";const v=s.trim().split(" ");return v.length>=2?(v[0][0]+v[v.length-1][0]).toUpperCase():s.substring(0,2).toUpperCase()};return k?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:c,children:[e.jsx("button",{onClick:()=>n(!i),style:{width:"44px",height:"44px",minWidth:"44px",minHeight:"44px",borderRadius:"50%",border:"2px solid #e2e8f0",background:a!=null&&a.profilePicture?`url(${a.profilePicture}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:s=>{s.target.style.borderColor="#2563eb",s.target.style.transform="scale(1.05)"},onMouseOut:s=>{s.target.style.borderColor="#e2e8f0",s.target.style.transform="scale(1)"},children:!(a!=null&&a.profilePicture)&&u(a==null?void 0:a.name)}),i&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(a==null?void 0:a.name)||"Staff"}),e.jsxs("button",{onClick:()=>{n(!1),t()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#1e293b",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:s=>{s.currentTarget.style.background="#f1f5f9"},onMouseOut:s=>{s.currentTarget.style.background="transparent"},children:[e.jsx(pt,{size:18}),"Profile"]}),e.jsxs("button",{onClick:()=>{n(!1),r()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:s=>{s.currentTarget.style.background="#fee2e2"},onMouseOut:s=>{s.currentTarget.style.background="transparent"},children:[e.jsx(ut,{size:18}),"Logout"]})]})]})}const rt={success:{icon:nt,color:"#10b981",bg:"#d1fae5"},error:{icon:Rt,color:"#ef4444",bg:"#fee2e2"},warning:{icon:zt,color:"#f59e0b",bg:"#fef3c7"},info:{icon:Dt,color:"#2563eb",bg:"#dbeafe"}};let rn=0;const Be=[],Le=[];function Ct(t,r="info",i=3e3){const n=rn++,a={id:n,message:t,type:r,duration:i};return Be.push(a),Le.forEach(d=>d([...Be])),i>0&&setTimeout(()=>{kt(n)},i),n}function kt(t){const r=Be.findIndex(i=>i.id===t);r>-1&&(Be.splice(r,1),Le.forEach(i=>i([...Be])))}function te(t,r){return Ct(t,"success",r)}function F(t,r){return Ct(t,"error",r)}function ln(){const[t,r]=o.useState([]);return o.useEffect(()=>{const i=n=>{r(n)};return Le.push(i),r([...Be]),()=>{const n=Le.indexOf(i);n>-1&&Le.splice(n,1)}},[]),e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",gap:"12px",pointerEvents:"none"},children:[(t||[]).map(i=>{const n=rt[i.type]||rt.info,a=n.icon;return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px 20px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",minWidth:"300px",maxWidth:"400px",pointerEvents:"auto",animation:"slideIn 0.3s ease-out",borderLeft:`4px solid ${n.color}`},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:n.bg,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(a,{size:16,color:n.color})}),e.jsx("div",{style:{flex:1,fontSize:"14px",color:"#1e293b",lineHeight:"1.5"},children:i.message}),e.jsx("button",{onClick:()=>kt(i.id),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",transition:"color 0.2s"},onMouseOver:d=>{d.target.style.color="#1e293b"},onMouseOut:d=>{d.target.style.color="#64748b"},children:e.jsx(ge,{size:18})})]},i.id)}),e.jsx("style",{children:`
        @keyframes slideIn {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `})]})}function Pe({open:t,title:r,message:i,onConfirm:n,onCancel:a,confirmText:d="Confirm",cancelText:k="Cancel",variant:f="danger"}){if(!t)return null;const c={danger:{confirmBg:"#ef4444",confirmHover:"#dc2626"},warning:{confirmBg:"#f59e0b",confirmHover:"#d97706"},info:{confirmBg:"#2563eb",confirmHover:"#1e40af"}},x=c[f]||c.danger;return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:r}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px",lineHeight:"1.6"},children:i}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:a,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:u=>{u.target.style.background="#f1f5f9",u.target.style.borderColor="#cbd5e1"},onMouseOut:u=>{u.target.style.background="transparent",u.target.style.borderColor="#e2e8f0"},children:k}),e.jsx("button",{onClick:n,style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:x.confirmBg,color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:u=>{u.target.style.background=x.confirmHover,u.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)"},onMouseOut:u=>{u.target.style.background=x.confirmBg,u.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:d})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const lt=["#2563eb","#10b981","#f59e0b","#ef4444"];function dn(){const t=je(),[r,i]=o.useState(!0),[n,a]=o.useState(null),[d,k]=o.useState([]),[f,c]=o.useState({}),[x,u]=o.useState([]),[s,v]=o.useState(null),[w,R]=o.useState("today"),[g,N]=o.useState(new Date),[y,l]=o.useState({open:!1,queueEntryId:null}),[D,B]=o.useState(null);o.useEffect(()=>{const h=localStorage.getItem("token"),L=ze();if(!h||(L==null?void 0:L.role)!=="STAFF"){t("/staff/login");return}j(),V();const oe=setInterval(j,3e3);return()=>clearInterval(oe)},[t]),o.useEffect(()=>{w&&q()},[w]),o.useEffect(()=>{const h=setInterval(()=>N(new Date),1e3);return()=>clearInterval(h)},[]);const j=async()=>{var h;try{const L=await C.get("/staff/dashboard");a(L.data.window),k(L.data.queue||[]),c(L.data.stats||{})}catch(L){console.error("Failed to load dashboard:",L),((h=L.response)==null?void 0:h.status)===401&&t("/staff/login")}finally{i(!1)}},V=async()=>{try{const h=await C.get("/windows/active");u(h.data.windows||[])}catch(h){console.error("Failed to load windows:",h)}},q=async()=>{try{let h,L;const oe=new Date;if(w==="today")h=oe.toISOString().split("T")[0],L=h;else if(w==="yesterday"){const _=new Date(oe);_.setDate(_.getDate()-1),h=_.toISOString().split("T")[0],L=h}else h=oe.toISOString().split("T")[0],L=h;const W=await C.get(`/staff/analytics?startDate=${h}&endDate=${L}`);v(W.data)}catch(h){console.error("Failed to load analytics:",h)}},Z=async h=>{var L,oe;try{await C.post("/staff/assign-window",{windowId:h}),j(),V()}catch(W){console.error("Failed to assign window:",W),alert(((oe=(L=W.response)==null?void 0:L.data)==null?void 0:oe.error)||"Failed to assign window")}},de=async h=>{var L,oe,W,_,re,he;if(!D){B(h);try{const ke=(L=(await C.post(`/staff/serve/${h}`)).data)==null?void 0:L.queueEntry;ke?k(Te=>Te.map(Ie=>Ie.id===h?ke:Ie)):j()}catch(ue){console.error("Failed to start serving:",ue),((oe=ue.response)==null?void 0:oe.status)===409?(F(((_=(W=ue.response)==null?void 0:W.data)==null?void 0:_.error)||"Client was already claimed. Refreshing..."),j()):F(((he=(re=ue.response)==null?void 0:re.data)==null?void 0:he.error)||"Failed to start serving")}finally{B(null)}}},se=async h=>{var L,oe;try{await C.post(`/staff/complete/${h}`),j(),q()}catch(W){console.error("Failed to complete:",W),alert(((oe=(L=W.response)==null?void 0:L.data)==null?void 0:oe.error)||"Failed to complete")}},ie=h=>{l({open:!0,queueEntryId:h})},pe=async()=>{var L,oe;const{queueEntryId:h}=y;if(l({open:!1,queueEntryId:null}),!!h)try{await C.post(`/staff/skip/${h}`),j(),q(),te("Client marked as skipped")}catch(W){console.error("Failed to skip:",W),F(((oe=(L=W.response)==null?void 0:L.data)==null?void 0:oe.error)||"Failed to skip")}},m=async()=>{try{await C.get("/staff/dashboard").then(L=>L.data.window)&&await C.post("/staff/assign-window",{windowId:null})}catch(h){console.error("Error deactivating window on logout:",h)}localStorage.removeItem("token"),localStorage.removeItem("user"),t("/staff/login")},T=()=>{t("/staff/profile")};if(r)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})});const G=d.filter(h=>["SENIOR_CITIZEN","PWD","PREGNANT"].includes(h.clientType)),H=d.filter(h=>h.clientType==="REGULAR"),P=s!=null&&s.byCategory?Object.entries(s.byCategory).map(([h,L])=>({name:h,value:L})):[],U=s!=null&&s.byClientType?Object.entries(s.byClientType).map(([h,L])=>({name:h,value:L})):[],X=h=>{const L=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],oe=["January","February","March","April","May","June","July","August","September","October","November","December"],W=L[h.getDay()],_=oe[h.getMonth()],re=h.getDate(),he=h.getFullYear();let ue=h.getHours();const ke=String(h.getMinutes()).padStart(2,"0"),Te=String(h.getSeconds()).padStart(2,"0"),Ie=ue>=12?"PM":"AM";return ue=ue%12,ue=ue||12,`${W}, ${_} ${re}, ${he} at ${ue}:${ke}:${Te} ${Ie}`};return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{open:y.open,title:"Skip Client",message:"Mark this client as skipped? They will be removed from the queue and not counted as served.",confirmText:"Skip",cancelText:"Cancel",variant:"warning",onConfirm:pe,onCancel:()=>l({open:!1,queueEntryId:null})}),e.jsx("style",{children:`
        .staff-dashboard-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        .staff-dashboard-content {
          padding-left: max(24px, env(safe-area-inset-left));
          padding-right: max(24px, env(safe-area-inset-right));
        }
        .queue-item-buttons button {
          min-height: 44px;
        }
        @media (max-width: 768px) {
          .staff-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-dashboard-header > div:first-child {
            width: 100%;
            flex-direction: column;
            align-items: flex-start !important;
            gap: 8px !important;
          }
          .staff-dashboard-header-center {
            width: 100%;
            text-align: left;
          }
          .staff-dashboard-main-grid {
            grid-template-columns: 1fr !important;
          }
          .staff-dashboard-content {
            padding: 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .queue-item-grid {
            grid-template-columns: 1fr !important;
            gap: 12px !important;
          }
          .queue-item-buttons {
            flex-direction: row !important;
            width: 100% !important;
            flex-wrap: wrap;
          }
          .queue-item-buttons button {
            flex: 1;
            min-width: 120px;
          }
          .staff-window-assign-grid {
            grid-template-columns: 1fr !important;
          }
        }
        @media (max-width: 480px) {
          .queue-item-buttons {
            flex-direction: column !important;
          }
          .queue-item-buttons button {
            min-width: 100%;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .staff-dashboard-main-grid {
            grid-template-columns: 60% 40% !important;
          }
        }
      `}),e.jsxs("div",{className:"staff-dashboard-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsxs("div",{className:"staff-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(Ce,{size:"small"}),n&&e.jsxs("div",{className:"staff-dashboard-header-center",style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:["Operating: ",n.label]})]}),e.jsx(sn,{onProfileClick:T,onLogout:m})]}),e.jsxs("div",{className:"staff-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:X(g)})}),!n&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Assign Window"}),e.jsx("div",{className:"staff-window-assign-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"12px"},children:x.map(h=>e.jsx(M,{onClick:()=>Z(h.id),variant:"outline",children:h.label},h.id))})]}),e.jsxs("div",{className:"staff-dashboard-main-grid",style:{display:"grid",gridTemplateColumns:"75% 25%",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px"},children:["Queue (",d.length,")"]}),G.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#f59e0b",marginBottom:"12px"},children:"Priority Clients"}),G.map(h=>e.jsx(dt,{entry:h,onServe:de,onComplete:se,onSkip:ie,servingId:D},h.id))]}),H.length>0&&e.jsxs("div",{children:[G.length>0&&e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",marginBottom:"12px"},children:"Regular Clients"}),H.map(h=>e.jsx(dt,{entry:h,onServe:de,onComplete:se,onSkip:ie,servingId:D},h.id))]}),d.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#94a3b8"},children:"No clients in queue"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"In Queue"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#f59e0b"},children:d.length})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"Total Served Today"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#2563eb"},children:f.totalServed||0})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"Skipped Today"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#ef4444"},children:f.totalSkipped||0})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Analytics"}),e.jsxs(Ke,{value:w,onChange:h=>R(h.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"})]})]}),s&&e.jsxs(e.Fragment,{children:[P.length>0&&e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Category"}),e.jsx(Ae,{width:"100%",height:200,children:e.jsxs(et,{data:P,children:[e.jsx(qe,{strokeDasharray:"3 3"}),e.jsx($e,{dataKey:"name"}),e.jsx(Ye,{}),e.jsx(Ee,{}),e.jsx(tt,{dataKey:"value",fill:"#2563eb"})]})})]}),U.length>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Client Type"}),e.jsx(Ae,{width:"100%",height:200,children:e.jsxs(yt,{children:[e.jsx(bt,{data:U,cx:"50%",cy:"50%",labelLine:!1,label:({name:h,percent:L})=>`${h}: ${(L*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:U.map((h,L)=>e.jsx(vt,{fill:lt[L%lt.length]},`cell-${L}`))}),e.jsx(Ee,{})]})})]})]})]})]})]})]})]})]})}function dt({entry:t,onServe:r,onComplete:i,onSkip:n,servingId:a}){var f,c,x;const d=t.status==="NOW_SERVING",k=a===t.id;return e.jsxs("div",{className:"queue-item-grid",style:{padding:"16px",border:d?"2px solid #2563eb":"1px solid #e2e8f0",borderRadius:"8px",marginBottom:"12px",background:d?"#eff6ff":"white",display:"grid",gridTemplateColumns:"1fr auto",gap:"20px",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2563eb",marginBottom:"4px"},children:t.queueNumber}),e.jsx("div",{style:{fontSize:"14px",color:"#1e293b",marginBottom:"4px"},children:t.clientName}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",flexWrap:"wrap"},children:[e.jsx(St,{clientType:t.clientType}),e.jsxs("span",{style:{fontSize:"12px",color:"#64748b"},children:[((f=t.concernCategories)!=null&&f.length?t.concernCategories:t.category?[t.category]:[]).map(u=>u==null?void 0:u.name).filter(Boolean).join(", "),((c=t.concernSubCategories)!=null&&c.length?t.concernSubCategories:t.subCategory?[t.subCategory]:[]).map(u=>u==null?void 0:u.name).filter(Boolean).length>0&&` - ${((x=t.concernSubCategories)!=null&&x.length?t.concernSubCategories:[t.subCategory]).map(u=>u==null?void 0:u.name).filter(Boolean).join(", ")}`]})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#94a3b8"},children:["Joined: ",new Date(t.joinedAt).toLocaleTimeString()]})]}),e.jsxs("div",{className:"queue-item-buttons",style:{display:"flex",gap:"8px",flexDirection:"column"},children:[d?e.jsx(M,{variant:"success",icon:nt,onClick:()=>i(t.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Mark as Served"}):e.jsx(M,{variant:"primary",icon:Wt,onClick:()=>r(t.id),disabled:k,style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:k?"Serving...":"Start Serving"}),e.jsx(M,{variant:"danger",icon:Pt,onClick:()=>n(t.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Skip"})]})]})}function cn(){const t=je(),[r,i]=o.useState(!0),[n,a]=o.useState(!1),[d,k]=o.useState(null),[f,c]=o.useState(null),[x,u]=o.useState(null),[s,v]=o.useState(!1),[w,R]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[g,N]=o.useState(!1),[y,l]=o.useState(null),[D,B]=o.useState([]),[j,V]=o.useState(""),[q,Z]=o.useState(!1);o.useEffect(()=>{const P=localStorage.getItem("token"),U=ze();if(!P||(U==null?void 0:U.role)!=="STAFF"){t("/staff/login");return}de()},[t]);const de=async()=>{var P;try{const U=await C.get("/staff/profile");k(U.data.staff),c(U.data.staff.profilePicture);const X=U.data.currentWindow||null;l(X),V((X==null?void 0:X.id)||"")}catch(U){console.error("Failed to load profile:",U),((P=U.response)==null?void 0:P.status)===401&&t("/staff/login")}finally{i(!1)}},se=async()=>{try{const P=await C.get("/windows/active");B(P.data.windows||[])}catch(P){console.error("Failed to load windows:",P)}};o.useEffect(()=>{se()},[]);const ie=async P=>{var U,X;if(P.preventDefault(),!j||j===(y==null?void 0:y.id)){j===(y==null?void 0:y.id)&&F("You are already assigned to this window");return}Z(!0);try{await C.post("/staff/assign-window",{windowId:j});const h=D.find(L=>L.id===j);l(h?{id:h.id,label:h.label}:null),te("Window changed successfully. You are now operating at "+((h==null?void 0:h.label)||"the selected window")+".")}catch(h){console.error("Failed to switch window:",h),F(((X=(U=h.response)==null?void 0:U.data)==null?void 0:X.error)||"Failed to switch window")}finally{Z(!1)}},pe=P=>{const U=P.target.files[0];if(U){const X=new FileReader;X.onloadend=()=>{u(X.result)},X.readAsDataURL(U),c(U)}},m=async P=>{var U,X;P.preventDefault(),a(!0);try{if(await C.put("/staff/profile",{name:d.name}),f instanceof File){const h=new FormData;h.append("picture",f);const L=await C.post("/staff/profile/picture",h,{headers:{"Content-Type":"multipart/form-data"}});c(L.data.profilePicture),u(null)}te("Profile updated successfully!"),t("/staff/dashboard")}catch(h){console.error("Failed to update profile:",h),F(((X=(U=h.response)==null?void 0:U.data)==null?void 0:X.error)||"Failed to update profile")}finally{a(!1)}},T=async P=>{var U,X;if(P.preventDefault(),w.newPassword!==w.confirmPassword){F("New passwords do not match");return}if(w.newPassword.length<6){F("Password must be at least 6 characters");return}N(!0);try{await C.post("/staff/profile/change-password",{currentPassword:w.currentPassword,newPassword:w.newPassword}),te("Password changed successfully!"),v(!1),R({currentPassword:"",newPassword:"",confirmPassword:""})}catch(h){console.error("Failed to change password:",h),F(((X=(U=h.response)==null?void 0:U.data)==null?void 0:X.error)||"Failed to change password")}finally{N(!1)}};if(r)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})});const G=P=>{if(!P)return"?";const U=P.trim().split(" ");return U.length>=2?(U[0][0]+U[U.length-1][0]).toUpperCase():P.substring(0,2).toUpperCase()},H=x||(d!=null&&d.profilePicture?d.profilePicture:null);return e.jsxs("div",{className:"staff-profile-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx("style",{children:`
        .staff-profile-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        @media (max-width: 768px) {
          .staff-profile-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-profile-content {
            margin: 24px auto !important;
            padding: 0 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-profile-card {
            padding: 24px !important;
          }
          .staff-profile-buttons {
            flex-direction: column !important;
          }
          .staff-profile-buttons button {
            width: 100%;
          }
        }
      `}),e.jsxs("div",{className:"staff-profile-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ce,{size:"small"}),e.jsx(M,{variant:"outline",icon:xt,onClick:()=>t("/staff/dashboard"),children:"Back to Dashboard"})]}),e.jsx("div",{className:"staff-profile-content",style:{maxWidth:"600px",margin:"40px auto",padding:"0 24px"},children:e.jsxs("div",{className:"staff-profile-card",style:{background:"white",borderRadius:"12px",padding:"32px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"32px",color:"#1e293b"},children:"My Profile"}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[e.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",margin:"0 auto 16px",border:"3px solid #e2e8f0",background:H?`url(${H}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"36px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:!H&&G(d==null?void 0:d.name)}),e.jsxs("label",{style:{display:"inline-block",padding:"8px 16px",background:"#2563eb",color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s"},onMouseOver:P=>{P.target.style.background="#1e40af"},onMouseOut:P=>{P.target.style.background="#2563eb"},children:["Change Picture",e.jsx("input",{type:"file",accept:"image/*",onChange:pe,style:{display:"none"}})]}),e.jsx("p",{style:{fontSize:"12px",color:"#64748b",marginTop:"8px"},children:"JPG, PNG, GIF, WebP (max 2MB)"})]}),e.jsx(le,{label:"Name",value:(d==null?void 0:d.name)||"",onChange:P=>k({...d,name:P.target.value}),required:!0}),e.jsx(le,{label:"Username",value:(d==null?void 0:d.username)||"",disabled:!0,readOnly:!0}),e.jsxs("div",{className:"staff-profile-buttons",style:{display:"flex",gap:"12px",marginTop:"24px"},children:[e.jsx(M,{type:"submit",icon:gt,disabled:n,fullWidth:!0,children:n?"Saving...":"Save Changes"}),e.jsx(M,{variant:"outline",icon:ge,onClick:()=>t("/staff/dashboard"),fullWidth:!0,children:"Cancel"})]})]}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Xe,{size:20}),"Operating window"]}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"12px"},children:y?`You are currently at ${y.label}.`:"You are not assigned to a window yet."}),e.jsxs("form",{onSubmit:ie,style:{display:"flex",flexDirection:"row",gap:"12px",alignItems:"center",flexWrap:"wrap",maxWidth:"420px"},children:[e.jsx("div",{style:{flex:"1 1 200px"},children:e.jsxs(Ke,{label:"Switch to window",value:j,onChange:P=>V(P.target.value),children:[e.jsx("option",{value:"",children:"â€” Select window â€”"}),D.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})}),e.jsx(M,{type:"submit",icon:Xe,disabled:q||!j||j===(y==null?void 0:y.id),fullWidth:!0,style:{flex:"1 1 200px",padding:"12px 20px"},children:q?"Switching...":"Switch window"})]})]}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Change Password"}),e.jsx(M,{variant:"outline",icon:ot,onClick:()=>{v(!s),s&&R({currentPassword:"",newPassword:"",confirmPassword:""})},children:s?"Cancel":"Change Password"})]}),s&&e.jsxs("form",{onSubmit:T,children:[e.jsx(le,{label:"Current Password",type:"password",value:w.currentPassword,onChange:P=>R({...w,currentPassword:P.target.value}),required:!0}),e.jsx(le,{label:"New Password",type:"password",value:w.newPassword,onChange:P=>R({...w,newPassword:P.target.value}),required:!0}),e.jsx(le,{label:"Confirm New Password",type:"password",value:w.confirmPassword,onChange:P=>R({...w,confirmPassword:P.target.value}),required:!0}),e.jsx(M,{type:"submit",icon:ft,disabled:g,fullWidth:!0,style:{marginTop:"16px"},children:g?"Changing...":"Change Password"})]})]})]})})]})}function pn(){const t=je(),[r,i]=o.useState({username:"",password:""}),[n,a]=o.useState(""),[d,k]=o.useState(!1);o.useEffect(()=>{const c=localStorage.getItem("token"),x=ze();c&&(x==null?void 0:x.role)==="ADMIN"&&t("/admin/dashboard")},[t]);const f=async c=>{var x,u;c.preventDefault(),a(""),k(!0);try{const s=await C.post("/auth/admin/login",r);localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user)),t("/admin/dashboard")}catch(s){a(((u=(x=s.response)==null?void 0:x.data)==null?void 0:u.error)||"Login failed")}finally{k(!1)}};return e.jsxs("div",{className:"admin-login-root",style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",paddingLeft:"max(20px, env(safe-area-inset-left))",paddingRight:"max(20px, env(safe-area-inset-right))"},children:[e.jsx("style",{children:`
        @media (max-width: 480px) {
          .admin-login-root { padding: 16px !important; }
          .admin-login-card { padding: 24px !important; }
          .admin-login-title { font-size: 22px !important; }
        }
      `}),e.jsxs("div",{className:"admin-login-card",style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(Ce,{size:"medium"})}),e.jsx("h1",{className:"admin-login-title",style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Admin Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage the system"}),e.jsxs("form",{onSubmit:f,children:[e.jsx(le,{label:"Username",value:r.username,onChange:c=>i({...r,username:c.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(le,{label:"Password",type:"password",value:r.password,onChange:c=>i({...r,password:c.target.value}),placeholder:"Enter your password",required:!0}),n&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:n}),e.jsx(M,{type:"submit",fullWidth:!0,disabled:d,children:d?"Logging in...":"Login"})]})]})]})}function un({onProfileClick:t,onLogout:r}){const[i,n]=o.useState(!1),[a,d]=o.useState(null),[k,f]=o.useState(!0),c=o.useRef(null);je(),o.useEffect(()=>{x()},[]),o.useEffect(()=>{const s=v=>{c.current&&!c.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const x=async()=>{try{const s=ze();s&&d({name:s.name||"Admin",username:s.username})}catch(s){console.error("Failed to load profile:",s)}finally{f(!1)}},u=s=>{if(!s)return"A";const v=s.trim().split(" ");return v.length>=2?(v[0][0]+v[v.length-1][0]).toUpperCase():s.substring(0,2).toUpperCase()};return k?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:c,children:[e.jsx("button",{onClick:()=>n(!i),style:{width:"44px",height:"44px",minWidth:"44px",minHeight:"44px",borderRadius:"50%",border:"2px solid #e2e8f0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:s=>{s.target.style.borderColor="#2563eb",s.target.style.transform="scale(1.05)"},onMouseOut:s=>{s.target.style.borderColor="#e2e8f0",s.target.style.transform="scale(1)"},children:u(a==null?void 0:a.name)}),i&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(a==null?void 0:a.name)||(a==null?void 0:a.username)||"Admin"}),t&&e.jsxs("button",{onClick:()=>{n(!1),t()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#1e293b",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:s=>{s.currentTarget.style.background="#f1f5f9"},onMouseOut:s=>{s.currentTarget.style.background="transparent"},children:[e.jsx(pt,{size:18}),"Profile"]}),e.jsxs("button",{onClick:()=>{n(!1),r()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:s=>{s.currentTarget.style.background="#fee2e2"},onMouseOut:s=>{s.currentTarget.style.background="transparent"},children:[e.jsx(ut,{size:18}),"Logout"]})]})]})}function xn({open:t,title:r,message:i,placeholder:n="",onConfirm:a,onCancel:d,confirmText:k="Confirm",cancelText:f="Cancel",type:c="text",required:x=!0}){const[u,s]=o.useState("");if(o.useEffect(()=>{t&&s("")},[t]),!t)return null;const v=()=>{x&&!u.trim()||(a(u),s(""))},w=()=>{s(""),d()};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:r}),e.jsx("button",{onClick:w,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),i&&e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px",lineHeight:"1.6"},children:i}),e.jsx("input",{type:c,value:u,onChange:R=>s(R.target.value),placeholder:n,required:x,style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px",marginBottom:"24px",transition:"border-color 0.2s"},onFocus:R=>{R.target.style.borderColor="#2563eb"},onBlur:R=>{R.target.style.borderColor="#e2e8f0"},onKeyDown:R=>{R.key==="Enter"?v():R.key==="Escape"&&w()},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:w,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:R=>{R.target.style.background="#f1f5f9",R.target.style.borderColor="#cbd5e1"},onMouseOut:R=>{R.target.style.background="transparent",R.target.style.borderColor="#e2e8f0"},children:f}),e.jsx("button",{onClick:v,disabled:x&&!u.trim(),style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:x&&!u.trim()?"#cbd5e1":"#2563eb",color:"white",fontSize:"14px",fontWeight:"600",cursor:x&&!u.trim()?"not-allowed":"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:R=>{x&&!u.trim()||(R.target.style.background="#1e40af",R.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)")},onMouseOut:R=>{x&&!u.trim()||(R.target.style.background="#2563eb",R.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)")},children:k})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const ct=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6"];function We(t,r){var n;const i=(n=t==null?void 0:t.response)==null?void 0:n.data;if(i!=null&&i.error&&typeof i.error=="string")return i.error;if(Array.isArray(i==null?void 0:i.errors)&&i.errors.length>0){const a=i.errors[0];return(a==null?void 0:a.msg)||(a==null?void 0:a.message)||r}return r}function gn(){const t=je(),[r,i]=o.useState("dashboard"),[n,a]=o.useState(!0),[d,k]=o.useState(null),[f,c]=o.useState([]),[x,u]=o.useState([]),[s,v]=o.useState([]),[w,R]=o.useState(null),[g,N]=o.useState({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""}),[y,l]=o.useState(!1),[D,B]=o.useState(5),[j,V]=o.useState({open:!1,data:{}}),[q,Z]=o.useState({open:!1,data:{}}),[de,se]=o.useState({open:!1,data:{}}),[ie,pe]=o.useState({open:!1,data:{}}),[m,T]=o.useState({open:!1,title:"",message:"",placeholder:"",type:"text",onConfirm:()=>{},onCancel:()=>{}});o.useEffect(()=>{const W=localStorage.getItem("token"),_=ze();if(!W||(_==null?void 0:_.role)!=="ADMIN"){t("/admin/login");return}H();const re=setInterval(()=>{r==="dashboard"&&P()},3e3),he=setInterval(()=>{r==="staff"&&U()},3e4);return()=>{clearInterval(re),clearInterval(he)}},[t,r]),o.useEffect(()=>{r==="reports"&&L()},[r,g]);const G=async()=>{try{const _=(await C.get("/admin/settings/staff-idle-minutes")).data.staffIdleMinutes;typeof _=="number"&&_>=1&&_<=120&&B(_)}catch(W){console.error("Failed to load staff idle minutes:",W)}},H=async()=>{try{await Promise.all([P(),U(),X(),h(),G()])}catch(W){console.error("Error loading data:",W)}finally{a(!1)}},P=async()=>{try{const W=await C.get("/admin/dashboard");k(W.data.stats)}catch(W){console.error("Failed to load dashboard:",W)}},U=async()=>{try{const W=await C.get("/admin/staff");c(W.data.staff)}catch(W){console.error("Failed to load staff:",W)}},X=async()=>{try{const W=await C.get("/admin/windows");u(W.data.windows)}catch(W){console.error("Failed to load windows:",W)}},h=async()=>{try{const W=await C.get("/categories");v(W.data.categories)}catch(W){console.error("Failed to load categories:",W)}},L=async()=>{try{const W=new URLSearchParams;W.append("startDate",g.startDate),W.append("endDate",g.endDate),g.staffIds&&g.staffIds.length>0&&g.staffIds.forEach(re=>W.append("staffId",re)),g.categoryIds&&g.categoryIds.length>0&&g.categoryIds.forEach(re=>W.append("categoryId",re)),g.clientTypes&&g.clientTypes.length>0&&g.clientTypes.forEach(re=>W.append("clientType",re)),g.startHour&&W.append("startHour",g.startHour),g.endHour&&W.append("endHour",g.endHour);const _=await C.get(`/admin/reports?${W.toString()}`);R(_.data)}catch(W){console.error("Failed to load reports:",W)}},oe=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t("/admin/login")};return n?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .admin-dashboard-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        .admin-dashboard-content {
          padding-left: max(24px, env(safe-area-inset-left));
          padding-right: max(24px, env(safe-area-inset-right));
        }
        @media (max-width: 768px) {
          .admin-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .admin-dashboard-header > div:first-child {
            flex-direction: row;
            align-items: center;
            gap: 12px;
          }
          .admin-dashboard-header h1 {
            font-size: 20px !important;
          }
          .admin-dashboard-tabs {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
          }
          .admin-dashboard-tabs button {
            white-space: nowrap;
            font-size: 13px;
            padding: 10px 16px !important;
            min-height: 44px;
            flex-shrink: 0;
          }
          .admin-dashboard-tabs button span {
            display: none;
          }
          .admin-dashboard-content {
            padding: 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .admin-stats-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-reports-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-filter-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-page-header {
            flex-direction: column;
            align-items: flex-start !important;
            gap: 12px;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) !important;
          }
          .admin-modal-overlay {
            padding: 16px;
            align-items: flex-start;
            overflow-y: auto;
          }
          .admin-modal-box {
            max-height: calc(100vh - 32px);
            overflow-y: auto;
            width: 100%;
            margin: auto;
          }
          .admin-settings-buttons {
            flex-wrap: wrap;
          }
          .admin-settings-buttons button {
            min-width: 140px;
          }
          .admin-reports-table-wrap {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 0 -16px;
            padding: 0 16px;
          }
        }
        @media (max-width: 480px) {
          .admin-stats-grid,
          .admin-stats-grid-4,
          .admin-cards-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-dashboard-tabs button {
            padding: 12px 14px !important;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(3, 1fr) !important;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
            gap: 16px;
          }
        }
      `}),e.jsxs("div",{className:"admin-dashboard-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx(xn,{...m}),e.jsxs("div",{className:"admin-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(Ce,{size:"small"}),e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#1e293b",margin:0},children:"Admin Dashboard"})]}),e.jsx(un,{onProfileClick:()=>t("/admin/profile"),onLogout:oe})]}),e.jsx("div",{className:"admin-dashboard-tabs",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"0 24px",display:"flex",gap:"4px"},children:[{id:"dashboard",label:"Dashboard",icon:At},{id:"staff",label:"Staff",icon:Et},{id:"windows",label:"Windows",icon:ht},{id:"categories",label:"Categories",icon:mt},{id:"reports",label:"Reports",icon:Bt},{id:"settings",label:"Settings",icon:Nt}].map(W=>{const _=W.icon,re=r===W.id;return e.jsxs("button",{onClick:()=>i(W.id),style:{padding:"12px 20px",border:"none",background:re?"#eff6ff":"transparent",borderBottom:re?"3px solid #2563eb":"3px solid transparent",color:re?"#2563eb":"#64748b",fontWeight:re?"600":"400",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s",borderRadius:"8px 8px 0 0"},onMouseOver:he=>{re||(he.target.style.background="#f1f5f9",he.target.style.color="#475569")},onMouseOut:he=>{re||(he.target.style.background="transparent",he.target.style.color="#64748b")},children:[e.jsx(_,{size:18}),e.jsx("span",{children:W.label})]},W.id)})}),e.jsxs("div",{className:"admin-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[r==="dashboard"&&e.jsx(fn,{stats:d}),r==="staff"&&e.jsx(hn,{staff:f,categories:s,onRefresh:U,form:j,setForm:V,setInputDialog:T,staffIdleMinutes:D}),r==="windows"&&e.jsx(mn,{windows:x,onRefresh:X,form:q,setForm:Z}),r==="categories"&&e.jsx(yn,{categories:s,onRefresh:h,categoryForm:de,setCategoryForm:se,subCategoryForm:ie,setSubCategoryForm:pe}),r==="reports"&&e.jsx(bn,{reports:w,filters:g,setFilters:N,staff:f,categories:s,showFilters:y,setShowFilters:l,onRefresh:L}),r==="settings"&&e.jsx(vn,{staffIdleMinutes:D,onStaffIdleMinutesSaved:B})]})]})]})}function fn({stats:t}){const[r,i]=o.useState(new Date);if(o.useEffect(()=>{const a=setInterval(()=>{i(new Date)},1e3);return()=>clearInterval(a)},[]),!t)return e.jsx(Se,{});const n=a=>{const d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],f=d[a.getDay()],c=k[a.getMonth()],x=a.getDate(),u=a.getFullYear();let s=a.getHours();const v=String(a.getMinutes()).padStart(2,"0"),w=String(a.getSeconds()).padStart(2,"0"),R=s>=12?"PM":"AM";return s=s%12,s=s||12,`${f}, ${c} ${x}, ${u} at ${s}:${v}:${w} ${R}`};return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:n(r)})}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"16px"},children:[e.jsx(we,{label:"Queue Entries Today",value:t.todayQueueEntries,icon:Lt,color:"#2563eb"}),e.jsx(we,{label:"Serving",value:t.servingCount,icon:Ot,color:"#2563eb"}),e.jsx(we,{label:"Waiting",value:t.waitingCount,icon:Mt,color:"#f59e0b"}),e.jsx(we,{label:"Served Today",value:t.todayServed,icon:nt,color:"#10b981"})]}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[e.jsx(we,{label:"Active Windows",value:t.activeWindows,icon:Xe,color:"#10b981"}),e.jsx(we,{label:"Active Staff",value:t.activeStaff,icon:Ft,color:"#10b981"}),e.jsx(we,{label:"Total Windows",value:t.totalWindows,icon:Ut,color:"#2563eb"}),e.jsx(we,{label:"Total Staff",value:t.totalStaff,icon:Vt,color:"#2563eb"})]})]})}function we({label:t,value:r,color:i="#2563eb",icon:n}){return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[n&&e.jsx(n,{size:20,color:i,style:{flexShrink:0}}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b",fontWeight:"500"},children:t})]}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:i,lineHeight:"1.2"},children:r||0})]})}function hn({staff:t,categories:r,onRefresh:i,form:n,setForm:a,setInputDialog:d,staffIdleMinutes:k=5}){const[f,c]=o.useState(null),[x,u]=o.useState(!1),s=o.useRef(null),[v,w]=o.useState({open:!1});o.useEffect(()=>{const l=D=>{s.current&&!s.current.contains(D.target)&&u(!1)};return x&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[x]);const R=async l=>{l.preventDefault();try{await C.post("/admin/staff",n.data),a({open:!1,data:{}}),te("Staff created successfully!"),i()}catch(D){F(We(D,"Failed to create staff"))}},g=async l=>{l.preventDefault();try{await C.put(`/admin/staff/${f.id}`,n.data),a({open:!1,data:{}}),c(null),te("Staff updated successfully!"),i()}catch(D){F(We(D,"Failed to update staff"))}},N=async(l,D)=>{try{await C.put(`/admin/staff/${l}`,{isActive:!D}),te(`Staff ${D?"deactivated":"activated"} successfully!`),i()}catch(B){F(We(B,"Failed to update staff"))}},y=async(l,D)=>{d({open:!0,title:"Reset Password",message:`Enter new password for ${D}:`,placeholder:"New password (min 6 characters)",type:"password",onConfirm:async B=>{var j,V;if(d({open:!1}),!!B){if(B.length<6){F("Password must be at least 6 characters");return}try{await C.post(`/admin/staff/${l}/reset-password`,{password:B}),te("Password reset successfully!")}catch(q){F(((V=(j=q.response)==null?void 0:j.data)==null?void 0:V.error)||"Failed to reset password")}}},onCancel:()=>d({open:!1})})};return e.jsxs("div",{children:[e.jsx(Pe,{...v}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Staff Management"}),e.jsx(M,{onClick:()=>{a({open:!0,data:{}}),c(null)},children:"Add Staff"})]}),n.open&&Oe.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{a({open:!1,data:{}}),c(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:f?"Edit Staff":"Create Staff"}),e.jsx("button",{onClick:()=>{a({open:!1,data:{}}),c(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsxs("form",{onSubmit:f?g:R,children:[e.jsx(le,{label:"Username",value:n.data.username||"",onChange:l=>a({...n,data:{...n.data,username:l.target.value}}),required:!f,disabled:!!f}),e.jsx(le,{label:"Name",value:n.data.name||"",onChange:l=>a({...n,data:{...n.data,name:l.target.value}}),required:!0}),(!f||n.data.password)&&e.jsx(le,{label:"Password",type:"password",value:n.data.password||"",onChange:l=>a({...n,data:{...n.data,password:l.target.value}}),required:!f}),e.jsxs("div",{style:{marginBottom:"16px",position:"relative"},ref:s,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Specializations (Categories)"}),e.jsx("div",{onClick:()=>u(!x),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:n.data.categoryIds&&n.data.categoryIds.length>0?n.data.categoryIds.map(l=>{const D=r.find(B=>B.id===l);return D?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:B=>{B.stopPropagation(),a({...n,data:{...n.data,categoryIds:n.data.categoryIds.filter(j=>j!==l)}})},children:[D.name,e.jsx(ge,{size:12})]},l):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),x&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:r.map(l=>{var B;const D=((B=n.data.categoryIds)==null?void 0:B.includes(l.id))||!1;return e.jsxs("div",{onClick:()=>{const j=n.data.categoryIds||[];a(D?{...n,data:{...n.data,categoryIds:j.filter(V=>V!==l.id)}}:{...n,data:{...n.data,categoryIds:[...j,l.id]}})},style:{padding:"10px 12px",cursor:"pointer",background:D?"#eff6ff":"white",color:D?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:j=>{D||(j.currentTarget.style.background="#f8fafc")},onMouseOut:j=>{D||(j.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:D,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:l.name})]},l.id)})})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(M,{variant:"outline",icon:ge,onClick:()=>{a({open:!1,data:{}}),c(null)},children:"Cancel"}),e.jsx(M,{type:"submit",icon:Me,children:f?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(l=>{const D=l.name?l.name.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2):l.username.charAt(0).toUpperCase(),B=l.specializations?l.specializations.map(j=>j.category.name):[];return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:l.profilePictureUrl?"transparent":"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",marginBottom:"8px",border:l.profilePictureUrl?"2px solid #e2e8f0":"none"},children:l.profilePictureUrl?e.jsx("img",{src:l.profilePictureUrl,alt:l.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"white",fontSize:"28px",fontWeight:"600"},children:D})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:l.name}),e.jsx("div",{style:{fontSize:"12px",color:"#64748b"},children:l.username})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",marginBottom:"8px",fontSize:"12px",color:"#64748b"},children:[e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:(()=>{const j=l.lastSeenAt?new Date(l.lastSeenAt).getTime():0,V=(k||5)*60*1e3,q=Date.now()-V;return j>=q?"#22c55e":"#94a3b8"})(),flexShrink:0}}),e.jsx("span",{children:(()=>{const j=l.lastSeenAt?new Date(l.lastSeenAt).getTime():0,V=(k||5)*60*1e3,q=Date.now()-V;return j>=q?"Online":"Offline"})()})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:B.length>0?B.map((j,V)=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:j},V)):e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#f1f5f9",color:"#64748b",fontWeight:"500"},children:"All categories"})}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:l.isActive?"#ecfdf5":"#fef2f2",color:l.isActive?"#059669":"#dc2626",fontWeight:"600"},children:l.isActive?"Active":"Inactive"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{c(l),a({open:!0,data:{username:l.username,name:l.name,categoryIds:l.specializations?l.specializations.map(j=>j.categoryId):[]}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"25%"},onMouseOver:j=>{j.target.style.background="#eff6ff"},onMouseOut:j=>{j.target.style.background="transparent"},children:[e.jsx(at,{size:14}),"Edit"]}),e.jsxs("button",{onClick:()=>y(l.id,l.name),style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"75%"},onMouseOver:j=>{j.target.style.background="#eff6ff"},onMouseOut:j=>{j.target.style.background="transparent"},children:[e.jsx(ot,{size:14}),"Reset Password"]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",width:"100%"},children:[e.jsx(M,{variant:l.isActive?"danger":"success",icon:Ht,onClick:()=>N(l.id,l.isActive),style:{fontSize:"12px",padding:"6px 12px",flex:1},children:l.isActive?"Deactivate":"Activate"}),e.jsx(M,{variant:"danger",icon:_e,onClick:()=>{w({open:!0,title:"Remove Staff",message:`Are you sure you want to remove ${l.name||l.username}? This cannot be undone and is only allowed if the staff has no serving history.`,onConfirm:async()=>{w({open:!1});try{await C.delete(`/admin/staff/${l.id}`),te("Staff removed successfully!"),i()}catch(j){F(We(j,"Failed to remove staff"))}},onCancel:()=>w({open:!1})})},style:{fontSize:"12px",padding:"6px 12px",flex:1},children:"Remove"})]})]})]},l.id)})})]})}function mn({windows:t,onRefresh:r,form:i,setForm:n}){const[a,d]=o.useState(null),[k,f]=o.useState({open:!1}),c=async s=>{s.preventDefault();try{await C.post("/admin/windows",i.data),n({open:!1,data:{}}),te("Window created successfully!"),r()}catch(v){F(We(v,"Failed to create window"))}},x=async s=>{s.preventDefault();try{await C.put(`/admin/windows/${a.id}`,i.data),n({open:!1,data:{}}),d(null),te("Window updated successfully!"),r()}catch(v){F(We(v,"Failed to update window"))}},u=async s=>{f({open:!0,title:"Delete Window",message:"Are you sure you want to delete this window? This action cannot be undone.",onConfirm:async()=>{f({open:!1});try{await C.delete(`/admin/windows/${s}`),te("Window deleted successfully!"),r()}catch(v){F(We(v,"Failed to delete window"))}},onCancel:()=>f({open:!1})})};return e.jsxs("div",{children:[e.jsx(Pe,{...k}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Window Management"}),e.jsx(M,{icon:Ze,onClick:()=>{n({open:!0,data:{isActive:!0}}),d(null)},children:"Add Window"})]}),i.open&&Oe.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),d(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:a?"Edit Window":"Create Window"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),d(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsxs("form",{onSubmit:a?x:c,children:[e.jsx(le,{label:"Window Label",value:i.data.label||"",onChange:s=>n({...i,data:{...i.data,label:s.target.value}}),required:!0}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx("input",{type:"checkbox",checked:i.data.isActive!==!1,onChange:s=>n({...i,data:{...i.data,isActive:s.target.checked}})}),"Active"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(M,{variant:"outline",icon:ge,onClick:()=>{n({open:!1,data:{}}),d(null)},children:"Cancel"}),e.jsx(M,{type:"submit",icon:Me,children:a?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(s=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(ht,{size:40,color:"white"})}),e.jsx("div",{style:{textAlign:"center",marginBottom:"8px"},children:e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:s.label})}),s.assignments&&s.assignments.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:s.assignments.map(v=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:v.staff.name},v.id))}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:s.isActive?"#ecfdf5":"#fef2f2",color:s.isActive?"#059669":"#dc2626",fontWeight:"600"},children:s.isActive?"Active":"Inactive"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{d(s),n({open:!0,data:{label:s.label,isActive:s.isActive}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:v=>{v.target.style.background="#eff6ff"},onMouseOut:v=>{v.target.style.background="transparent"},children:[e.jsx(at,{size:14}),"Edit"]}),e.jsx(M,{variant:"danger",icon:_e,onClick:()=>u(s.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})})]},s.id))})]})}function yn({categories:t,onRefresh:r,categoryForm:i,setCategoryForm:n,subCategoryForm:a,setSubCategoryForm:d}){const[k,f]=o.useState(null),[c,x]=o.useState({open:!1}),u=async g=>{var N,y;g.preventDefault();try{await C.post("/admin/categories",i.data),n({open:!1,data:{}}),te("Category created successfully!"),r()}catch(l){F(((y=(N=l.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to create category")}},s=async g=>{var N,y;g.preventDefault();try{await C.put(`/admin/categories/${k.id}`,i.data),n({open:!1,data:{}}),f(null),te("Category updated successfully!"),r()}catch(l){F(((y=(N=l.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to update category")}},v=async g=>{x({open:!0,title:"Delete Category",message:"Are you sure you want to delete this category? All subcategories will be deleted. This action cannot be undone.",onConfirm:async()=>{var N,y;x({open:!1});try{await C.delete(`/admin/categories/${g}`),te("Category deleted successfully!"),r()}catch(l){F(((y=(N=l.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to delete category")}},onCancel:()=>x({open:!1})})},w=async g=>{var N,y;g.preventDefault();try{await C.post(`/admin/categories/${a.data.categoryId}/subcategories`,{name:a.data.name,description:a.data.description}),d({open:!1,data:{}}),te("Subcategory created successfully!"),r()}catch(l){F(((y=(N=l.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to create subcategory")}},R=async g=>{x({open:!0,title:"Delete Subcategory",message:"Are you sure you want to delete this subcategory? This action cannot be undone.",onConfirm:async()=>{var N,y;x({open:!1});try{await C.delete(`/admin/subcategories/${g}`),te("Subcategory deleted successfully!"),r()}catch(l){F(((y=(N=l.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to delete subcategory")}},onCancel:()=>x({open:!1})})};return e.jsxs("div",{children:[e.jsx(Pe,{...c}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Category Management"}),e.jsx(M,{icon:Ze,onClick:()=>{n({open:!0,data:{}}),f(null)},children:"Add Category"})]}),i.open&&Oe.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),f(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:k?"Edit Category":"Create Category"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),f(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsxs("form",{onSubmit:k?s:u,children:[e.jsx(le,{label:"Category Name",value:i.data.name||"",onChange:g=>n({...i,data:{...i.data,name:g.target.value}}),required:!0}),e.jsx(le,{label:"Description (Optional)",value:i.data.description||"",onChange:g=>n({...i,data:{...i.data,description:g.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(M,{variant:"outline",icon:ge,onClick:()=>{n({open:!1,data:{}}),f(null)},children:"Cancel"}),e.jsx(M,{type:"submit",icon:Me,children:k?"Update":"Create"})]})]})]})}),document.body),a.open&&Oe.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{d({open:!1,data:{}})},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Add Subcategory"}),e.jsx("button",{onClick:()=>{d({open:!1,data:{}})},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsxs("form",{onSubmit:w,children:[e.jsx(le,{label:"Subcategory Name",value:a.data.name||"",onChange:g=>d({...a,data:{...a.data,name:g.target.value}}),required:!0}),e.jsx(le,{label:"Description (Optional)",value:a.data.description||"",onChange:g=>d({...a,data:{...a.data,description:g.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(M,{variant:"outline",icon:ge,onClick:()=>{d({open:!1,data:{}})},children:"Cancel"}),e.jsx(M,{type:"submit",icon:Me,children:"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(g=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(mt,{size:40,color:"white"})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:g.name}),g.description&&e.jsx("div",{style:{fontSize:"12px",color:"#64748b",lineHeight:"1.4"},children:g.description})]}),g.subCategories&&g.subCategories.length>0&&e.jsx("div",{style:{marginBottom:"8px"},children:e.jsxs("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"600"},children:[g.subCategories.length," Subcategor",g.subCategories.length===1?"y":"ies"]})}),g.subCategories&&g.subCategories.length>0&&e.jsx("div",{style:{width:"100%",marginBottom:"8px",maxHeight:"120px",overflowY:"auto",padding:"8px",background:"#f8fafc",borderRadius:"8px"},children:g.subCategories.map(N=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",marginBottom:"4px",background:"white",borderRadius:"6px",fontSize:"12px"},children:[e.jsx("span",{style:{fontWeight:"500",color:"#1e293b"},children:N.name}),e.jsx("button",{onClick:()=>R(N.id),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},onMouseOver:y=>{y.target.style.background="#fee2e2"},onMouseOut:y=>{y.target.style.background="transparent"},children:e.jsx(_e,{size:12})})]},N.id))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsx(M,{variant:"outline",icon:Ze,onClick:()=>{d({open:!0,data:{categoryId:g.id,name:"",description:""}})},style:{fontSize:"12px",padding:"6px 12px",width:"100%"},children:"Add Subcategory"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{f(g),n({open:!0,data:{name:g.name,description:g.description||""}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:N=>{N.target.style.background="#eff6ff"},onMouseOut:N=>{N.target.style.background="transparent"},children:[e.jsx(at,{size:14}),"Edit"]}),e.jsx(M,{variant:"danger",icon:_e,onClick:()=>v(g.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})]})]},g.id))})]})}function bn({reports:t,filters:r,setFilters:i,staff:n,categories:a,showFilters:d,setShowFilters:k,onRefresh:f}){const[c,x]=o.useState(r),[u,s]=o.useState(!1),[v,w]=o.useState(!1),[R,g]=o.useState(!1),N=o.useRef(null),y=o.useRef(null),l=o.useRef(null);o.useEffect(()=>{d&&x(r)},[d]),o.useEffect(()=>{const m=T=>{N.current&&!N.current.contains(T.target)&&s(!1),y.current&&!y.current.contains(T.target)&&w(!1),l.current&&!l.current.contains(T.target)&&g(!1)};return(u||v||R)&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[u,v,R]);const D=["REGULAR","SENIOR_CITIZEN","PWD","PREGNANT"],B=Array.from({length:24},(m,T)=>T),j=()=>{const m=new Date().toISOString().split("T")[0],T={startDate:m,endDate:m,staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""};i(T),x(T)},V=()=>{i(c),k(!1)},q=()=>{x(r),k(!1)},Z=r.staffIds.length>0||r.categoryIds.length>0||r.clientTypes.length>0||r.startHour||r.endHour;if(!t)return e.jsx(Se,{});const de=t.byCategory?Object.entries(t.byCategory).map(([m,T])=>({name:m,value:T})):[],se=t.byClientType?Object.entries(t.byClientType).map(([m,T])=>({name:m,value:T})):[],ie=t.byStaff?Object.entries(t.byStaff).map(([m,T])=>({name:m,value:T})):[],pe=t.byHour?Object.entries(t.byHour).sort((m,T)=>parseInt(m[0])-parseInt(T[0])).map(([m,T])=>({hour:`${m}:00`,value:T})):[];return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Reports & Analytics"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[Z&&e.jsxs("button",{onClick:j,style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"#64748b",fontWeight:"500"},onMouseOver:m=>{m.target.style.color="#1e293b"},onMouseOut:m=>{m.target.style.color="#64748b"},children:[e.jsx(ge,{size:16}),"Clear Filters"]}),e.jsxs("button",{onClick:()=>k(!0),style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:Z?"#2563eb":"#64748b",fontWeight:"500"},onMouseOver:m=>{m.target.style.color="#2563eb"},onMouseOut:m=>{m.target.style.color=Z?"#2563eb":"#64748b"},children:[e.jsx(qt,{size:16}),"Filters"]})]})]}),d&&Oe.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:q,className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Filter Reports"}),e.jsx("button",{onClick:q,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ge,{size:20})})]}),e.jsxs("div",{className:"admin-filter-grid",style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Date"}),e.jsx("input",{type:"date",value:c.startDate,onChange:m=>x({...c,startDate:m.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Date"}),e.jsx("input",{type:"date",value:c.endDate,onChange:m=>x({...c,endDate:m.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{style:{position:"relative"},ref:N,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Staff"}),e.jsx("div",{onClick:()=>s(!u),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.staffIds&&c.staffIds.length>0?c.staffIds.map(m=>{const T=n.find(G=>G.id===m);return T?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:G=>{G.stopPropagation(),x({...c,staffIds:c.staffIds.filter(H=>H!==m)})},children:[T.name,e.jsx(ge,{size:12})]},m):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select staff..."})}),u&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:n.map(m=>{var G;const T=((G=c.staffIds)==null?void 0:G.includes(m.id))||!1;return e.jsxs("div",{onClick:()=>{const H=c.staffIds||[];x(T?{...c,staffIds:H.filter(P=>P!==m.id)}:{...c,staffIds:[...H,m.id]})},style:{padding:"10px 12px",cursor:"pointer",background:T?"#eff6ff":"white",color:T?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:H=>{T||(H.currentTarget.style.background="#f8fafc")},onMouseOut:H=>{T||(H.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:T,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:m.name})]},m.id)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{style:{position:"relative"},ref:y,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Categories"}),e.jsx("div",{onClick:()=>w(!v),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.categoryIds&&c.categoryIds.length>0?c.categoryIds.map(m=>{const T=a.find(G=>G.id===m);return T?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:G=>{G.stopPropagation(),x({...c,categoryIds:c.categoryIds.filter(H=>H!==m)})},children:[T.name,e.jsx(ge,{size:12})]},m):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),v&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:a.map(m=>{var G;const T=((G=c.categoryIds)==null?void 0:G.includes(m.id))||!1;return e.jsxs("div",{onClick:()=>{const H=c.categoryIds||[];x(T?{...c,categoryIds:H.filter(P=>P!==m.id)}:{...c,categoryIds:[...H,m.id]})},style:{padding:"10px 12px",cursor:"pointer",background:T?"#eff6ff":"white",color:T?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:H=>{T||(H.currentTarget.style.background="#f8fafc")},onMouseOut:H=>{T||(H.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:T,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:m.name})]},m.id)})})]}),e.jsxs("div",{style:{position:"relative"},ref:l,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Client Types"}),e.jsx("div",{onClick:()=>g(!R),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:c.clientTypes&&c.clientTypes.length>0?c.clientTypes.map(m=>e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:T=>{T.stopPropagation(),x({...c,clientTypes:c.clientTypes.filter(G=>G!==m)})},children:[m.replace("_"," "),e.jsx(ge,{size:12})]},m)):e.jsx("span",{style:{color:"#94a3b8"},children:"Select client types..."})}),R&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:D.map(m=>{var G;const T=((G=c.clientTypes)==null?void 0:G.includes(m))||!1;return e.jsxs("div",{onClick:()=>{const H=c.clientTypes||[];x(T?{...c,clientTypes:H.filter(P=>P!==m)}:{...c,clientTypes:[...H,m]})},style:{padding:"10px 12px",cursor:"pointer",background:T?"#eff6ff":"white",color:T?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:H=>{T||(H.currentTarget.style.background="#f8fafc")},onMouseOut:H=>{T||(H.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:T,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:m.replace("_"," ")})]},m)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Hour (Peak Hours)"}),e.jsxs(Ke,{value:c.startHour,onChange:m=>x({...c,startHour:m.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),B.map(m=>e.jsxs("option",{value:m,children:[String(m).padStart(2,"0"),":00"]},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Hour (Peak Hours)"}),e.jsxs(Ke,{value:c.endHour,onChange:m=>x({...c,endHour:m.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),B.map(m=>e.jsxs("option",{value:m,children:[String(m).padStart(2,"0"),":00"]},m))]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"24px",paddingTop:"24px",borderTop:"1px solid #e2e8f0"},children:[e.jsx(M,{variant:"outline",icon:ge,onClick:q,children:"Cancel"}),e.jsx(M,{variant:"primary",icon:Me,onClick:V,children:"Apply Filters"})]})]})}),document.body),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsx(we,{label:"Total Served",value:t.totalServed}),e.jsx(we,{label:"Average Duration",value:`${Math.floor((t.averageDuration||0)/60)}m ${(t.averageDuration||0)%60}s`})]}),e.jsxs("div",{className:"admin-reports-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px"},children:[de.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Category"}),e.jsx(Ae,{width:"100%",height:300,children:e.jsxs(et,{data:de,children:[e.jsx(qe,{strokeDasharray:"3 3"}),e.jsx($e,{dataKey:"name"}),e.jsx(Ye,{}),e.jsx(Ee,{}),e.jsx(tt,{dataKey:"value",fill:"#2563eb"})]})})]}),se.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Client Type"}),e.jsx(Ae,{width:"100%",height:300,children:e.jsxs(yt,{children:[e.jsx(bt,{data:se,cx:"50%",cy:"50%",labelLine:!1,label:({name:m,percent:T})=>`${m}: ${(T*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:se.map((m,T)=>e.jsx(vt,{fill:ct[T%ct.length]},`cell-${T}`))}),e.jsx(Ee,{})]})})]})]}),pe.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"24px"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"Peak Hours"}),e.jsx(Ae,{width:"100%",height:300,children:e.jsxs(Qt,{data:pe,children:[e.jsx(qe,{strokeDasharray:"3 3"}),e.jsx($e,{dataKey:"hour"}),e.jsx(Ye,{}),e.jsx(Ee,{}),e.jsx(Kt,{type:"monotone",dataKey:"value",stroke:"#2563eb",strokeWidth:2})]})})]}),ie.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Staff"}),e.jsx(Ae,{width:"100%",height:300,children:e.jsxs(et,{data:ie,children:[e.jsx(qe,{strokeDasharray:"3 3"}),e.jsx($e,{dataKey:"name"}),e.jsx(Ye,{}),e.jsx(Ee,{}),e.jsx(tt,{dataKey:"value",fill:"#10b981"})]})})]})]})}function vn({staffIdleMinutes:t=5,onStaffIdleMinutesSaved:r}){const[i,n]=o.useState(null),[a,d]=o.useState(null),[k,f]=o.useState(null),[c,x]=o.useState(!0),[u,s]=o.useState(!1),[v,w]=o.useState({open:!1}),[R,g]=o.useState(null),[N,y]=o.useState(null),[l,D]=o.useState(!1),[B,j]=o.useState({open:!1}),[V,q]=o.useState([{id:"",name:""},{id:"",name:""},{id:"",name:""}]),[Z,de]=o.useState(""),[se,ie]=o.useState(!1),[pe,m]=o.useState("youtube"),[T,G]=o.useState(!1),[H,P]=o.useState(""),[U,X]=o.useState(!1),[h,L]=o.useState("50"),[oe,W]=o.useState(!1),[_,re]=o.useState("branding"),[he,ue]=o.useState({open:!1}),[ke,Te]=o.useState(!1),[Ie,Ne]=o.useState(String(t)),[Ue,Ve]=o.useState(!1);o.useEffect(()=>{Ne(String(t))},[t]),o.useEffect(()=>{Re(),b(),A(),I(),Y(),$()},[]);const Re=async()=>{try{const p=await C.get("/admin/settings/logo");p.data.logoUrl&&f(p.data.logoUrl)}catch(p){console.error("Failed to load logo:",p)}finally{x(!1)}},b=async()=>{try{const p=await C.get("/admin/settings/ding-sound");p.data.dingSoundUrl&&y(p.data.dingSoundUrl)}catch(p){console.error("Failed to load ding sound:",p)}},A=async()=>{var p;try{const S=await C.get("/admin/settings/tts-voices"),E=Array.isArray(S.data.voices)?S.data.voices:[],O=[...E];for(;O.length<3;)O.push({id:"",name:""});q(O.slice(0,3)),S.data.activeVoiceId?de(S.data.activeVoiceId):(p=E[0])!=null&&p.id&&de(E[0].id)}catch(S){console.error("Failed to load TTS voices:",S)}},I=async()=>{try{const p=await C.get("/admin/settings/video-source");m(p.data.videoSource||"youtube")}catch(p){console.error("Failed to load video source:",p)}},$=async()=>{try{const S=(await C.get("/admin/settings/video-volume")).data.videoVolumePercent;typeof S=="number"&&!Number.isNaN(S)&&L(String(Math.max(0,Math.min(100,S))))}catch(p){console.error("Failed to load video volume:",p)}},Y=async()=>{try{const S=(await C.get("/admin/settings/youtube-playlist")).data.urls||[];P(S.join(`
`))}catch(p){console.error("Failed to load YouTube playlist:",p)}},Q=async p=>{var S,E;G(!0);try{await C.post("/admin/settings/video-source",{videoSource:p}),m(p),te("Video source updated successfully!")}catch(O){F(((E=(S=O.response)==null?void 0:S.data)==null?void 0:E.error)||"Failed to save video source")}finally{G(!1)}},K=async p=>{var E,O;p.preventDefault();const S=H.split(`
`).map(J=>J.trim()).filter(J=>J);X(!0);try{await C.post("/admin/settings/youtube-playlist",{urls:S}),te("YouTube playlist saved!")}catch(J){F(((O=(E=J.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to save playlist")}finally{X(!1)}},ee=p=>{const S=p.target.files[0];if(S){n(S);const E=new FileReader;E.onloadend=()=>{d(E.result)},E.readAsDataURL(S)}},z=async p=>{var S,E;if(p.preventDefault(),!!i){s(!0);try{const O=new FormData;O.append("logo",i);const J=await C.post("/admin/settings/logo",O,{headers:{"Content-Type":"multipart/form-data"}});f(J.data.logoUrl),n(null),d(null),te("Logo uploaded successfully!")}catch(O){console.error("Failed to upload logo:",O),F(((E=(S=O.response)==null?void 0:S.data)==null?void 0:E.error)||"Failed to upload logo")}finally{s(!1)}}},ae=async()=>{w({open:!0,title:"Delete Logo",message:"Are you sure you want to delete the current logo?",onConfirm:async()=>{var p,S;w({open:!1});try{await C.delete("/admin/settings/logo"),f(null),n(null),d(null),te("Logo deleted successfully!")}catch(E){console.error("Failed to delete logo:",E),F(((S=(p=E.response)==null?void 0:p.data)==null?void 0:S.error)||"Failed to delete logo")}},onCancel:()=>w({open:!1})})},xe=p=>{const S=p.target.files[0];S&&g(S)},ce=async p=>{var S,E;if(p.preventDefault(),!!R){D(!0);try{const O=new FormData;O.append("sound",R);const J=await C.post("/admin/settings/ding-sound",O,{headers:{"Content-Type":"multipart/form-data"}});y(J.data.dingSoundUrl),g(null),te("Ding sound uploaded successfully!")}catch(O){console.error("Failed to upload ding sound:",O),F(((E=(S=O.response)==null?void 0:S.data)==null?void 0:E.error)||"Failed to upload ding sound")}finally{D(!1)}}},ne=async()=>{j({open:!0,title:"Delete Ding Sound",message:"Are you sure you want to delete the current ding sound?",onConfirm:async()=>{var p,S;j({open:!1});try{await C.delete("/admin/settings/ding-sound"),y(null),g(null),te("Ding sound deleted successfully!")}catch(E){console.error("Failed to delete ding sound:",E),F(((S=(p=E.response)==null?void 0:p.data)==null?void 0:S.error)||"Failed to delete ding sound")}},onCancel:()=>j({open:!1})})},be=async p=>{const S=typeof p=="string"?p.trim():"";if(!S){F("Please enter a voice ID first");return}const E="Window 1 will now serve number 123, or John Doe.";try{const J=(await C.post("/tts",{text:E,voiceId:S},{responseType:"arraybuffer"})).data;if(!J)return;const fe=new Blob([J],{type:"audio/mpeg"}),Je=URL.createObjectURL(fe);new Audio(Je).play().catch(De=>{console.error("Failed to play preview TTS audio:",De)}).finally(()=>{URL.revokeObjectURL(Je)})}catch(O){console.error("Failed to preview TTS voice:",O),F("Failed to preview this voice. Please check your ElevenLabs settings.")}},me=(p,S,E)=>{q(O=>{const J=[...O];return J[p]={...J[p],[S]:E},J})},ye=async p=>{var S,E;p.preventDefault(),ie(!0);try{const O=V.map(De=>({id:(De.id||"").trim(),name:(De.name||"").trim()})).filter(De=>De.id);if(O.length===0){F("Please enter at least one ElevenLabs voice ID"),ie(!1);return}const J=Z&&O.some(De=>De.id===Z)?Z:O[0].id,fe=await C.post("/admin/settings/tts-voices",{voices:O,activeVoiceId:J}),He=[...Array.isArray(fe.data.voices)?fe.data.voices:O];for(;He.length<3;)He.push({id:"",name:""});q(He.slice(0,3)),de(fe.data.activeVoiceId||J),te("TTS voices updated successfully!")}catch(O){console.error("Failed to save TTS voices:",O),F(((E=(S=O.response)==null?void 0:S.data)==null?void 0:E.error)||"Failed to save TTS voices")}finally{ie(!1)}};return c?e.jsx(Se,{}):e.jsxs("div",{children:[e.jsx(Pe,{...v}),e.jsx(Pe,{...B}),e.jsx(Pe,{...he}),e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px"},children:"Settings"}),e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"24px",borderBottom:"1px solid #e2e8f0",paddingBottom:"4px",overflowX:"auto"},children:[{id:"branding",label:"Branding"},{id:"audio",label:"Audio & TTS"},{id:"videos",label:"Videos"},{id:"data",label:"Data"}].map(p=>{const S=_===p.id;return e.jsx("button",{type:"button",onClick:()=>re(p.id),style:{padding:"8px 16px",borderRadius:"9999px",border:"none",backgroundColor:S?"#1d4ed8":"transparent",color:S?"#ffffff":"#475569",fontSize:"14px",fontWeight:S?600:500,cursor:"pointer",boxShadow:S?"0 1px 3px rgba(15, 23, 42, 0.25)":"none",whiteSpace:"nowrap"},children:p.label},p.id)})}),_==="branding"&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #2563eb"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Logo"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a logo to display across all pages. Supported formats: JPG, PNG, GIF, SVG, WebP (max 5MB)"}),k&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Logo:"}),e.jsx("img",{src:k,alt:"Current logo",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Logo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ee,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),a&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Preview:"}),e.jsx("img",{src:a,alt:"Preview",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("div",{className:"admin-settings-buttons",style:{display:"flex",gap:"8px"},children:[e.jsx(M,{type:"submit",disabled:!i||u,children:u?"Uploading...":"Upload Logo"}),k&&e.jsx(M,{variant:"danger",onClick:ae,children:"Delete Logo"})]})]})]})}),_==="audio"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #f97316"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Ding Sound (Announcement Chime)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a short audio file to play before each queue announcement on the public monitoring page. Supported formats: MP3, WAV, OGG, M4A, AAC (max 2MB). Keep it brief (under 2 seconds) for best results."}),N&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Ding Sound:"}),e.jsx("audio",{controls:!0,src:N,style:{width:"100%",maxWidth:"400px"},children:"Your browser does not support the audio element."})]}),e.jsxs("form",{onSubmit:ce,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Ding Sound"}),e.jsx("input",{type:"file",accept:"audio/*",onChange:xe,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),e.jsxs("div",{className:"admin-settings-buttons",style:{display:"flex",gap:"8px"},children:[e.jsx(M,{type:"submit",disabled:!R||l,children:l?"Uploading...":"Upload Ding Sound"}),N&&e.jsx(M,{variant:"danger",onClick:ne,children:"Delete Ding Sound"})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #10b981"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Text-to-Speech Voices (ElevenLabs)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:"Configure up to three ElevenLabs voice IDs and choose which one is active for queue announcements. Voice IDs can be copied from your ElevenLabs dashboard."}),e.jsxs("form",{onSubmit:ye,children:[V.map((p,S)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1.2fr) minmax(0, 1.4fr) auto",gap:"12px",marginBottom:"12px",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",S+1," Name (optional)"]}),e.jsx("input",{type:"text",value:p.name||"",onChange:E=>me(S,"name",E.target.value),placeholder:"e.g. Front Desk Female",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",S+1," ID"]}),e.jsx("input",{type:"text",value:p.id||"",onChange:E=>me(S,"id",E.target.value),placeholder:"ElevenLabs voice ID",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"6px"},children:[e.jsx("button",{type:"button",onClick:()=>be(p.id),disabled:!p.id,style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",backgroundColor:p.id?"#eff6ff":"#f8fafc",color:p.id?"#2563eb":"#94a3b8",fontSize:"12px",fontWeight:500,cursor:p.id?"pointer":"not-allowed"},children:"Preview Voice"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px"},children:[e.jsx("input",{type:"radio",name:"activeVoice",checked:!!p.id&&Z===p.id,disabled:!p.id,onChange:()=>{p.id&&de(p.id)}}),"Active"]})]})]},S)),e.jsx("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:e.jsx(M,{type:"submit",disabled:se,children:se?"Saving Voices...":"Save Voices"})})]})]})]}),_==="videos"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #6366f1"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Video Source"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"20px"},children:[e.jsx("strong",{children:"YouTube"})," plays videos from a playlist you define. ",e.jsx("strong",{children:"Local"})," lets the display pick a folder on that computer."]}),e.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",border:`2px solid ${pe==="youtube"?"#6366f1":"#e2e8f0"}`,borderRadius:"8px",cursor:"pointer",backgroundColor:pe==="youtube"?"#eef2ff":"transparent"},children:[e.jsx("input",{type:"radio",name:"videoSource",value:"youtube",checked:pe==="youtube",onChange:()=>Q("youtube"),disabled:T}),e.jsxs("span",{children:[e.jsx("strong",{children:"YouTube"})," â€“ Playlist from admin-defined URLs"]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",border:`2px solid ${pe==="local"?"#6366f1":"#e2e8f0"}`,borderRadius:"8px",cursor:"pointer",backgroundColor:pe==="local"?"#eef2ff":"transparent"},children:[e.jsx("input",{type:"radio",name:"videoSource",value:"local",checked:pe==="local",onChange:()=>Q("local"),disabled:T}),e.jsxs("span",{children:[e.jsx("strong",{children:"Local"})," â€“ Folder on the display computer"]})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #0ea5e9"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px"},children:"Default video volume"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:"Set the default playback volume for monitor videos (0 to 100%). This is applied when the monitor page starts."}),e.jsxs("form",{onSubmit:async p=>{var E,O;p.preventDefault();const S=Number(h);if(!Number.isFinite(S)||S<0||S>100){F("Volume must be a number between 0 and 100.");return}W(!0);try{await C.post("/admin/settings/video-volume",{videoVolumePercent:S}),L(String(Math.round(S))),te("Default video volume saved.")}catch(J){F(((O=(E=J.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to save video volume")}finally{W(!1)}},style:{maxWidth:"260px",display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Volume (0â€“100%)"}),e.jsx("input",{type:"number",min:0,max:100,value:h,onChange:p=>L(p.target.value.replace(/[^\d]/g,"").slice(0,3)),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}}),e.jsx("div",{style:{fontSize:"12px",color:"#94a3b8"},children:"Example: 0 = muted, 50 = half volume, 100 = full volume."}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(M,{type:"submit",disabled:oe,children:oe?"Saving...":"Save volume"})})]})]}),pe==="youtube"&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #6366f1"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"YouTube Playlist"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"List YouTube URLs (one per line). Videos play in order on the monitor. Supports youtube.com/watch?v= and youtu.be/ links."}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"YouTube URLs"}),e.jsx("textarea",{value:H,onChange:p=>P(p.target.value),placeholder:`https://www.youtube.com/watch?v=VIDEO_ID
https://youtu.be/VIDEO_ID`,rows:8,style:{width:"100%",padding:"12px 16px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",color:"#1e293b",resize:"vertical",boxSizing:"border-box"},onFocus:p=>{p.target.style.borderColor="#2563eb",p.target.style.backgroundColor="#ffffff"},onBlur:p=>{p.target.style.borderColor="#e2e8f0",p.target.style.backgroundColor="#f8fafc"}})]}),e.jsx(M,{type:"submit",disabled:U,children:U?"Saving...":"Save Playlist"})]})]}),pe==="local"&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderLeft:"4px solid #22c55e"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px"},children:"Local videos"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:"When the monitoring page loads, the user will select a folder containing video files. Videos play directly from that computer. Works in Chrome and Edge."})]})]}),_==="data"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #22c55e"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Staff idle threshold"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:["After this many minutes without activity (e.g. opening the staff dashboard or profile), a staff member is shown as ",e.jsx("strong",{children:"Offline"})," on the Staff page. (1â€“120 minutes.)"]}),e.jsxs("form",{onSubmit:async p=>{var E,O;p.preventDefault();const S=Number(Ie);if(!Number.isFinite(S)||S<1||S>120){F("Enter a number between 1 and 120.");return}Ve(!0);try{const fe=(await C.post("/admin/settings/staff-idle-minutes",{staffIdleMinutes:Math.round(S)})).data.staffIdleMinutes;Ne(String(fe)),typeof r=="function"&&r(fe),te("Staff idle threshold saved.")}catch(J){F(((O=(E=J.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to save.")}finally{Ve(!1)}},style:{maxWidth:"260px",display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Minutes (1â€“120)"}),e.jsx("input",{type:"number",min:1,max:120,value:Ie,onChange:p=>Ne(p.target.value.replace(/[^\d]/g,"").slice(0,3)),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(M,{type:"submit",disabled:Ue,children:Ue?"Saving...":"Save"})})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #dc2626"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Reset queue stats"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Permanently delete all queue entries, serving logs, and daily queue counters. Staff, windows, and categories are not affected. This cannot be undone."}),e.jsx(M,{variant:"danger",disabled:ke,onClick:()=>{ue({open:!0,title:"Reset all queue stats?",message:"This will delete all queue entries, serving logs, and daily counters. Staff, windows, and categories will be kept. This action cannot be undone.",onConfirm:async()=>{var p,S;ue({open:!1}),Te(!0);try{await C.post("/admin/settings/reset-queue-stats"),te("Queue stats reset successfully.")}catch(E){F(((S=(p=E.response)==null?void 0:p.data)==null?void 0:S.error)||"Failed to reset queue stats")}finally{Te(!1)}},onCancel:()=>ue({open:!1})})},children:ke?"Resetting...":"Reset queue stats"})]})]})]})}function wn(){const t=je(),[r,i]=o.useState(!0),[n,a]=o.useState(null),[d,k]=o.useState(""),[f,c]=o.useState(!1),[x,u]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[s,v]=o.useState(!1),[w,R]=o.useState(!1);o.useEffect(()=>{const l=localStorage.getItem("token"),D=ze();if(!l||(D==null?void 0:D.role)!=="ADMIN"){t("/admin/login");return}g()},[t]),o.useEffect(()=>{k((n==null?void 0:n.name)??"")},[n==null?void 0:n.name]);const g=async()=>{var l;try{const D=await C.get("/admin/profile");a(D.data.admin)}catch(D){console.error("Failed to load profile:",D),((l=D.response)==null?void 0:l.status)===401&&t("/admin/login")}finally{i(!1)}},N=async l=>{var B,j,V,q,Z,de;l.preventDefault();const D=(d??"").trim();R(!0);try{const se=await C.put("/admin/profile",{name:D||null});a(se.data.admin);const ie=ze();ie&&(ie.name=se.data.admin.name??null,localStorage.setItem("user",JSON.stringify(ie))),te("Name updated successfully")}catch(se){F(((j=(B=se.response)==null?void 0:B.data)==null?void 0:j.error)||((de=(Z=(q=(V=se.response)==null?void 0:V.data)==null?void 0:q.errors)==null?void 0:Z[0])==null?void 0:de.msg)||"Failed to update name")}finally{R(!1)}},y=async l=>{var D,B;if(l.preventDefault(),x.newPassword!==x.confirmPassword){F("New passwords do not match");return}if(x.newPassword.length<6){F("Password must be at least 6 characters");return}v(!0);try{await C.post("/admin/profile/change-password",{currentPassword:x.currentPassword,newPassword:x.newPassword}),te("Password changed successfully!"),c(!1),u({currentPassword:"",newPassword:"",confirmPassword:""})}catch(j){F(((B=(D=j.response)==null?void 0:D.data)==null?void 0:B.error)||"Failed to change password")}finally{v(!1)}};return r?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{})}):e.jsxs("div",{className:"admin-profile-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx("style",{children:`
        .admin-profile-root { padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
        @media (max-width: 768px) {
          .admin-profile-header { flex-wrap: wrap; gap: 12px; padding: 12px 16px !important; }
          .admin-profile-content { margin: 24px auto !important; padding: 0 16px !important; }
          .admin-profile-card { padding: 24px !important; }
        }
      `}),e.jsxs("div",{className:"admin-profile-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ce,{size:"small"}),e.jsx(M,{variant:"outline",icon:xt,onClick:()=>t("/admin/dashboard"),children:"Back to Dashboard"})]}),e.jsx("div",{className:"admin-profile-content",style:{maxWidth:"600px",margin:"40px auto",padding:"0 24px"},children:e.jsxs("div",{className:"admin-profile-card",style:{background:"white",borderRadius:"12px",padding:"32px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px",color:"#1e293b"},children:"Admin Profile"}),e.jsxs("form",{onSubmit:N,children:[e.jsx(le,{label:"Name",value:d,onChange:l=>k(l.target.value),placeholder:"Your display name"}),e.jsx(M,{type:"submit",icon:gt,disabled:w,style:{marginTop:"16px"},children:w?"Saving...":"Save name"})]}),e.jsx("div",{style:{marginTop:"24px"},children:e.jsx(le,{label:"Username",value:(n==null?void 0:n.username)||"",disabled:!0,readOnly:!0,style:{background:"#f1f5f9",color:"#64748b",cursor:"not-allowed",border:"2px solid #e2e8f0",borderRadius:"8px",padding:"12px"}})}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Change Password"}),e.jsx(M,{variant:"outline",icon:ot,onClick:()=>{c(!f),f&&u({currentPassword:"",newPassword:"",confirmPassword:""})},children:f?"Cancel":"Change Password"})]}),f&&e.jsxs("form",{onSubmit:y,children:[e.jsx(le,{label:"Current Password",type:"password",value:x.currentPassword,onChange:l=>u({...x,currentPassword:l.target.value}),required:!0}),e.jsx(le,{label:"New Password",type:"password",value:x.newPassword,onChange:l=>u({...x,newPassword:l.target.value}),required:!0}),e.jsx(le,{label:"Confirm New Password",type:"password",value:x.confirmPassword,onChange:l=>u({...x,confirmPassword:l.target.value}),required:!0}),e.jsx(M,{type:"submit",icon:ft,disabled:s,style:{marginTop:"16px"},children:s?"Changing...":"Change Password"})]})]})]})})]})}function jn(){return o.useEffect(()=>{let t=document.querySelector('link[rel="icon"]');t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t));const r=d=>{const k=d&&!d.startsWith("http")&&!d.startsWith("data:")?d.startsWith("/")?window.location.origin+d:window.location.origin+"/"+d:d;t.href=k},i="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23667eea' rx='12'/%3E%3Ctext x='50' y='68' font-size='60' font-weight='bold' dominant-baseline='middle' text-anchor='middle' fill='white' font-family='system-ui,sans-serif'%3EQ%3C/text%3E%3C/svg%3E",n=async()=>{var d;try{const k=await C.get("/admin/settings/logo");(d=k.data)!=null&&d.logoUrl?r(k.data.logoUrl):r(i)}catch{r(i)}};n();const a=setInterval(n,3e4);return()=>clearInterval(a)},[]),null}function Sn(){return e.jsxs(e.Fragment,{children:[e.jsx(jn,{}),e.jsx(ln,{}),e.jsxs($t,{children:[e.jsx(ve,{path:"/",element:e.jsx(Zt,{})}),e.jsx(ve,{path:"/success",element:e.jsx(tn,{})}),e.jsx(ve,{path:"/thank-you",element:e.jsx(nn,{})}),e.jsx(ve,{path:"/monitor",element:e.jsx(on,{})}),e.jsx(ve,{path:"/staff/login",element:e.jsx(an,{})}),e.jsx(ve,{path:"/staff/dashboard",element:e.jsx(dn,{})}),e.jsx(ve,{path:"/staff/profile",element:e.jsx(cn,{})}),e.jsx(ve,{path:"/admin/login",element:e.jsx(pn,{})}),e.jsx(ve,{path:"/admin/dashboard",element:e.jsx(gn,{})}),e.jsx(ve,{path:"/admin/profile",element:e.jsx(wn,{})})]})]})}Yt.createRoot(document.getElementById("root")).render(e.jsx(_t.StrictMode,{children:e.jsx(Gt,{children:e.jsx(Sn,{})})}));
