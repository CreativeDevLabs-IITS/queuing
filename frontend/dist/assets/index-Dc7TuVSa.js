import{ad as St,ae as e,r as o,af as ye,ag as lt,ah as dt,ai as Ct,aj as kt,ak as It,al as Ze,am as ce,an as Tt,ao as Dt,ap as ct,aq as pt,ar as Qe,as as et,at as ut,au as zt,av as Rt,aw as xt,ax as gt,ay as Wt,az as Pt,aA as At,aB as Et,aC as Bt,aD as Nt,aE as Lt,aF as Ot,aG as Ne,aH as Le,aI as tt,aJ as Mt,aK as Ve,aL as Ke,aM as Ft,aN as Ut,aO as he,aP as Vt,R as Ht,aQ as qt}from"./vendor-DxPz6D9i.js";import{R as We,B as Je,C as Me,X as Fe,Y as Ue,T as Pe,a as Xe,P as ft,b as ht,c as mt,L as $t,d as Yt}from"./recharts-DmFB1HYV.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const j of c.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&n(j)}).observe(document,{childList:!0,subtree:!0});function i(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(a){if(a.ep)return;a.ep=!0;const c=i(a);fetch(a.href,c)}})();const _t="/api",C=St.create({baseURL:_t,headers:{"Content-Type":"application/json"}});C.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers.Authorization=`Bearer ${s}`),t});C.interceptors.response.use(t=>t,t=>{var i;const s=(i=t.response)==null?void 0:i.status;if(s===401||s===403){localStorage.removeItem("token"),localStorage.removeItem("user");const n=window.location.pathname;n.startsWith("/admin")?n!=="/admin/login"&&(window.location.href="/admin/login"):n.startsWith("/staff")&&n!=="/staff/login"&&(window.location.href="/staff/login")}return Promise.reject(t)});function Ie(){const t=localStorage.getItem("user");if(t==null||t===""||t==="undefined")return null;try{return JSON.parse(t)}catch{return null}}const nt="queueEntry",ot="queueDate",yt=t=>{const s=new Date().toISOString().split("T")[0];localStorage.setItem(nt,JSON.stringify(t)),localStorage.setItem(ot,s)},He=()=>{const t=localStorage.getItem(nt),s=localStorage.getItem(ot),i=new Date().toISOString().split("T")[0];if(!t||s!==i)return s!==i&&Oe(),null;try{return JSON.parse(t)}catch{return Oe(),null}},Oe=()=>{localStorage.removeItem(nt),localStorage.removeItem(ot)};function ie({label:t,error:s,style:i,disabled:n,...a}){const c={width:"100%",padding:"12px",borderRadius:"8px",border:s?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",transition:"border-color 0.2s",...n&&{background:"#f1f5f9",color:"#64748b",cursor:"not-allowed"},...i};return e.jsxs("div",{style:{marginBottom:"16px"},children:[t&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:t}),e.jsx("input",{style:c,disabled:n,...a}),s&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:s})]})}function O({children:t,onClick:s,variant:i="primary",disabled:n=!1,fullWidth:a=!1,icon:c,iconPosition:j="left",type:m,style:p,...u}){const g={padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",opacity:n?.6:1,width:a?"100%":"auto",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:i==="primary"||i==="success"||i==="danger"||i==="gradient"?"0 2px 4px rgba(0,0,0,0.1)":"none",...p},r={primary:{background:n?"#cbd5e1":"#2563eb",color:"white"},gradient:{background:n?"#cbd5e1":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",boxShadow:n?"none":"0 4px 12px rgba(102, 126, 234, 0.4)"},secondary:{background:n?"#cbd5e1":"#64748b",color:"white"},success:{background:n?"#cbd5e1":"#10b981",color:"white"},danger:{background:n?"#cbd5e1":"#ef4444",color:"white"},outline:{background:"transparent",color:n?"#cbd5e1":"#2563eb",border:`2px solid ${n?"#cbd5e1":"#2563eb"}`}},w=r[i]||r.primary,S=c&&e.jsx(c,{size:18,strokeWidth:2.5}),R=j==="left"?e.jsxs(e.Fragment,{children:[" ",S," ",t," "]}):e.jsxs(e.Fragment,{children:[" ",t," ",S," "]});return e.jsx("button",{type:m||"button",style:{...g,...w},onClick:n?void 0:s,disabled:n,onMouseOver:f=>{n||(i==="primary"?(f.target.style.background="#1e40af",f.target.style.boxShadow="0 4px 8px rgba(37, 99, 235, 0.3)"):i==="outline"?f.target.style.background="#eff6ff":i==="danger"?(f.target.style.background="#dc2626",f.target.style.boxShadow="0 4px 8px rgba(239, 68, 68, 0.3)"):i==="success"?(f.target.style.background="#059669",f.target.style.boxShadow="0 4px 8px rgba(16, 185, 129, 0.3)"):i==="gradient"&&(f.target.style.background="linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)",f.target.style.boxShadow="0 6px 16px rgba(102, 126, 234, 0.5)"))},onMouseOut:f=>{n||(f.target.style.background=w.background,f.target.style.boxShadow=i==="gradient"?"0 4px 12px rgba(102, 126, 234, 0.4)":i==="primary"||i==="success"||i==="danger"?"0 2px 4px rgba(0,0,0,0.1)":"none")},...u,children:R})}function be(){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #2563eb",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})}function ve({size:t="medium",showText:s=!0,gap:i="12px"}){const[n,a]=o.useState(null),[c,j]=o.useState(!0),[m,p]=o.useState(!1);o.useEffect(()=>{u();const w=setInterval(u,3e4);return()=>clearInterval(w)},[]);const u=async()=>{try{const w=await C.get("/admin/settings/logo");if(w.data.logoUrl){let S=w.data.logoUrl;S&&!S.startsWith("http")&&!S.startsWith("/")&&(S="/"+S);const R=S.includes("?")?"&":"?";S=S+R+"_t="+Date.now(),a(S),p(!1)}else a(null),p(!1)}catch(w){console.error("Failed to load logo:",w),p(!0)}finally{j(!1)}},g={small:{width:"80px",height:"40px"},medium:{width:"120px",height:"60px"},large:{width:"180px",height:"90px"},monitor:{width:"88px",height:"80px"}},r=g[t]||g.medium;return c?null:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i},children:[n&&!m?e.jsx("img",{src:n,alt:"Logo",style:{...r,objectFit:"contain",maxWidth:"100%"},onError:w=>{console.error("Failed to load logo image:",n),p(!0),a(null)}}):e.jsx("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",fontWeight:"700",fontSize:t==="small"?"14px":t==="large"?"24px":"18px"},children:"Q"}),s&&e.jsx("span",{style:{fontSize:t==="small"?"18px":t==="large"?"28px":"24px",fontWeight:"700",color:"#1e293b"}})]})}const Gt=[{value:"REGULAR",label:"Regular"},{value:"SENIOR_CITIZEN",label:"Senior Citizen"},{value:"PWD",label:"PWD"},{value:"PREGNANT",label:"Pregnant"}];function Qt(){var B;const t=ye(),[s,i]=o.useState(!0),[n,a]=o.useState(!1),[c,j]=o.useState([]),[m,p]=o.useState({clientName:"",clientType:"REGULAR",categoryIds:[],subCategoryIds:[]}),[u,g]=o.useState({});o.useEffect(()=>{r()},[]);const r=async()=>{var l;try{const h=await C.get("/categories");j(Array.isArray((l=h.data)==null?void 0:l.categories)?h.data.categories:[])}catch(h){console.error("Failed to load categories:",h)}finally{i(!1)}},w=o.useMemo(()=>{var W;if(!((W=m.categoryIds)!=null&&W.length))return[];const l=(c||[]).filter(T=>m.categoryIds.includes(T.id)),h=new Map;return l.forEach(T=>{(T.subCategories||[]).forEach(N=>{h.has(N.id)||h.set(N.id,{...N,categoryName:T.name})})}),Array.from(h.values())},[m.categoryIds,c]),S=l=>{const h=m.categoryIds||[],W=h.includes(l)?h.filter(Y=>Y!==l):[...h,l],T=(c||[]).filter(Y=>W.includes(Y.id)),N=new Set;T.forEach(Y=>{(Y.subCategories||[]).forEach(J=>N.add(J.id))}),p({...m,categoryIds:W,subCategoryIds:(m.subCategoryIds||[]).filter(Y=>N.has(Y))})},R=l=>{const h=m.subCategoryIds||[],W=h.includes(l)?h.filter(T=>T!==l):[...h,l];p({...m,subCategoryIds:W})},f=async l=>{var W,T,N,Y;l.preventDefault(),g({});const h={};if(m.clientName.trim()||(h.clientName="Name is required"),(W=m.categoryIds)!=null&&W.length||(h.categoryId="Select at least one category"),Object.keys(h).length>0){g(h);return}a(!0);try{const te=(await C.post("/queue/join",{clientName:m.clientName.trim(),clientType:m.clientType,categoryIds:m.categoryIds,subCategoryIds:(T=m.subCategoryIds)!=null&&T.length?m.subCategoryIds:void 0})).data.queueEntry,re=(te.concernCategories||[te.category]).map(ae=>ae.name).join(", "),X=(te.concernSubCategories||[]).map(ae=>ae.name).join(", ")||null;yt({queueNumber:te.queueNumber,clientName:te.clientName,date:te.date,category:re,subCategory:X,clientType:te.clientType,status:te.status}),t("/success")}catch(J){console.error("Failed to join queue:",J),g({submit:((Y=(N=J.response)==null?void 0:N.data)==null?void 0:Y.error)||"Failed to join queue"})}finally{a(!1)}};return s?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})}):e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(ve,{size:"medium"})}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Join Queue"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Fill in your details to get a queue number"}),e.jsxs("form",{onSubmit:f,children:[e.jsx(ie,{label:"Your Name",value:m.clientName,onChange:l=>p({...m,clientName:l.target.value}),error:u.clientName,placeholder:"Enter your full name",required:!0}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Client Type"}),e.jsx("div",{className:"client-type-pills",children:Gt.map(({value:l,label:h})=>e.jsxs("label",{className:`pill-radio ${m.clientType===l?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"clientType",value:l,checked:m.clientType===l,onChange:()=>p({...m,clientType:l})}),e.jsx("span",{children:h})]},l))})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:["Concern Category ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),u.categoryId&&e.jsx("div",{style:{fontSize:"12px",color:"#ef4444",marginBottom:"8px"},children:u.categoryId}),e.jsx("div",{className:"checkbox-group",children:(c||[]).map(l=>e.jsxs("label",{className:`checkbox-row ${(m.categoryIds||[]).includes(l.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(m.categoryIds||[]).includes(l.id),onChange:()=>S(l.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:l.name})]},l.id))})]}),w.length>0&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#1e293b"},children:"Sub-Concern (Optional)"}),e.jsx("div",{className:"checkbox-group",children:w.map(l=>e.jsxs("label",{className:`checkbox-row ${(m.subCategoryIds||[]).includes(l.id)?"selected":""}`,children:[e.jsx("input",{type:"checkbox",checked:(m.subCategoryIds||[]).includes(l.id),onChange:()=>R(l.id)}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{children:l.name})]},l.id))})]}),u.submit&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:u.submit}),e.jsx(O,{type:"submit",variant:"gradient",fullWidth:!0,disabled:n||!m.clientType||!((B=m.categoryIds)!=null&&B.length),style:{marginTop:"8px",padding:"14px 24px",fontSize:"16px"},children:n?"Joining...":"Join Queue"})]}),e.jsx("div",{style:{marginTop:"24px",textAlign:"center"},children:e.jsx("a",{href:"/monitor",style:{color:"#2563eb",textDecoration:"none",fontSize:"14px"},children:"View Queue Status â†’"})})]})})}function qe(t){if(!t)return"";const s=t.split("-");return s.length>1?s[1]:t}function Kt(t){return t?t.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()).join(" "):""}function bt({window:t,compact:s=!1}){const{label:i,staff:n,currentServing:a}=t,c=u=>{const g=u.trim().split(" ");return g.length>=2?(g[0][0]+g[g.length-1][0]).toUpperCase():u.substring(0,2).toUpperCase()},j=(n==null?void 0:n.name)||"â€”",m=a?qe(a.queueNumber):null,p=a&&[a.clientName||"",a.clientType?`(${Kt(a.clientType)})`:""].filter(Boolean).join(" ").trim()||null;return e.jsxs("div",{style:{background:"#0b1120",borderRadius:"12px",padding:0,boxShadow:"0 4px 12px rgba(15,23,42,0.6)",border:"1px solid #1e293b",transition:"all 0.2s",display:"flex",alignItems:"stretch",minHeight:s?0:"96px",flex:1,overflow:"hidden"},children:[e.jsx("div",{style:{flex:"0 0 34%",maxWidth:"110px",borderRadius:"12px",background:n!=null&&n.profilePicture?void 0:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:n!=null&&n.profilePicture?e.jsx("img",{src:n.profilePicture,alt:j,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}}):e.jsx("span",{style:{color:"white",fontWeight:"700",fontSize:"24px"},children:c(j)})}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0,padding:"6px 8px 6px 8px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"700",color:"#e5e7eb",marginBottom:"2px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j}),a?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#cbd5f5",marginBottom:"4px"},children:"is now serving:"}),e.jsx("div",{style:{fontSize:"clamp(22px, 2.8vw, 34px)",fontWeight:"700",color:"#fbbf24",lineHeight:1.05,marginBottom:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:m}),p&&e.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#cbd5f5",marginBottom:"4px",maxHeight:"2.6em",overflow:"hidden"},children:p})]}):e.jsx("div",{style:{fontSize:"11px",fontWeight:"600",color:"#64748b",fontStyle:"italic"},children:"No active service"}),e.jsx("div",{style:{marginTop:"auto",paddingTop:"2px",fontSize:"15px",fontWeight:"700",color:"#38bdf8",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i})]})]})}function vt({clientType:t}){const s={REGULAR:{bg:"#e2e8f0",color:"#475569"},SENIOR_CITIZEN:{bg:"#fef3c7",color:"#92400e"},PWD:{bg:"#dbeafe",color:"#1e40af"},PREGNANT:{bg:"#fce7f3",color:"#9f1239"}},i={REGULAR:"Regular",SENIOR_CITIZEN:"Senior",PWD:"PWD",PREGNANT:"Pregnant"},n=s[t]||s.REGULAR;return e.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:n.bg,color:n.color},children:i[t]})}function Jt(){const t=ye(),[s,i]=o.useState(null),[n,a]=o.useState([]),[c,j]=o.useState(!0),[m,p]=o.useState(0);o.useEffect(()=>{const w=He();if(!w){t("/");return}i(w),u();const S=setInterval(u,2e3);return()=>clearInterval(S)},[t]),o.useEffect(()=>{(s==null?void 0:s.status)==="SERVED"&&t("/thank-you")},[s==null?void 0:s.status,t]);const u=async()=>{var w;try{const S=He()||s;if(S!=null&&S.queueNumber){const B=(await C.get(`/queue/${S.queueNumber}`)).data.queueEntry,l={...S,status:B.status};if(i(l),yt(l),B.status==="SERVED"){t("/thank-you");return}if(B.status==="WAITING")try{const h=await C.get(`/queue/${S.queueNumber}/ahead`);p(h.data.peopleAhead||0)}catch{const W=await C.get("/queue/public/stats");p(W.data.waiting||0)}else p(0)}const R=await C.get("/queue/public/windows");a(R.data.windows)}catch(S){console.error("Failed to load data:",S),((w=S.response)==null?void 0:w.status)===404&&(Oe(),t("/"))}finally{j(!1)}};if(c||!s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})});const g={WAITING:{bg:"#fef3c7",color:"#92400e",text:"Waiting"},NOW_SERVING:{bg:"#dbeafe",color:"#1e40af",text:"Being served"},SERVED:{bg:"#d1fae5",color:"#065f46",text:"Served"},SKIPPED:{bg:"#fee2e2",color:"#991b1b",text:"Skipped"}},r=g[s.status]||g.WAITING;return e.jsx("div",{style:{minHeight:"100vh",background:"#f8fafc",padding:"20px"},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(ve,{size:"medium"})}),e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"32px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:["Hello, ",s.clientName]}),e.jsx("div",{style:{fontSize:"48px",fontWeight:"700",color:"#2563eb",marginBottom:"16px",letterSpacing:"2px"},children:qe(s.queueNumber)}),e.jsx("div",{style:{display:"inline-block",padding:"8px 16px",borderRadius:"20px",backgroundColor:r.bg,color:r.color,fontSize:"14px",fontWeight:"600",marginBottom:"16px"},children:r.text}),e.jsxs("div",{style:{marginTop:"16px",display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(vt,{clientType:s.clientType}),e.jsxs("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",backgroundColor:"#e2e8f0",color:"#475569"},children:[s.category,s.subCategory&&` - ${s.subCategory}`]})]}),s.status==="WAITING"&&m>0&&e.jsxs("div",{style:{marginTop:"16px",fontSize:"14px",color:"#64748b"},children:["Approximately ",m," ",m===1?"person":"people"," ahead"]}),e.jsx("div",{style:{marginTop:"24px",padding:"16px",background:"#f1f5f9",borderRadius:"8px",fontSize:"14px",color:"#475569"},children:"ðŸ’¡ You can leave and monitor your queue status from this page. We'll update automatically."})]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px",color:"#1e293b"},children:"Active Windows"}),e.jsx("div",{className:"grid-responsive",style:{display:"grid",gap:"16px"},children:n.length>0?n.map(w=>e.jsx(bt,{window:w},w.id)):e.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",color:"#64748b"},children:"No active windows at the moment"})})]})]})})}function Xt(){const t=ye();o.useEffect(()=>{const i=He();if(!i||i.status!=="SERVED"){t("/");return}const n=setTimeout(()=>{Oe()},5e3);return()=>clearTimeout(n)},[t]);const s=He();return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"48px",maxWidth:"600px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(ve,{size:"medium"})}),e.jsx("div",{style:{fontSize:"64px",marginBottom:"24px"},children:"âœ…"}),e.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"16px",color:"#1e293b"},children:"Thank You!"}),s&&e.jsxs("p",{style:{fontSize:"18px",color:"#64748b",marginBottom:"24px"},children:["Thank you, ",e.jsx("strong",{children:s.clientName}),", for your visit."]}),e.jsx("p",{style:{fontSize:"16px",color:"#475569",marginBottom:"32px",lineHeight:"1.6"},children:"We appreciate your business and look forward to serving you again."}),e.jsx("div",{style:{padding:"20px",background:"#f1f5f9",borderRadius:"12px",marginBottom:"32px"},children:e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:"Your service has been completed. Have a wonderful day!"})}),e.jsx("button",{onClick:()=>{Oe(),t("/")},style:{padding:"12px 32px",borderRadius:"8px",border:"none",background:"#2563eb",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:i=>{i.target.style.background="#1e40af"},onMouseOut:i=>{i.target.style.background="#2563eb"},children:"Return to Home"})]})})}function Zt(){const[t,s]=o.useState([]),[i,n]=o.useState([]),[a,c]=o.useState(null),[j,m]=o.useState(!0),[p,u]=o.useState(!1),[g,r]=o.useState("youtube"),[w,S]=o.useState(null),R=o.useRef(null),f=o.useRef(null),B=o.useRef(null),l=o.useRef([]);l.current=i;const h=o.useRef([]),W=o.useRef(!1),T=o.useRef([]),N=o.useRef(!1),Y=o.useRef(null),J=o.useRef(0),te=8e3,re=.5,[X,ae]=o.useState(null),ue=o.useRef(null),y=o.useRef(!1),I=o.useRef(null),[_,F]=o.useState(!1),[P,U]=o.useState(50);o.useEffect(()=>{d(),A();const b=setInterval(d,2e3);return()=>clearInterval(b)},[]),o.useEffect(()=>{_e()},[]),o.useEffect(()=>{i.length>0&&!y.current&&F(!0)},[i]);const Q=o.useRef(null);o.useEffect(()=>{const b=()=>{var E;return(E=Q.current)==null?void 0:E.call(Q)};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[]),o.useEffect(()=>{i.length>0&&!a&&c(i[0])},[i,a]),o.useEffect(()=>()=>{i.forEach(b=>{b._blobUrl&&b.url&&URL.revokeObjectURL(b.url)})},[i]),o.useEffect(()=>{if(g!=="local"||!R.current||!a)return;const b=R.current,E=()=>{const $=(i.findIndex(K=>K.url===a.url)+1)%i.length;c(i[$])};b.addEventListener("ended",E),b.volume=re,b.load();const k=b.play();return k!==void 0&&k.then(()=>{b.muted=!1}).catch(()=>{b.muted=!0,b.play().catch(console.error)}),()=>b.removeEventListener("ended",E)},[a,i,g]),o.useEffect(()=>{var $;if(g!=="youtube"||!(a!=null&&a.id))return;const b=K=>{if(f.current){f.current.loadVideoById(K);const z=Math.max(0,Math.min(100,P))/100;f.current.setVolume(Math.round(z*100));return}const G=B.current;if(!G)return;const Z=document.createElement("div");Z.id="youtube-player-"+Date.now(),G.innerHTML="",G.appendChild(Z),f.current=new window.YT.Player(Z.id,{videoId:K,width:"100%",height:"100%",playerVars:{autoplay:1,mute:1,rel:0,modestbranding:1},events:{onReady:z=>{const oe=Math.max(0,Math.min(100,P))/100;z.target.setVolume(Math.round(oe*100)),y.current&&z.target.unMute()},onStateChange:z=>{if(z.data===0){const oe=l.current,v=(oe.findIndex(D=>D.id===K)+1)%oe.length;oe[v]&&c(oe[v])}}}})};if(($=window.YT)!=null&&$.Player)return b(a.id),()=>{};if(window.YTLoadReady)return window.YT.ready(()=>b(a.id)),()=>{};const E=document.createElement("script");E.src="https://www.youtube.com/iframe_api";const k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(E,k);const q=window.onYouTubeIframeAPIReady;return window.onYouTubeIframeAPIReady=()=>{window.YTLoadReady=!0,q&&q(),b(a.id)},()=>{}},[a,i,g,P]),o.useEffect(()=>()=>{if(f.current){try{f.current.destroy()}catch{}f.current=null}B.current&&(B.current.innerHTML="")},[]);const d=async()=>{try{const E=(await C.get("/queue/public/windows")).data.windows||[],k=h.current;s(E),h.current=E,setTimeout(()=>{try{Se(k,E)}catch(q){console.error("Failed to run TTS announcements:",q)}},0)}catch(b){console.error("Failed to load windows:",b)}finally{m(!1)}},A=async()=>{try{const E=(await C.get("/admin/settings/ding-sound")).data.dingSoundUrl||null;ae(E),ue.current=E}catch(b){console.error("Failed to load ding sound URL:",b),ae(null),ue.current=null}},M=b=>{if(typeof window>"u"){console.log("playDing: window undefined"),b&&setTimeout(b,7e3);return}console.log("playDing: starting");let k=!1,q=null;q=setTimeout(()=>{if(!k&&(console.warn("playDing: Ultimate timeout reached, forcing safeDone"),k=!0,b))try{b()}catch(K){console.error("playDing: Error in onDone callback:",K)}},7e3);const $=()=>{if(k){console.log("playDing: safeDone called but already done");return}if(k=!0,q&&(clearTimeout(q),q=null),console.log("playDing: done - calling onDone callback"),b)try{b()}catch(K){console.error("playDing: Error in onDone callback:",K)}else console.warn("playDing: No onDone callback provided")};try{const K=ue.current||X;if(K&&typeof K=="string"){const Z=K.startsWith("http")?K:`${window.location.origin}${K.startsWith("/")?"":"/"}${K}`;console.log("playDing: Using custom ding sound:",Z);const z=new Audio(Z);z.volume=1;let oe=!1;const x=()=>{if(k)return;console.log("playDing: Trying synthesized chime fallback");const pe=window.AudioContext||window.webkitAudioContext;if(!pe){console.warn("playDing: No AudioContext available"),$();return}let se=I.current;if(!se)try{se=new pe,se.state,I.current=se}catch(de){console.warn("playDing: Cannot create AudioContext (needs user gesture):",de),k||$();return}if(!se){console.warn("playDing: No AudioContext available"),k||$();return}const fe=()=>{if(!k)try{console.log("playDing: Playing synthesized chime");const de=se.createOscillator(),Ee=se.createOscillator(),Re=se.createGain();de.type="sine",Ee.type="sine";const je=se.currentTime;de.frequency.setValueAtTime(880,je),Ee.frequency.setValueAtTime(1175,je+.08),de.connect(Re),Ee.connect(Re),Re.connect(se.destination),Re.gain.setValueAtTime(1e-4,je),Re.gain.exponentialRampToValueAtTime(.25,je+.03),Re.gain.exponentialRampToValueAtTime(1e-4,je+.4),de.start(je),Ee.start(je+.08),de.stop(je+.4),Ee.stop(je+.4),setTimeout(()=>{k||(console.log("playDing: Synthesized chime finished"),$())},500)}catch(de){console.error("playDing: Failed to play chime:",de),k||$()}};se.state==="suspended"&&se.resume?se.resume().then(()=>{k||fe()}).catch(de=>{console.warn("playDing: AudioContext resume failed:",de),k||$()}):fe()},v=()=>{if(k)return;console.log("playDing: Audio ended event fired, currentTime:",z.currentTime,"duration:",z.duration),z.removeEventListener("ended",v),z.removeEventListener("error",D),z.removeEventListener("canplaythrough",H),z.removeEventListener("loadeddata",H),z.currentTime>=Math.min(.1,z.duration*.1)||z.duration===0?(console.log("playDing: Custom ding played successfully"),oe=!0,$()):(console.warn("playDing: Custom ding ended immediately, trying fallback chime"),x())},D=pe=>{console.error("Failed to play custom ding sound:",pe),z.removeEventListener("ended",v),z.removeEventListener("error",D),z.removeEventListener("canplaythrough",H),z.removeEventListener("loadeddata",H),x()},L=()=>{console.log("playDing: Audio ready, attempting to play, readyState:",z.readyState,"duration:",z.duration,"currentTime:",z.currentTime),z.currentTime=0,setTimeout(()=>{const pe=z.play();pe!==void 0?pe.then(()=>{console.log("playDing: Audio playing successfully, paused:",z.paused,"currentTime:",z.currentTime,"duration:",z.duration),setTimeout(()=>{z.paused&&!k&&!oe?(console.warn("playDing: Audio paused after play() promise resolved, may be blocked by autoplay policy. Will try fallback chime."),D(new Error("Autoplay blocked"))):z.paused||console.log("playDing: Audio confirmed playing, currentTime:",z.currentTime)},100)}).catch(se=>{console.error("Failed to start custom ding sound:",se),D(se)}):(console.warn("playDing: play() returned undefined"),setTimeout(()=>{z.paused&&!k&&!oe&&(console.warn("playDing: Audio is paused after play(), treating as error. Will try fallback chime."),D(new Error("Audio did not start playing")))},100))},10)},H=()=>{z.removeEventListener("canplaythrough",H),z.removeEventListener("loadeddata",H),L()};z.addEventListener("ended",v),z.addEventListener("error",D),z.readyState>=2?(console.log("playDing: Audio already loaded, playing immediately"),L()):(z.addEventListener("canplaythrough",H),z.addEventListener("loadeddata",H),z.load()),setTimeout(()=>{!k&&!oe&&(console.warn("playDing: Custom ding timeout (2s), trying fallback chime"),z.removeEventListener("ended",v),z.removeEventListener("error",D),z.removeEventListener("canplaythrough",H),z.removeEventListener("loadeddata",H),x())},2e3);return}const G=window.AudioContext||window.webkitAudioContext;if(G){const Z=I.current||new G,z=()=>{console.log("playDing: Playing synthesized chime");const oe=Z.createOscillator(),x=Z.createOscillator(),v=Z.createGain();oe.type="sine",x.type="sine";const D=Z.currentTime;oe.frequency.setValueAtTime(880,D),x.frequency.setValueAtTime(1175,D+.08),oe.connect(v),x.connect(v),v.connect(Z.destination),v.gain.setValueAtTime(1e-4,D),v.gain.exponentialRampToValueAtTime(.25,D+.03),v.gain.exponentialRampToValueAtTime(1e-4,D+.4),oe.start(D),x.start(D+.08),oe.stop(D+.4),x.stop(D+.4),setTimeout(()=>{console.log("playDing: Synthesized chime finished"),$()},500)};Z.state==="suspended"&&Z.resume?Z.resume().then(()=>{z()}).catch(()=>{z()}):z();return}console.warn("playDing: No AudioContext available, cannot play chime"),$()}catch(K){console.error("Failed to play ding sound:",K)}setTimeout($,7e3)},ne=b=>{const E=R.current;E&&(E.volume=Math.max(0,Math.min(1,b)));const k=f.current;k&&typeof k.setVolume=="function"&&k.setVolume(Math.round(Math.max(0,Math.min(1,b))*100))},xe=(b,E)=>{if(typeof window<"u"&&window.speechSynthesis){window.speechSynthesis.cancel();const k=new SpeechSynthesisUtterance(b);k.lang="en-US",k.rate=1,k.pitch=1,k.onend=E,k.onerror=E,window.speechSynthesis.speak(k)}else E()},ge=b=>new Promise(E=>{if(!b||typeof b!="string"||!b.trim()){console.warn("TTS: Empty or invalid text provided"),E();return}C.post("/tts",{text:b},{responseType:"arraybuffer"}).then(k=>{const q=k.headers&&k.headers["content-type"]||"",$=q.includes("audio/")||q.includes("mpeg");if(k.status!==200||!$||!k.data){console.warn("TTS: Invalid response, falling back to speechSynthesis"),xe(b,E);return}const K=k.data,G=new Blob([K],{type:"audio/mpeg"}),Z=URL.createObjectURL(G),z=new Audio(Z);z.volume=1;const oe=()=>{z.src="",z.removeEventListener("ended",x),z.removeEventListener("error",v),setTimeout(()=>URL.revokeObjectURL(Z),100)},x=()=>{oe(),E()},v=L=>{console.error("TTS audio playback error:",L),oe(),xe(b,E)};z.addEventListener("ended",x),z.addEventListener("error",v);const D=z.play();D!==void 0&&D.catch(L=>{console.error("TTS audio play() failed:",L),oe(),xe(b,E)})}).catch(k=>{console.error("TTS API call failed:",k),xe(b,E)})}),we=()=>new Promise(b=>M(b)),le=async()=>{if(N.current){console.log("Already processing announcement, skipping");return}if(T.current.length===0){console.log("No announcements in queue");return}console.log(`Processing announcement, queue length: ${T.current.length}`),N.current=!0;const b=T.current.shift();if(!b){console.log("No item to process"),N.current=!1,T.current.length>0&&le();return}const{text:E}=b;console.log("Starting announcement:",E);try{ne(.05),console.log("Playing ding..."),await we(),console.log("Ding finished, playing TTS..."),await ge(E),console.log("TTS finished"),Te(b.key)}catch(k){console.error("Announcement playback error:",k)}finally{ne(re),N.current=!1,T.current.length>0&&le()}},Se=(b,E)=>{if(typeof window>"u")return;if(!W.current){W.current=!0;return}const k=new Map;(b||[]).forEach(G=>{G&&G.id&&G.currentServing&&k.set(G.id,G.currentServing.queueNumber)});const q=Date.now(),$=new Set(T.current.map(G=>G.key).filter(Boolean)),K=[];(E||[]).forEach(G=>{if(!G||!G.id||!G.currentServing)return;const Z=G.currentServing.queueNumber,z=G.currentServing.clientName,oe=k.get(G.id);if(!Z||Z===oe)return;const x=`${G.id}:${Z}`;if($.has(x)||Y.current===x&&q-J.current<te)return;$.add(x);const v=qe?qe(Z):Z;let D=v;const L=parseInt(v,10);Number.isNaN(L)||(D=String(L));const H=G.label||"Window",pe=z?`, ${z}`:"",fe="Ang atong {{window}},... mu assist na sa kyu number, {{queueNumber}}. {{clientNamePart}}, please proceed to {{window}}.".replace(/{{\s*window\s*}}/gi,H).replace(/{{\s*queueNumber\s*}}/gi,D).replace(/{{\s*clientNamePart\s*}}/gi,pe);console.log("Announcement queued:",{windowLabel:H,spokenCounter:D,text:fe}),K.push({text:fe,key:x})}),K.length>0&&(console.log(`Adding ${K.length} announcement(s) to queue`),K.forEach(G=>T.current.push(G)),le())},Te=b=>{b&&(Y.current=b,J.current=Date.now())},Ce=[".mp4",".webm",".ogg",".mov",".avi"];function Ye(b){if(!b||typeof b!="string")return null;const E=b.trim(),k=E.match(/[?&]v=([^&]+)/);if(k)return k[1];const q=E.match(/youtu\.be\/([^?&]+)/);if(q)return q[1];const $=E.match(/youtube\.com\/embed\/([^?&]+)/);return $?$[1]:null}const _e=async()=>{var b;try{const[E,k]=await Promise.all([C.get("/admin/settings/video-source"),C.get("/admin/settings/video-volume").catch(()=>null)]),q=E.data.videoSource||"youtube";if(r(q),k&&typeof((b=k.data)==null?void 0:b.videoVolumePercent)=="number"){const $=k.data.videoVolumePercent;U(Math.max(0,Math.min(100,Math.round($))))}if(q==="youtube"){const G=((await C.get("/admin/settings/youtube-playlist")).data.urls||[]).map(Z=>{const z=Ye(Z);return z?{id:z,url:Z,name:z}:null}).filter(Boolean);n(G),u(!1),S(null)}else n([]),S(null)}catch(E){console.error("Failed to load videos:",E),u(!0),n([])}},Ge=async()=>{if(!("showDirectoryPicker"in window)){S("Not supported in this browser. Use Chrome or Edge.");return}try{S(null);const b=await window.showDirectoryPicker(),E=[];for await(const k of b.values())if(k.kind==="file"){const q="."+(k.name.split(".").pop()||"").toLowerCase();if(Ce.includes(q)){const $=await k.getFile(),K=URL.createObjectURL($);E.push({filename:k.name,name:k.name.replace(/\.[^/.]+$/,""),url:K,_blobUrl:!0})}}E.length>0?(n(E),u(!1)):S("No video files found in that folder.")}catch(b){b.name!=="AbortError"&&(console.error("Failed to pick folder:",b),S(b.message||"Failed to access folder."))}},ke=()=>{if(!y.current){y.current=!0,F(!1);try{const b=Math.max(0,Math.min(100,P))/100,E=window.AudioContext||window.webkitAudioContext;if(E&&!I.current){const $=new E;I.current=$,$.resume&&$.resume()}const k=f.current;k&&typeof k.unMute=="function"&&(k.unMute(),k.setVolume(Math.round(b*100)));const q=R.current;q&&(q.muted=!1,q.volume=b)}catch{}}};return Q.current=ke,e.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",background:"#0f172a",overflow:"hidden"},onClick:ke,onTouchStart:ke,role:"presentation",children:[_&&i.length>0&&e.jsxs("div",{role:"button",tabIndex:0,onClick:ke,onKeyDown:b=>{b.key!=="Tab"&&ke()},style:{position:"fixed",inset:0,zIndex:9999,background:"rgba(0,0,0,0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",cursor:"pointer"},children:[e.jsx("div",{style:{color:"#e5e7eb",fontSize:"24px",fontWeight:600,textAlign:"center",padding:"0 24px"},children:"Press any key or tap to start"}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"16px",textAlign:"center",padding:"0 24px"},children:"Use your remote's OK/Enter button, or tap the screen"})]}),e.jsxs("div",{style:{flex:1,display:"flex",minHeight:0},children:[e.jsxs("div",{style:{flex:3,minWidth:0,background:"#000",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsxs("div",{style:{position:"absolute",top:16,left:16,zIndex:10,display:"flex",alignItems:"center",gap:0,pointerEvents:"none"},children:[e.jsx("div",{children:e.jsx(ve,{size:"monitor",showText:!1,gap:"0px"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",lineHeight:1.1,marginLeft:0},children:[e.jsx("span",{style:{fontSize:"18px",fontWeight:700,color:"#e5e7eb",textShadow:"0 2px 4px rgba(0,0,0,0.6)",whiteSpace:"nowrap"},children:"Hilongos Treasury Office"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#e5e7eb",textShadow:"0 2px 4px rgba(0,0,0,0.6)",textTransform:"uppercase",letterSpacing:"0.12em",whiteSpace:"nowrap"},children:"Queue Monitoring"})]})]}),i.length>0&&!p?g==="youtube"?e.jsx("div",{ref:B,style:{position:"relative",width:"100%",height:"100%"}}):e.jsx("video",{ref:R,src:a==null?void 0:a.url,controls:!0,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsxs("div",{style:{textAlign:"center",padding:"40px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{color:"#9ca3af",fontSize:"22px",fontWeight:600,marginBottom:"8px"},children:g==="local"?"Select a video folder":"No YouTube playlist configured"}),e.jsx("div",{style:{color:"#6b7280",fontSize:"16px"},children:g==="local"?"Choose a folder on this computer containing video files (mp4, webm, ogg, mov, avi).":"Add YouTube URLs in Admin â†’ Settings â†’ Videos."}),g==="local"&&w&&e.jsx("div",{style:{color:"#ef4444",fontSize:"14px"},children:w}),g==="local"&&e.jsx("button",{type:"button",onClick:Ge,style:{padding:"12px 24px",fontSize:"16px",fontWeight:600,color:"white",background:"#6366f1",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Select folder"})]})]}),e.jsx("div",{style:{flex:1,minWidth:0,borderLeft:"1px solid #1f2937",background:"#020617",padding:"12px",display:"flex",flexDirection:"column",gap:"12px",overflowY:"auto"},children:j?e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})}):(()=>{const b=t.filter(q=>q.staff);if(b.length===0)return e.jsx("div",{style:{textAlign:"center",padding:"24px 16px",background:"#0b1120",borderRadius:"12px",color:"#64748b",border:"1px solid #1f2937"},children:"No active windows at the moment"});const E=b.length,k=E<=3?"0 0 20vh":"1 1 0";return b.map(q=>e.jsx("div",{style:{flex:k,minHeight:E>3?0:void 0,display:"flex"},children:e.jsx(bt,{window:q,compact:E>3})},q.id))})()})]})]})}function en(){const t=ye(),[s,i]=o.useState({username:"",password:""}),[n,a]=o.useState(""),[c,j]=o.useState(!1);o.useEffect(()=>{const p=localStorage.getItem("token"),u=Ie();p&&(u==null?void 0:u.role)==="STAFF"&&t("/staff/dashboard")},[t]);const m=async p=>{var u,g;p.preventDefault(),a(""),j(!0);try{const r=await C.post("/auth/staff/login",s);localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user)),t("/staff/dashboard")}catch(r){a(((g=(u=r.response)==null?void 0:u.data)==null?void 0:g.error)||"Login failed")}finally{j(!1)}};return e.jsxs("div",{className:"staff-login-root",style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",paddingLeft:"max(20px, env(safe-area-inset-left))",paddingRight:"max(20px, env(safe-area-inset-right))"},children:[e.jsx("style",{children:`
        @media (max-width: 480px) {
          .staff-login-root { padding: 16px !important; }
          .staff-login-card { padding: 24px !important; }
          .staff-login-title { font-size: 22px !important; }
        }
      `}),e.jsxs("div",{className:"staff-login-card",style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(ve,{size:"medium"})}),e.jsx("h1",{className:"staff-login-title",style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Staff Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage your queue"}),e.jsxs("form",{onSubmit:m,children:[e.jsx(ie,{label:"Username",value:s.username,onChange:p=>i({...s,username:p.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(ie,{label:"Password",type:"password",value:s.password,onChange:p=>i({...s,password:p.target.value}),placeholder:"Enter your password",required:!0}),n&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:n}),e.jsx(O,{type:"submit",fullWidth:!0,disabled:c,children:c?"Logging in...":"Login"})]})]})]})}function $e({label:t,error:s,children:i,...n}){return e.jsxs("div",{style:{marginBottom:"16px"},children:[t&&e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:t}),e.jsx("select",{style:{width:"100%",padding:"12px",borderRadius:"8px",border:s?"2px solid #ef4444":"2px solid #e2e8f0",fontSize:"16px",backgroundColor:"white",cursor:"pointer"},...n,children:i}),s&&e.jsx("div",{style:{marginTop:"4px",fontSize:"12px",color:"#ef4444"},children:s})]})}function tn({onProfileClick:t,onLogout:s}){const[i,n]=o.useState(!1),[a,c]=o.useState(null),[j,m]=o.useState(!0),p=o.useRef(null);o.useEffect(()=>{u()},[]),o.useEffect(()=>{const r=w=>{p.current&&!p.current.contains(w.target)&&n(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const u=async()=>{try{const r=await C.get("/staff/profile");c(r.data.staff)}catch(r){console.error("Failed to load profile:",r)}finally{m(!1)}},g=r=>{if(!r)return"?";const w=r.trim().split(" ");return w.length>=2?(w[0][0]+w[w.length-1][0]).toUpperCase():r.substring(0,2).toUpperCase()};return j?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:p,children:[e.jsx("button",{onClick:()=>n(!i),style:{width:"44px",height:"44px",minWidth:"44px",minHeight:"44px",borderRadius:"50%",border:"2px solid #e2e8f0",background:a!=null&&a.profilePicture?`url(${a.profilePicture}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:r=>{r.target.style.borderColor="#2563eb",r.target.style.transform="scale(1.05)"},onMouseOut:r=>{r.target.style.borderColor="#e2e8f0",r.target.style.transform="scale(1)"},children:!(a!=null&&a.profilePicture)&&g(a==null?void 0:a.name)}),i&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(a==null?void 0:a.name)||"Staff"}),e.jsxs("button",{onClick:()=>{n(!1),t()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#1e293b",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:r=>{r.currentTarget.style.background="#f1f5f9"},onMouseOut:r=>{r.currentTarget.style.background="transparent"},children:[e.jsx(lt,{size:18}),"Profile"]}),e.jsxs("button",{onClick:()=>{n(!1),s()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:r=>{r.currentTarget.style.background="#fee2e2"},onMouseOut:r=>{r.currentTarget.style.background="transparent"},children:[e.jsx(dt,{size:18}),"Logout"]})]})]})}const at={success:{icon:Ze,color:"#10b981",bg:"#d1fae5"},error:{icon:It,color:"#ef4444",bg:"#fee2e2"},warning:{icon:kt,color:"#f59e0b",bg:"#fef3c7"},info:{icon:Ct,color:"#2563eb",bg:"#dbeafe"}};let nn=0;const Ae=[],Be=[];function wt(t,s="info",i=3e3){const n=nn++,a={id:n,message:t,type:s,duration:i};return Ae.push(a),Be.forEach(c=>c([...Ae])),i>0&&setTimeout(()=>{jt(n)},i),n}function jt(t){const s=Ae.findIndex(i=>i.id===t);s>-1&&(Ae.splice(s,1),Be.forEach(i=>i([...Ae])))}function ee(t,s){return wt(t,"success",s)}function V(t,s){return wt(t,"error",s)}function on(){const[t,s]=o.useState([]);return o.useEffect(()=>{const i=n=>{s(n)};return Be.push(i),s([...Ae]),()=>{const n=Be.indexOf(i);n>-1&&Be.splice(n,1)}},[]),e.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",gap:"12px",pointerEvents:"none"},children:[(t||[]).map(i=>{const n=at[i.type]||at.info,a=n.icon;return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px 20px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"12px",minWidth:"300px",maxWidth:"400px",pointerEvents:"auto",animation:"slideIn 0.3s ease-out",borderLeft:`4px solid ${n.color}`},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:n.bg,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(a,{size:16,color:n.color})}),e.jsx("div",{style:{flex:1,fontSize:"14px",color:"#1e293b",lineHeight:"1.5"},children:i.message}),e.jsx("button",{onClick:()=>jt(i.id),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b",transition:"color 0.2s"},onMouseOver:c=>{c.target.style.color="#1e293b"},onMouseOut:c=>{c.target.style.color="#64748b"},children:e.jsx(ce,{size:18})})]},i.id)}),e.jsx("style",{children:`
        @keyframes slideIn {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `})]})}function ze({open:t,title:s,message:i,onConfirm:n,onCancel:a,confirmText:c="Confirm",cancelText:j="Cancel",variant:m="danger"}){if(!t)return null;const p={danger:{confirmBg:"#ef4444",confirmHover:"#dc2626"},warning:{confirmBg:"#f59e0b",confirmHover:"#d97706"},info:{confirmBg:"#2563eb",confirmHover:"#1e40af"}},u=p[m]||p.danger;return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:s}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px",lineHeight:"1.6"},children:i}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:a,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:g=>{g.target.style.background="#f1f5f9",g.target.style.borderColor="#cbd5e1"},onMouseOut:g=>{g.target.style.background="transparent",g.target.style.borderColor="#e2e8f0"},children:j}),e.jsx("button",{onClick:n,style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:u.confirmBg,color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:g=>{g.target.style.background=u.confirmHover,g.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)"},onMouseOut:g=>{g.target.style.background=u.confirmBg,g.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)"},children:c})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const it=["#2563eb","#10b981","#f59e0b","#ef4444"];function an(){const t=ye(),[s,i]=o.useState(!0),[n,a]=o.useState(null),[c,j]=o.useState([]),[m,p]=o.useState({}),[u,g]=o.useState([]),[r,w]=o.useState(null),[S,R]=o.useState("today"),[f,B]=o.useState(new Date),[l,h]=o.useState({open:!1,queueEntryId:null}),[W,T]=o.useState(null);o.useEffect(()=>{const d=localStorage.getItem("token"),A=Ie();if(!d||(A==null?void 0:A.role)!=="STAFF"){t("/staff/login");return}N(),Y();const M=setInterval(N,3e3);return()=>clearInterval(M)},[t]),o.useEffect(()=>{S&&J()},[S]),o.useEffect(()=>{const d=setInterval(()=>B(new Date),1e3);return()=>clearInterval(d)},[]);const N=async()=>{var d;try{const A=await C.get("/staff/dashboard");a(A.data.window),j(A.data.queue||[]),p(A.data.stats||{})}catch(A){console.error("Failed to load dashboard:",A),((d=A.response)==null?void 0:d.status)===401&&t("/staff/login")}finally{i(!1)}},Y=async()=>{try{const d=await C.get("/windows/active");g(d.data.windows||[])}catch(d){console.error("Failed to load windows:",d)}},J=async()=>{try{let d,A;const M=new Date;if(S==="today")d=M.toISOString().split("T")[0],A=d;else if(S==="yesterday"){const xe=new Date(M);xe.setDate(xe.getDate()-1),d=xe.toISOString().split("T")[0],A=d}else d=M.toISOString().split("T")[0],A=d;const ne=await C.get(`/staff/analytics?startDate=${d}&endDate=${A}`);w(ne.data)}catch(d){console.error("Failed to load analytics:",d)}},te=async d=>{var A,M;try{await C.post("/staff/assign-window",{windowId:d}),N(),Y()}catch(ne){console.error("Failed to assign window:",ne),alert(((M=(A=ne.response)==null?void 0:A.data)==null?void 0:M.error)||"Failed to assign window")}},re=async d=>{var A,M,ne,xe,ge,we;if(!W){T(d);try{const Se=(A=(await C.post(`/staff/serve/${d}`)).data)==null?void 0:A.queueEntry;Se?j(Te=>Te.map(Ce=>Ce.id===d?Se:Ce)):N()}catch(le){console.error("Failed to start serving:",le),((M=le.response)==null?void 0:M.status)===409?(V(((xe=(ne=le.response)==null?void 0:ne.data)==null?void 0:xe.error)||"Client was already claimed. Refreshing..."),N()):V(((we=(ge=le.response)==null?void 0:ge.data)==null?void 0:we.error)||"Failed to start serving")}finally{T(null)}}},X=async d=>{var A,M;try{await C.post(`/staff/complete/${d}`),N(),J()}catch(ne){console.error("Failed to complete:",ne),alert(((M=(A=ne.response)==null?void 0:A.data)==null?void 0:M.error)||"Failed to complete")}},ae=d=>{h({open:!0,queueEntryId:d})},ue=async()=>{var A,M;const{queueEntryId:d}=l;if(h({open:!1,queueEntryId:null}),!!d)try{await C.post(`/staff/skip/${d}`),N(),J(),ee("Client marked as skipped")}catch(ne){console.error("Failed to skip:",ne),V(((M=(A=ne.response)==null?void 0:A.data)==null?void 0:M.error)||"Failed to skip")}},y=async()=>{try{await C.get("/staff/dashboard").then(A=>A.data.window)&&await C.post("/staff/assign-window",{windowId:null})}catch(d){console.error("Error deactivating window on logout:",d)}localStorage.removeItem("token"),localStorage.removeItem("user"),t("/staff/login")},I=()=>{t("/staff/profile")};if(s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})});const _=c.filter(d=>["SENIOR_CITIZEN","PWD","PREGNANT"].includes(d.clientType)),F=c.filter(d=>d.clientType==="REGULAR"),P=r!=null&&r.byCategory?Object.entries(r.byCategory).map(([d,A])=>({name:d,value:A})):[],U=r!=null&&r.byClientType?Object.entries(r.byClientType).map(([d,A])=>({name:d,value:A})):[],Q=d=>{const A=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],M=["January","February","March","April","May","June","July","August","September","October","November","December"],ne=A[d.getDay()],xe=M[d.getMonth()],ge=d.getDate(),we=d.getFullYear();let le=d.getHours();const Se=String(d.getMinutes()).padStart(2,"0"),Te=String(d.getSeconds()).padStart(2,"0"),Ce=le>=12?"PM":"AM";return le=le%12,le=le||12,`${ne}, ${xe} ${ge}, ${we} at ${le}:${Se}:${Te} ${Ce}`};return e.jsxs(e.Fragment,{children:[e.jsx(ze,{open:l.open,title:"Skip Client",message:"Mark this client as skipped? They will be removed from the queue and not counted as served.",confirmText:"Skip",cancelText:"Cancel",variant:"warning",onConfirm:ue,onCancel:()=>h({open:!1,queueEntryId:null})}),e.jsx("style",{children:`
        .staff-dashboard-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        .staff-dashboard-content {
          padding-left: max(24px, env(safe-area-inset-left));
          padding-right: max(24px, env(safe-area-inset-right));
        }
        .queue-item-buttons button {
          min-height: 44px;
        }
        @media (max-width: 768px) {
          .staff-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-dashboard-header > div:first-child {
            width: 100%;
            flex-direction: column;
            align-items: flex-start !important;
            gap: 8px !important;
          }
          .staff-dashboard-header-center {
            width: 100%;
            text-align: left;
          }
          .staff-dashboard-main-grid {
            grid-template-columns: 1fr !important;
          }
          .staff-dashboard-content {
            padding: 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .queue-item-grid {
            grid-template-columns: 1fr !important;
            gap: 12px !important;
          }
          .queue-item-buttons {
            flex-direction: row !important;
            width: 100% !important;
            flex-wrap: wrap;
          }
          .queue-item-buttons button {
            flex: 1;
            min-width: 120px;
          }
          .staff-window-assign-grid {
            grid-template-columns: 1fr !important;
          }
        }
        @media (max-width: 480px) {
          .queue-item-buttons {
            flex-direction: column !important;
          }
          .queue-item-buttons button {
            min-width: 100%;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .staff-dashboard-main-grid {
            grid-template-columns: 60% 40% !important;
          }
        }
      `}),e.jsxs("div",{className:"staff-dashboard-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsxs("div",{className:"staff-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(ve,{size:"small"}),n&&e.jsxs("div",{className:"staff-dashboard-header-center",style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:["Operating: ",n.label]})]}),e.jsx(tn,{onProfileClick:I,onLogout:y})]}),e.jsxs("div",{className:"staff-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:Q(f)})}),!n&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Assign Window"}),e.jsx("div",{className:"staff-window-assign-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"12px"},children:u.map(d=>e.jsx(O,{onClick:()=>te(d.id),variant:"outline",children:d.label},d.id))})]}),e.jsxs("div",{className:"staff-dashboard-main-grid",style:{display:"grid",gridTemplateColumns:"75% 25%",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px"},children:["Queue (",c.length,")"]}),_.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#f59e0b",marginBottom:"12px"},children:"Priority Clients"}),_.map(d=>e.jsx(st,{entry:d,onServe:re,onComplete:X,onSkip:ae,servingId:W},d.id))]}),F.length>0&&e.jsxs("div",{children:[_.length>0&&e.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",marginBottom:"12px"},children:"Regular Clients"}),F.map(d=>e.jsx(st,{entry:d,onServe:re,onComplete:X,onSkip:ae,servingId:W},d.id))]}),c.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#94a3b8"},children:"No clients in queue"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"In Queue"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#f59e0b"},children:c.length})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"Total Served Today"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#2563eb"},children:m.totalServed||0})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#64748b",marginBottom:"8px"},children:"Skipped Today"}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#ef4444"},children:m.totalSkipped||0})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Analytics"}),e.jsxs($e,{value:S,onChange:d=>R(d.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"})]})]}),r&&e.jsxs(e.Fragment,{children:[P.length>0&&e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Category"}),e.jsx(We,{width:"100%",height:200,children:e.jsxs(Je,{data:P,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Fe,{dataKey:"name"}),e.jsx(Ue,{}),e.jsx(Pe,{}),e.jsx(Xe,{dataKey:"value",fill:"#2563eb"})]})})]}),U.length>0&&e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"By Client Type"}),e.jsx(We,{width:"100%",height:200,children:e.jsxs(ft,{children:[e.jsx(ht,{data:U,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:A})=>`${d}: ${(A*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:U.map((d,A)=>e.jsx(mt,{fill:it[A%it.length]},`cell-${A}`))}),e.jsx(Pe,{})]})})]})]})]})]})]})]})]})]})}function st({entry:t,onServe:s,onComplete:i,onSkip:n,servingId:a}){var m,p,u;const c=t.status==="NOW_SERVING",j=a===t.id;return e.jsxs("div",{className:"queue-item-grid",style:{padding:"16px",border:c?"2px solid #2563eb":"1px solid #e2e8f0",borderRadius:"8px",marginBottom:"12px",background:c?"#eff6ff":"white",display:"grid",gridTemplateColumns:"1fr auto",gap:"20px",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#2563eb",marginBottom:"4px"},children:t.queueNumber}),e.jsx("div",{style:{fontSize:"14px",color:"#1e293b",marginBottom:"4px"},children:t.clientName}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",marginBottom:"8px",flexWrap:"wrap"},children:[e.jsx(vt,{clientType:t.clientType}),e.jsxs("span",{style:{fontSize:"12px",color:"#64748b"},children:[((m=t.concernCategories)!=null&&m.length?t.concernCategories:t.category?[t.category]:[]).map(g=>g==null?void 0:g.name).filter(Boolean).join(", "),((p=t.concernSubCategories)!=null&&p.length?t.concernSubCategories:t.subCategory?[t.subCategory]:[]).map(g=>g==null?void 0:g.name).filter(Boolean).length>0&&` - ${((u=t.concernSubCategories)!=null&&u.length?t.concernSubCategories:[t.subCategory]).map(g=>g==null?void 0:g.name).filter(Boolean).join(", ")}`]})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#94a3b8"},children:["Joined: ",new Date(t.joinedAt).toLocaleTimeString()]})]}),e.jsxs("div",{className:"queue-item-buttons",style:{display:"flex",gap:"8px",flexDirection:"column"},children:[c?e.jsx(O,{variant:"success",icon:Ze,onClick:()=>i(t.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Mark as Served"}):e.jsx(O,{variant:"primary",icon:Tt,onClick:()=>s(t.id),disabled:j,style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:j?"Serving...":"Start Serving"}),e.jsx(O,{variant:"danger",icon:Dt,onClick:()=>n(t.id),style:{fontSize:"12px",padding:"8px 16px",whiteSpace:"nowrap"},children:"Skip"})]})]})}function sn(){const t=ye(),[s,i]=o.useState(!0),[n,a]=o.useState(!1),[c,j]=o.useState(null),[m,p]=o.useState(null),[u,g]=o.useState(null),[r,w]=o.useState(!1),[S,R]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[f,B]=o.useState(!1),[l,h]=o.useState(null),[W,T]=o.useState([]),[N,Y]=o.useState(""),[J,te]=o.useState(!1);o.useEffect(()=>{const P=localStorage.getItem("token"),U=Ie();if(!P||(U==null?void 0:U.role)!=="STAFF"){t("/staff/login");return}re()},[t]);const re=async()=>{var P;try{const U=await C.get("/staff/profile");j(U.data.staff),p(U.data.staff.profilePicture);const Q=U.data.currentWindow||null;h(Q),Y((Q==null?void 0:Q.id)||"")}catch(U){console.error("Failed to load profile:",U),((P=U.response)==null?void 0:P.status)===401&&t("/staff/login")}finally{i(!1)}},X=async()=>{try{const P=await C.get("/windows/active");T(P.data.windows||[])}catch(P){console.error("Failed to load windows:",P)}};o.useEffect(()=>{X()},[]);const ae=async P=>{var U,Q;if(P.preventDefault(),!N||N===(l==null?void 0:l.id)){N===(l==null?void 0:l.id)&&V("You are already assigned to this window");return}te(!0);try{await C.post("/staff/assign-window",{windowId:N});const d=W.find(A=>A.id===N);h(d?{id:d.id,label:d.label}:null),ee("Window changed successfully. You are now operating at "+((d==null?void 0:d.label)||"the selected window")+".")}catch(d){console.error("Failed to switch window:",d),V(((Q=(U=d.response)==null?void 0:U.data)==null?void 0:Q.error)||"Failed to switch window")}finally{te(!1)}},ue=P=>{const U=P.target.files[0];if(U){const Q=new FileReader;Q.onloadend=()=>{g(Q.result)},Q.readAsDataURL(U),p(U)}},y=async P=>{var U,Q;P.preventDefault(),a(!0);try{if(await C.put("/staff/profile",{name:c.name}),m instanceof File){const d=new FormData;d.append("picture",m);const A=await C.post("/staff/profile/picture",d,{headers:{"Content-Type":"multipart/form-data"}});p(A.data.profilePicture),g(null)}ee("Profile updated successfully!"),t("/staff/dashboard")}catch(d){console.error("Failed to update profile:",d),V(((Q=(U=d.response)==null?void 0:U.data)==null?void 0:Q.error)||"Failed to update profile")}finally{a(!1)}},I=async P=>{var U,Q;if(P.preventDefault(),S.newPassword!==S.confirmPassword){V("New passwords do not match");return}if(S.newPassword.length<6){V("Password must be at least 6 characters");return}B(!0);try{await C.post("/staff/profile/change-password",{currentPassword:S.currentPassword,newPassword:S.newPassword}),ee("Password changed successfully!"),w(!1),R({currentPassword:"",newPassword:"",confirmPassword:""})}catch(d){console.error("Failed to change password:",d),V(((Q=(U=d.response)==null?void 0:U.data)==null?void 0:Q.error)||"Failed to change password")}finally{B(!1)}};if(s)return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})});const _=P=>{if(!P)return"?";const U=P.trim().split(" ");return U.length>=2?(U[0][0]+U[U.length-1][0]).toUpperCase():P.substring(0,2).toUpperCase()},F=u||(c!=null&&c.profilePicture?c.profilePicture:null);return e.jsxs("div",{className:"staff-profile-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx("style",{children:`
        .staff-profile-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        @media (max-width: 768px) {
          .staff-profile-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-profile-content {
            margin: 24px auto !important;
            padding: 0 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .staff-profile-card {
            padding: 24px !important;
          }
          .staff-profile-buttons {
            flex-direction: column !important;
          }
          .staff-profile-buttons button {
            width: 100%;
          }
        }
      `}),e.jsxs("div",{className:"staff-profile-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ve,{size:"small"}),e.jsx(O,{variant:"outline",icon:ct,onClick:()=>t("/staff/dashboard"),children:"Back to Dashboard"})]}),e.jsx("div",{className:"staff-profile-content",style:{maxWidth:"600px",margin:"40px auto",padding:"0 24px"},children:e.jsxs("div",{className:"staff-profile-card",style:{background:"white",borderRadius:"12px",padding:"32px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"32px",color:"#1e293b"},children:"My Profile"}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[e.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",margin:"0 auto 16px",border:"3px solid #e2e8f0",background:F?`url(${F}) center/cover`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"36px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:!F&&_(c==null?void 0:c.name)}),e.jsxs("label",{style:{display:"inline-block",padding:"8px 16px",background:"#2563eb",color:"white",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s"},onMouseOver:P=>{P.target.style.background="#1e40af"},onMouseOut:P=>{P.target.style.background="#2563eb"},children:["Change Picture",e.jsx("input",{type:"file",accept:"image/*",onChange:ue,style:{display:"none"}})]}),e.jsx("p",{style:{fontSize:"12px",color:"#64748b",marginTop:"8px"},children:"JPG, PNG, GIF, WebP (max 2MB)"})]}),e.jsx(ie,{label:"Name",value:(c==null?void 0:c.name)||"",onChange:P=>j({...c,name:P.target.value}),required:!0}),e.jsx(ie,{label:"Username",value:(c==null?void 0:c.username)||"",disabled:!0,readOnly:!0}),e.jsxs("div",{className:"staff-profile-buttons",style:{display:"flex",gap:"12px",marginTop:"24px"},children:[e.jsx(O,{type:"submit",icon:pt,disabled:n,fullWidth:!0,children:n?"Saving...":"Save Changes"}),e.jsx(O,{variant:"outline",icon:ce,onClick:()=>t("/staff/dashboard"),fullWidth:!0,children:"Cancel"})]})]}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Qe,{size:20}),"Operating window"]}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"12px"},children:l?`You are currently at ${l.label}.`:"You are not assigned to a window yet."}),e.jsxs("form",{onSubmit:ae,style:{display:"flex",flexDirection:"row",gap:"12px",alignItems:"center",flexWrap:"wrap",maxWidth:"420px"},children:[e.jsx("div",{style:{flex:"1 1 200px"},children:e.jsxs($e,{label:"Switch to window",value:N,onChange:P=>Y(P.target.value),children:[e.jsx("option",{value:"",children:"â€” Select window â€”"}),W.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})}),e.jsx(O,{type:"submit",icon:Qe,disabled:J||!N||N===(l==null?void 0:l.id),fullWidth:!0,style:{flex:"1 1 200px",padding:"12px 20px"},children:J?"Switching...":"Switch window"})]})]}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Change Password"}),e.jsx(O,{variant:"outline",icon:et,onClick:()=>{w(!r),r&&R({currentPassword:"",newPassword:"",confirmPassword:""})},children:r?"Cancel":"Change Password"})]}),r&&e.jsxs("form",{onSubmit:I,children:[e.jsx(ie,{label:"Current Password",type:"password",value:S.currentPassword,onChange:P=>R({...S,currentPassword:P.target.value}),required:!0}),e.jsx(ie,{label:"New Password",type:"password",value:S.newPassword,onChange:P=>R({...S,newPassword:P.target.value}),required:!0}),e.jsx(ie,{label:"Confirm New Password",type:"password",value:S.confirmPassword,onChange:P=>R({...S,confirmPassword:P.target.value}),required:!0}),e.jsx(O,{type:"submit",icon:ut,disabled:f,fullWidth:!0,style:{marginTop:"16px"},children:f?"Changing...":"Change Password"})]})]})]})})]})}function rn(){const t=ye(),[s,i]=o.useState({username:"",password:""}),[n,a]=o.useState(""),[c,j]=o.useState(!1);o.useEffect(()=>{const p=localStorage.getItem("token"),u=Ie();p&&(u==null?void 0:u.role)==="ADMIN"&&t("/admin/dashboard")},[t]);const m=async p=>{var u,g;p.preventDefault(),a(""),j(!0);try{const r=await C.post("/auth/admin/login",s);localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user)),t("/admin/dashboard")}catch(r){a(((g=(u=r.response)==null?void 0:u.data)==null?void 0:g.error)||"Login failed")}finally{j(!1)}};return e.jsxs("div",{className:"admin-login-root",style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",paddingLeft:"max(20px, env(safe-area-inset-left))",paddingRight:"max(20px, env(safe-area-inset-right))"},children:[e.jsx("style",{children:`
        @media (max-width: 480px) {
          .admin-login-root { padding: 16px !important; }
          .admin-login-card { padding: 24px !important; }
          .admin-login-title { font-size: 22px !important; }
        }
      `}),e.jsxs("div",{className:"admin-login-card",style:{background:"white",borderRadius:"16px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"center"},children:e.jsx(ve,{size:"medium"})}),e.jsx("h1",{className:"admin-login-title",style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1e293b",textAlign:"center"},children:"Admin Login"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",textAlign:"center",marginBottom:"32px"},children:"Sign in to manage the system"}),e.jsxs("form",{onSubmit:m,children:[e.jsx(ie,{label:"Username",value:s.username,onChange:p=>i({...s,username:p.target.value}),placeholder:"Enter your username",required:!0,autoFocus:!0}),e.jsx(ie,{label:"Password",type:"password",value:s.password,onChange:p=>i({...s,password:p.target.value}),placeholder:"Enter your password",required:!0}),n&&e.jsx("div",{style:{padding:"12px",background:"#fee2e2",color:"#991b1b",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:n}),e.jsx(O,{type:"submit",fullWidth:!0,disabled:c,children:c?"Logging in...":"Login"})]})]})]})}function ln({onProfileClick:t,onLogout:s}){const[i,n]=o.useState(!1),[a,c]=o.useState(null),[j,m]=o.useState(!0),p=o.useRef(null);ye(),o.useEffect(()=>{u()},[]),o.useEffect(()=>{const r=w=>{p.current&&!p.current.contains(w.target)&&n(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const u=async()=>{try{const r=Ie();r&&c({name:r.name||"Admin",username:r.username})}catch(r){console.error("Failed to load profile:",r)}finally{m(!1)}},g=r=>{if(!r)return"A";const w=r.trim().split(" ");return w.length>=2?(w[0][0]+w[w.length-1][0]).toUpperCase():r.substring(0,2).toUpperCase()};return j?e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#e2e8f0"}}):e.jsxs("div",{style:{position:"relative"},ref:p,children:[e.jsx("button",{onClick:()=>n(!i),style:{width:"44px",height:"44px",minWidth:"44px",minHeight:"44px",borderRadius:"50%",border:"2px solid #e2e8f0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:"700",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:0,transition:"all 0.2s"},onMouseOver:r=>{r.target.style.borderColor="#2563eb",r.target.style.transform="scale(1.05)"},onMouseOut:r=>{r.target.style.borderColor="#e2e8f0",r.target.style.transform="scale(1)"},children:g(a==null?void 0:a.name)}),i&&e.jsxs("div",{style:{position:"absolute",top:"48px",right:0,background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"160px",zIndex:1e3,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:(a==null?void 0:a.name)||(a==null?void 0:a.username)||"Admin"}),t&&e.jsxs("button",{onClick:()=>{n(!1),t()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#1e293b",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:r=>{r.currentTarget.style.background="#f1f5f9"},onMouseOut:r=>{r.currentTarget.style.background="transparent"},children:[e.jsx(lt,{size:18}),"Profile"]}),e.jsxs("button",{onClick:()=>{n(!1),s()},style:{width:"100%",padding:"14px 16px",minHeight:"44px",border:"none",background:"transparent",textAlign:"left",fontSize:"14px",color:"#ef4444",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"10px"},onMouseOver:r=>{r.currentTarget.style.background="#fee2e2"},onMouseOut:r=>{r.currentTarget.style.background="transparent"},children:[e.jsx(dt,{size:18}),"Logout"]})]})]})}function dn({open:t,title:s,message:i,placeholder:n="",onConfirm:a,onCancel:c,confirmText:j="Confirm",cancelText:m="Cancel",type:p="text",required:u=!0}){const[g,r]=o.useState("");if(o.useEffect(()=>{t&&r("")},[t]),!t)return null;const w=()=>{u&&!g.trim()||(a(g),r(""))},S=()=>{r(""),c()};return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.2s ease-out"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",margin:0},children:s}),e.jsx("button",{onClick:S,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),i&&e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px",lineHeight:"1.6"},children:i}),e.jsx("input",{type:p,value:g,onChange:R=>r(R.target.value),placeholder:n,required:u,style:{width:"100%",padding:"10px 12px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px",marginBottom:"24px",transition:"border-color 0.2s"},onFocus:R=>{R.target.style.borderColor="#2563eb"},onBlur:R=>{R.target.style.borderColor="#e2e8f0"},onKeyDown:R=>{R.key==="Enter"?w():R.key==="Escape"&&S()},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:S,style:{padding:"10px 20px",border:"2px solid #e2e8f0",borderRadius:"8px",background:"transparent",color:"#64748b",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},onMouseOver:R=>{R.target.style.background="#f1f5f9",R.target.style.borderColor="#cbd5e1"},onMouseOut:R=>{R.target.style.background="transparent",R.target.style.borderColor="#e2e8f0"},children:m}),e.jsx("button",{onClick:w,disabled:u&&!g.trim(),style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:u&&!g.trim()?"#cbd5e1":"#2563eb",color:"white",fontSize:"14px",fontWeight:"600",cursor:u&&!g.trim()?"not-allowed":"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseOver:R=>{u&&!g.trim()||(R.target.style.background="#1e40af",R.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)")},onMouseOut:R=>{u&&!g.trim()||(R.target.style.background="#2563eb",R.target.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)")},children:j})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slideUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
      `})]})}const rt=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6"];function De(t,s){var n;const i=(n=t==null?void 0:t.response)==null?void 0:n.data;if(i!=null&&i.error&&typeof i.error=="string")return i.error;if(Array.isArray(i==null?void 0:i.errors)&&i.errors.length>0){const a=i.errors[0];return(a==null?void 0:a.msg)||(a==null?void 0:a.message)||s}return s}function cn(){const t=ye(),[s,i]=o.useState("dashboard"),[n,a]=o.useState(!0),[c,j]=o.useState(null),[m,p]=o.useState([]),[u,g]=o.useState([]),[r,w]=o.useState([]),[S,R]=o.useState(null),[f,B]=o.useState({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""}),[l,h]=o.useState(!1),[W,T]=o.useState({open:!1,data:{}}),[N,Y]=o.useState({open:!1,data:{}}),[J,te]=o.useState({open:!1,data:{}}),[re,X]=o.useState({open:!1,data:{}}),[ae,ue]=o.useState({open:!1,title:"",message:"",placeholder:"",type:"text",onConfirm:()=>{},onCancel:()=>{}});o.useEffect(()=>{const d=localStorage.getItem("token"),A=Ie();if(!d||(A==null?void 0:A.role)!=="ADMIN"){t("/admin/login");return}y();const M=setInterval(()=>{s==="dashboard"&&I()},3e3);return()=>clearInterval(M)},[t,s]),o.useEffect(()=>{s==="reports"&&U()},[s,f]);const y=async()=>{try{await Promise.all([I(),_(),F(),P()])}catch(d){console.error("Error loading data:",d)}finally{a(!1)}},I=async()=>{try{const d=await C.get("/admin/dashboard");j(d.data.stats)}catch(d){console.error("Failed to load dashboard:",d)}},_=async()=>{try{const d=await C.get("/admin/staff");p(d.data.staff)}catch(d){console.error("Failed to load staff:",d)}},F=async()=>{try{const d=await C.get("/admin/windows");g(d.data.windows)}catch(d){console.error("Failed to load windows:",d)}},P=async()=>{try{const d=await C.get("/categories");w(d.data.categories)}catch(d){console.error("Failed to load categories:",d)}},U=async()=>{try{const d=new URLSearchParams;d.append("startDate",f.startDate),d.append("endDate",f.endDate),f.staffIds&&f.staffIds.length>0&&f.staffIds.forEach(M=>d.append("staffId",M)),f.categoryIds&&f.categoryIds.length>0&&f.categoryIds.forEach(M=>d.append("categoryId",M)),f.clientTypes&&f.clientTypes.length>0&&f.clientTypes.forEach(M=>d.append("clientType",M)),f.startHour&&d.append("startHour",f.startHour),f.endHour&&d.append("endHour",f.endHour);const A=await C.get(`/admin/reports?${d.toString()}`);R(A.data)}catch(d){console.error("Failed to load reports:",d)}},Q=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t("/admin/login")};return n?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})}):e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .admin-dashboard-root {
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }
        .admin-dashboard-content {
          padding-left: max(24px, env(safe-area-inset-left));
          padding-right: max(24px, env(safe-area-inset-right));
        }
        @media (max-width: 768px) {
          .admin-dashboard-header {
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .admin-dashboard-header > div:first-child {
            flex-direction: row;
            align-items: center;
            gap: 12px;
          }
          .admin-dashboard-header h1 {
            font-size: 20px !important;
          }
          .admin-dashboard-tabs {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
          }
          .admin-dashboard-tabs button {
            white-space: nowrap;
            font-size: 13px;
            padding: 10px 16px !important;
            min-height: 44px;
            flex-shrink: 0;
          }
          .admin-dashboard-tabs button span {
            display: none;
          }
          .admin-dashboard-content {
            padding: 16px !important;
            padding-left: max(16px, env(safe-area-inset-left)) !important;
            padding-right: max(16px, env(safe-area-inset-right)) !important;
          }
          .admin-stats-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-reports-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-filter-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-page-header {
            flex-direction: column;
            align-items: flex-start !important;
            gap: 12px;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) !important;
          }
          .admin-modal-overlay {
            padding: 16px;
            align-items: flex-start;
            overflow-y: auto;
          }
          .admin-modal-box {
            max-height: calc(100vh - 32px);
            overflow-y: auto;
            width: 100%;
            margin: auto;
          }
          .admin-settings-buttons {
            flex-wrap: wrap;
          }
          .admin-settings-buttons button {
            min-width: 140px;
          }
          .admin-reports-table-wrap {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 0 -16px;
            padding: 0 16px;
          }
        }
        @media (max-width: 480px) {
          .admin-stats-grid,
          .admin-stats-grid-4,
          .admin-cards-grid {
            grid-template-columns: 1fr !important;
          }
          .admin-dashboard-tabs button {
            padding: 12px 14px !important;
          }
        }
        @media (max-width: 1024px) and (min-width: 769px) {
          .admin-stats-grid-4 {
            grid-template-columns: repeat(2, 1fr) !important;
          }
          .admin-cards-grid {
            grid-template-columns: repeat(3, 1fr) !important;
          }
          .settings-grid {
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
            gap: 16px;
          }
        }
      `}),e.jsxs("div",{className:"admin-dashboard-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx(dn,{...ae}),e.jsxs("div",{className:"admin-dashboard-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",flex:1},children:[e.jsx(ve,{size:"small"}),e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#1e293b",margin:0},children:"Admin Dashboard"})]}),e.jsx(ln,{onProfileClick:()=>t("/admin/profile"),onLogout:Q})]}),e.jsx("div",{className:"admin-dashboard-tabs",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"0 24px",display:"flex",gap:"4px"},children:[{id:"dashboard",label:"Dashboard",icon:zt},{id:"staff",label:"Staff",icon:Rt},{id:"windows",label:"Windows",icon:xt},{id:"categories",label:"Categories",icon:gt},{id:"reports",label:"Reports",icon:Wt},{id:"settings",label:"Settings",icon:Pt}].map(d=>{const A=d.icon,M=s===d.id;return e.jsxs("button",{onClick:()=>i(d.id),style:{padding:"12px 20px",border:"none",background:M?"#eff6ff":"transparent",borderBottom:M?"3px solid #2563eb":"3px solid transparent",color:M?"#2563eb":"#64748b",fontWeight:M?"600":"400",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s",borderRadius:"8px 8px 0 0"},onMouseOver:ne=>{M||(ne.target.style.background="#f1f5f9",ne.target.style.color="#475569")},onMouseOut:ne=>{M||(ne.target.style.background="transparent",ne.target.style.color="#64748b")},children:[e.jsx(A,{size:18}),e.jsx("span",{children:d.label})]},d.id)})}),e.jsxs("div",{className:"admin-dashboard-content",style:{maxWidth:"1400px",margin:"0 auto",padding:"24px"},children:[s==="dashboard"&&e.jsx(pn,{stats:c}),s==="staff"&&e.jsx(un,{staff:m,categories:r,onRefresh:_,form:W,setForm:T,setInputDialog:ue}),s==="windows"&&e.jsx(xn,{windows:u,onRefresh:F,form:N,setForm:Y}),s==="categories"&&e.jsx(gn,{categories:r,onRefresh:P,categoryForm:J,setCategoryForm:te,subCategoryForm:re,setSubCategoryForm:X}),s==="reports"&&e.jsx(fn,{reports:S,filters:f,setFilters:B,staff:m,categories:r,showFilters:l,setShowFilters:h,onRefresh:U}),s==="settings"&&e.jsx(hn,{})]})]})]})}function pn({stats:t}){const[s,i]=o.useState(new Date);if(o.useEffect(()=>{const a=setInterval(()=>{i(new Date)},1e3);return()=>clearInterval(a)},[]),!t)return e.jsx(be,{});const n=a=>{const c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],j=["January","February","March","April","May","June","July","August","September","October","November","December"],m=c[a.getDay()],p=j[a.getMonth()],u=a.getDate(),g=a.getFullYear();let r=a.getHours();const w=String(a.getMinutes()).padStart(2,"0"),S=String(a.getSeconds()).padStart(2,"0"),R=r>=12?"PM":"AM";return r=r%12,r=r||12,`${m}, ${p} ${u}, ${g} at ${r}:${w}:${S} ${R}`};return e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:n(s)})}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"16px"},children:[e.jsx(me,{label:"Queue Entries Today",value:t.todayQueueEntries,icon:At,color:"#2563eb"}),e.jsx(me,{label:"Serving",value:t.servingCount,icon:Et,color:"#2563eb"}),e.jsx(me,{label:"Waiting",value:t.waitingCount,icon:Bt,color:"#f59e0b"}),e.jsx(me,{label:"Served Today",value:t.todayServed,icon:Ze,color:"#10b981"})]}),e.jsxs("div",{className:"admin-stats-grid-4",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px",marginBottom:"24px"},children:[e.jsx(me,{label:"Active Windows",value:t.activeWindows,icon:Qe,color:"#10b981"}),e.jsx(me,{label:"Active Staff",value:t.activeStaff,icon:Nt,color:"#10b981"}),e.jsx(me,{label:"Total Windows",value:t.totalWindows,icon:Lt,color:"#2563eb"}),e.jsx(me,{label:"Total Staff",value:t.totalStaff,icon:Ot,color:"#2563eb"})]})]})}function me({label:t,value:s,color:i="#2563eb",icon:n}){return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[n&&e.jsx(n,{size:20,color:i,style:{flexShrink:0}}),e.jsx("div",{style:{fontSize:"14px",color:"#64748b",fontWeight:"500"},children:t})]}),e.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:i,lineHeight:"1.2"},children:s||0})]})}function un({staff:t,categories:s,onRefresh:i,form:n,setForm:a,setInputDialog:c}){const[j,m]=o.useState(null),[p,u]=o.useState(!1),g=o.useRef(null),[r,w]=o.useState({open:!1});o.useEffect(()=>{const l=h=>{g.current&&!g.current.contains(h.target)&&u(!1)};return p&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[p]);const S=async l=>{l.preventDefault();try{await C.post("/admin/staff",n.data),a({open:!1,data:{}}),ee("Staff created successfully!"),i()}catch(h){V(De(h,"Failed to create staff"))}},R=async l=>{l.preventDefault();try{await C.put(`/admin/staff/${j.id}`,n.data),a({open:!1,data:{}}),m(null),ee("Staff updated successfully!"),i()}catch(h){V(De(h,"Failed to update staff"))}},f=async(l,h)=>{try{await C.put(`/admin/staff/${l}`,{isActive:!h}),ee(`Staff ${h?"deactivated":"activated"} successfully!`),i()}catch(W){V(De(W,"Failed to update staff"))}},B=async(l,h)=>{c({open:!0,title:"Reset Password",message:`Enter new password for ${h}:`,placeholder:"New password (min 6 characters)",type:"password",onConfirm:async W=>{var T,N;if(c({open:!1}),!!W){if(W.length<6){V("Password must be at least 6 characters");return}try{await C.post(`/admin/staff/${l}/reset-password`,{password:W}),ee("Password reset successfully!")}catch(Y){V(((N=(T=Y.response)==null?void 0:T.data)==null?void 0:N.error)||"Failed to reset password")}}},onCancel:()=>c({open:!1})})};return e.jsxs("div",{children:[e.jsx(ze,{...r}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Staff Management"}),e.jsx(O,{onClick:()=>{a({open:!0,data:{}}),m(null)},children:"Add Staff"})]}),n.open&&Ne.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{a({open:!1,data:{}}),m(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:j?"Edit Staff":"Create Staff"}),e.jsx("button",{onClick:()=>{a({open:!1,data:{}}),m(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsxs("form",{onSubmit:j?R:S,children:[e.jsx(ie,{label:"Username",value:n.data.username||"",onChange:l=>a({...n,data:{...n.data,username:l.target.value}}),required:!j,disabled:!!j}),e.jsx(ie,{label:"Name",value:n.data.name||"",onChange:l=>a({...n,data:{...n.data,name:l.target.value}}),required:!0}),(!j||n.data.password)&&e.jsx(ie,{label:"Password",type:"password",value:n.data.password||"",onChange:l=>a({...n,data:{...n.data,password:l.target.value}}),required:!j}),e.jsxs("div",{style:{marginBottom:"16px",position:"relative"},ref:g,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Specializations (Categories)"}),e.jsx("div",{onClick:()=>u(!p),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:n.data.categoryIds&&n.data.categoryIds.length>0?n.data.categoryIds.map(l=>{const h=s.find(W=>W.id===l);return h?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:W=>{W.stopPropagation(),a({...n,data:{...n.data,categoryIds:n.data.categoryIds.filter(T=>T!==l)}})},children:[h.name,e.jsx(ce,{size:12})]},l):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),p&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:s.map(l=>{var W;const h=((W=n.data.categoryIds)==null?void 0:W.includes(l.id))||!1;return e.jsxs("div",{onClick:()=>{const T=n.data.categoryIds||[];a(h?{...n,data:{...n.data,categoryIds:T.filter(N=>N!==l.id)}}:{...n,data:{...n.data,categoryIds:[...T,l.id]}})},style:{padding:"10px 12px",cursor:"pointer",background:h?"#eff6ff":"white",color:h?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:T=>{h||(T.currentTarget.style.background="#f8fafc")},onMouseOut:T=>{h||(T.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:h,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:l.name})]},l.id)})})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(O,{variant:"outline",icon:ce,onClick:()=>{a({open:!1,data:{}}),m(null)},children:"Cancel"}),e.jsx(O,{type:"submit",icon:Le,children:j?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(l=>{const h=l.name?l.name.split(" ").map(T=>T[0]).join("").toUpperCase().slice(0,2):l.username.charAt(0).toUpperCase(),W=l.specializations?l.specializations.map(T=>T.category.name):[];return e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:l.profilePictureUrl?"transparent":"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",marginBottom:"8px",border:l.profilePictureUrl?"2px solid #e2e8f0":"none"},children:l.profilePictureUrl?e.jsx("img",{src:l.profilePictureUrl,alt:l.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"white",fontSize:"28px",fontWeight:"600"},children:h})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:l.name}),e.jsx("div",{style:{fontSize:"12px",color:"#64748b"},children:l.username})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:W.length>0?W.map((T,N)=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:T},N)):e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#f1f5f9",color:"#64748b",fontWeight:"500"},children:"All categories"})}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:l.isActive?"#ecfdf5":"#fef2f2",color:l.isActive?"#059669":"#dc2626",fontWeight:"600"},children:l.isActive?"Active":"Inactive"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{m(l),a({open:!0,data:{username:l.username,name:l.name,categoryIds:l.specializations?l.specializations.map(T=>T.categoryId):[]}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"25%"},onMouseOver:T=>{T.target.style.background="#eff6ff"},onMouseOut:T=>{T.target.style.background="transparent"},children:[e.jsx(tt,{size:14}),"Edit"]}),e.jsxs("button",{onClick:()=>B(l.id,l.name),style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"75%"},onMouseOver:T=>{T.target.style.background="#eff6ff"},onMouseOut:T=>{T.target.style.background="transparent"},children:[e.jsx(et,{size:14}),"Reset Password"]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",width:"100%"},children:[e.jsx(O,{variant:l.isActive?"danger":"success",icon:Mt,onClick:()=>f(l.id,l.isActive),style:{fontSize:"12px",padding:"6px 12px",flex:1},children:l.isActive?"Deactivate":"Activate"}),e.jsx(O,{variant:"danger",icon:Ve,onClick:()=>{w({open:!0,title:"Remove Staff",message:`Are you sure you want to remove ${l.name||l.username}? This cannot be undone and is only allowed if the staff has no serving history.`,onConfirm:async()=>{w({open:!1});try{await C.delete(`/admin/staff/${l.id}`),ee("Staff removed successfully!"),i()}catch(T){V(De(T,"Failed to remove staff"))}},onCancel:()=>w({open:!1})})},style:{fontSize:"12px",padding:"6px 12px",flex:1},children:"Remove"})]})]})]},l.id)})})]})}function xn({windows:t,onRefresh:s,form:i,setForm:n}){const[a,c]=o.useState(null),[j,m]=o.useState({open:!1}),p=async r=>{r.preventDefault();try{await C.post("/admin/windows",i.data),n({open:!1,data:{}}),ee("Window created successfully!"),s()}catch(w){V(De(w,"Failed to create window"))}},u=async r=>{r.preventDefault();try{await C.put(`/admin/windows/${a.id}`,i.data),n({open:!1,data:{}}),c(null),ee("Window updated successfully!"),s()}catch(w){V(De(w,"Failed to update window"))}},g=async r=>{m({open:!0,title:"Delete Window",message:"Are you sure you want to delete this window? This action cannot be undone.",onConfirm:async()=>{m({open:!1});try{await C.delete(`/admin/windows/${r}`),ee("Window deleted successfully!"),s()}catch(w){V(De(w,"Failed to delete window"))}},onCancel:()=>m({open:!1})})};return e.jsxs("div",{children:[e.jsx(ze,{...j}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Window Management"}),e.jsx(O,{icon:Ke,onClick:()=>{n({open:!0,data:{isActive:!0}}),c(null)},children:"Add Window"})]}),i.open&&Ne.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),c(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:a?"Edit Window":"Create Window"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),c(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsxs("form",{onSubmit:a?u:p,children:[e.jsx(ie,{label:"Window Label",value:i.data.label||"",onChange:r=>n({...i,data:{...i.data,label:r.target.value}}),required:!0}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx("input",{type:"checkbox",checked:i.data.isActive!==!1,onChange:r=>n({...i,data:{...i.data,isActive:r.target.checked}})}),"Active"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(O,{variant:"outline",icon:ce,onClick:()=>{n({open:!1,data:{}}),c(null)},children:"Cancel"}),e.jsx(O,{type:"submit",icon:Le,children:a?"Update":"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(r=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#2563eb",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(xt,{size:40,color:"white"})}),e.jsx("div",{style:{textAlign:"center",marginBottom:"8px"},children:e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:r.label})}),r.assignments&&r.assignments.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center",marginBottom:"8px"},children:r.assignments.map(w=>e.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"500"},children:w.staff.name},w.id))}),e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:r.isActive?"#ecfdf5":"#fef2f2",color:r.isActive?"#059669":"#dc2626",fontWeight:"600"},children:r.isActive?"Active":"Inactive"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{c(r),n({open:!0,data:{label:r.label,isActive:r.isActive}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:w=>{w.target.style.background="#eff6ff"},onMouseOut:w=>{w.target.style.background="transparent"},children:[e.jsx(tt,{size:14}),"Edit"]}),e.jsx(O,{variant:"danger",icon:Ve,onClick:()=>g(r.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})})]},r.id))})]})}function gn({categories:t,onRefresh:s,categoryForm:i,setCategoryForm:n,subCategoryForm:a,setSubCategoryForm:c}){const[j,m]=o.useState(null),[p,u]=o.useState({open:!1}),g=async f=>{var B,l;f.preventDefault();try{await C.post("/admin/categories",i.data),n({open:!1,data:{}}),ee("Category created successfully!"),s()}catch(h){V(((l=(B=h.response)==null?void 0:B.data)==null?void 0:l.error)||"Failed to create category")}},r=async f=>{var B,l;f.preventDefault();try{await C.put(`/admin/categories/${j.id}`,i.data),n({open:!1,data:{}}),m(null),ee("Category updated successfully!"),s()}catch(h){V(((l=(B=h.response)==null?void 0:B.data)==null?void 0:l.error)||"Failed to update category")}},w=async f=>{u({open:!0,title:"Delete Category",message:"Are you sure you want to delete this category? All subcategories will be deleted. This action cannot be undone.",onConfirm:async()=>{var B,l;u({open:!1});try{await C.delete(`/admin/categories/${f}`),ee("Category deleted successfully!"),s()}catch(h){V(((l=(B=h.response)==null?void 0:B.data)==null?void 0:l.error)||"Failed to delete category")}},onCancel:()=>u({open:!1})})},S=async f=>{var B,l;f.preventDefault();try{await C.post(`/admin/categories/${a.data.categoryId}/subcategories`,{name:a.data.name,description:a.data.description}),c({open:!1,data:{}}),ee("Subcategory created successfully!"),s()}catch(h){V(((l=(B=h.response)==null?void 0:B.data)==null?void 0:l.error)||"Failed to create subcategory")}},R=async f=>{u({open:!0,title:"Delete Subcategory",message:"Are you sure you want to delete this subcategory? This action cannot be undone.",onConfirm:async()=>{var B,l;u({open:!1});try{await C.delete(`/admin/subcategories/${f}`),ee("Subcategory deleted successfully!"),s()}catch(h){V(((l=(B=h.response)==null?void 0:B.data)==null?void 0:l.error)||"Failed to delete subcategory")}},onCancel:()=>u({open:!1})})};return e.jsxs("div",{children:[e.jsx(ze,{...p}),e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Category Management"}),e.jsx(O,{icon:Ke,onClick:()=>{n({open:!0,data:{}}),m(null)},children:"Add Category"})]}),i.open&&Ne.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{n({open:!1,data:{}}),m(null)},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:j?"Edit Category":"Create Category"}),e.jsx("button",{onClick:()=>{n({open:!1,data:{}}),m(null)},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsxs("form",{onSubmit:j?r:g,children:[e.jsx(ie,{label:"Category Name",value:i.data.name||"",onChange:f=>n({...i,data:{...i.data,name:f.target.value}}),required:!0}),e.jsx(ie,{label:"Description (Optional)",value:i.data.description||"",onChange:f=>n({...i,data:{...i.data,description:f.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(O,{variant:"outline",icon:ce,onClick:()=>{n({open:!1,data:{}}),m(null)},children:"Cancel"}),e.jsx(O,{type:"submit",icon:Le,children:j?"Update":"Create"})]})]})]})}),document.body),a.open&&Ne.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:()=>{c({open:!1,data:{}})},className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Add Subcategory"}),e.jsx("button",{onClick:()=>{c({open:!1,data:{}})},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsxs("form",{onSubmit:S,children:[e.jsx(ie,{label:"Subcategory Name",value:a.data.name||"",onChange:f=>c({...a,data:{...a.data,name:f.target.value}}),required:!0}),e.jsx(ie,{label:"Description (Optional)",value:a.data.description||"",onChange:f=>c({...a,data:{...a.data,description:f.target.value}})}),e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx(O,{variant:"outline",icon:ce,onClick:()=>{c({open:!1,data:{}})},children:"Cancel"}),e.jsx(O,{type:"submit",icon:Le,children:"Create"})]})]})]})}),document.body),e.jsx("div",{className:"admin-cards-grid",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"16px"},children:t.map(f=>e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.jsx(gt,{size:40,color:"white"})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"2px"},children:f.name}),f.description&&e.jsx("div",{style:{fontSize:"12px",color:"#64748b",lineHeight:"1.4"},children:f.description})]}),f.subCategories&&f.subCategories.length>0&&e.jsx("div",{style:{marginBottom:"8px"},children:e.jsxs("span",{style:{fontSize:"11px",padding:"4px 12px",borderRadius:"12px",background:"#eff6ff",color:"#2563eb",fontWeight:"600"},children:[f.subCategories.length," Subcategor",f.subCategories.length===1?"y":"ies"]})}),f.subCategories&&f.subCategories.length>0&&e.jsx("div",{style:{width:"100%",marginBottom:"8px",maxHeight:"120px",overflowY:"auto",padding:"8px",background:"#f8fafc",borderRadius:"8px"},children:f.subCategories.map(B=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",marginBottom:"4px",background:"white",borderRadius:"6px",fontSize:"12px"},children:[e.jsx("span",{style:{fontWeight:"500",color:"#1e293b"},children:B.name}),e.jsx("button",{onClick:()=>R(B.id),style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},onMouseOver:l=>{l.target.style.background="#fee2e2"},onMouseOut:l=>{l.target.style.background="transparent"},children:e.jsx(Ve,{size:12})})]},B.id))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"auto",width:"100%"},children:[e.jsx(O,{variant:"outline",icon:Ke,onClick:()=>{c({open:!0,data:{categoryId:f.id,name:"",description:""}})},style:{fontSize:"12px",padding:"6px 12px",width:"100%"},children:"Add Subcategory"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>{m(f),n({open:!0,data:{name:f.name,description:f.description||""}})},style:{fontSize:"12px",padding:"6px 12px",border:"none",background:"transparent",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"500",borderRadius:"6px",transition:"all 0.2s",width:"50%"},onMouseOver:B=>{B.target.style.background="#eff6ff"},onMouseOut:B=>{B.target.style.background="transparent"},children:[e.jsx(tt,{size:14}),"Edit"]}),e.jsx(O,{variant:"danger",icon:Ve,onClick:()=>w(f.id),style:{fontSize:"12px",padding:"6px 12px",width:"50%"},children:"Delete"})]})]})]},f.id))})]})}function fn({reports:t,filters:s,setFilters:i,staff:n,categories:a,showFilters:c,setShowFilters:j,onRefresh:m}){const[p,u]=o.useState(s),[g,r]=o.useState(!1),[w,S]=o.useState(!1),[R,f]=o.useState(!1),B=o.useRef(null),l=o.useRef(null),h=o.useRef(null);o.useEffect(()=>{c&&u(s)},[c]),o.useEffect(()=>{const y=I=>{B.current&&!B.current.contains(I.target)&&r(!1),l.current&&!l.current.contains(I.target)&&S(!1),h.current&&!h.current.contains(I.target)&&f(!1)};return(g||w||R)&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[g,w,R]);const W=["REGULAR","SENIOR_CITIZEN","PWD","PREGNANT"],T=Array.from({length:24},(y,I)=>I),N=()=>{const y=new Date().toISOString().split("T")[0],I={startDate:y,endDate:y,staffIds:[],categoryIds:[],clientTypes:[],startHour:"",endHour:""};i(I),u(I)},Y=()=>{i(p),j(!1)},J=()=>{u(s),j(!1)},te=s.staffIds.length>0||s.categoryIds.length>0||s.clientTypes.length>0||s.startHour||s.endHour;if(!t)return e.jsx(be,{});const re=t.byCategory?Object.entries(t.byCategory).map(([y,I])=>({name:y,value:I})):[],X=t.byClientType?Object.entries(t.byClientType).map(([y,I])=>({name:y,value:I})):[],ae=t.byStaff?Object.entries(t.byStaff).map(([y,I])=>({name:y,value:I})):[],ue=t.byHour?Object.entries(t.byHour).sort((y,I)=>parseInt(y[0])-parseInt(I[0])).map(([y,I])=>({hour:`${y}:00`,value:I})):[];return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600"},children:"Reports & Analytics"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[te&&e.jsxs("button",{onClick:N,style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:"#64748b",fontWeight:"500"},onMouseOver:y=>{y.target.style.color="#1e293b"},onMouseOut:y=>{y.target.style.color="#64748b"},children:[e.jsx(ce,{size:16}),"Clear Filters"]}),e.jsxs("button",{onClick:()=>j(!0),style:{fontSize:"14px",padding:"8px 16px",border:"none",background:"transparent",boxShadow:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",color:te?"#2563eb":"#64748b",fontWeight:"500"},onMouseOver:y=>{y.target.style.color="#2563eb"},onMouseOut:y=>{y.target.style.color=te?"#2563eb":"#64748b"},children:[e.jsx(Ft,{size:16}),"Filters"]})]})]}),c&&Ne.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:J,className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-box",style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",margin:0},children:"Filter Reports"}),e.jsx("button",{onClick:J,style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#64748b",display:"flex",alignItems:"center"},children:e.jsx(ce,{size:20})})]}),e.jsxs("div",{className:"admin-filter-grid",style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Date"}),e.jsx("input",{type:"date",value:p.startDate,onChange:y=>u({...p,startDate:y.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Date"}),e.jsx("input",{type:"date",value:p.endDate,onChange:y=>u({...p,endDate:y.target.value}),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{style:{position:"relative"},ref:B,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Staff"}),e.jsx("div",{onClick:()=>r(!g),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:p.staffIds&&p.staffIds.length>0?p.staffIds.map(y=>{const I=n.find(_=>_.id===y);return I?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:_=>{_.stopPropagation(),u({...p,staffIds:p.staffIds.filter(F=>F!==y)})},children:[I.name,e.jsx(ce,{size:12})]},y):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select staff..."})}),g&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:n.map(y=>{var _;const I=((_=p.staffIds)==null?void 0:_.includes(y.id))||!1;return e.jsxs("div",{onClick:()=>{const F=p.staffIds||[];u(I?{...p,staffIds:F.filter(P=>P!==y.id)}:{...p,staffIds:[...F,y.id]})},style:{padding:"10px 12px",cursor:"pointer",background:I?"#eff6ff":"white",color:I?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:F=>{I||(F.currentTarget.style.background="#f8fafc")},onMouseOut:F=>{I||(F.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:I,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:y.name})]},y.id)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{style:{position:"relative"},ref:l,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Categories"}),e.jsx("div",{onClick:()=>S(!w),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:p.categoryIds&&p.categoryIds.length>0?p.categoryIds.map(y=>{const I=a.find(_=>_.id===y);return I?e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:_=>{_.stopPropagation(),u({...p,categoryIds:p.categoryIds.filter(F=>F!==y)})},children:[I.name,e.jsx(ce,{size:12})]},y):null}):e.jsx("span",{style:{color:"#94a3b8"},children:"Select categories..."})}),w&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:a.map(y=>{var _;const I=((_=p.categoryIds)==null?void 0:_.includes(y.id))||!1;return e.jsxs("div",{onClick:()=>{const F=p.categoryIds||[];u(I?{...p,categoryIds:F.filter(P=>P!==y.id)}:{...p,categoryIds:[...F,y.id]})},style:{padding:"10px 12px",cursor:"pointer",background:I?"#eff6ff":"white",color:I?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:F=>{I||(F.currentTarget.style.background="#f8fafc")},onMouseOut:F=>{I||(F.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:I,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:y.name})]},y.id)})})]}),e.jsxs("div",{style:{position:"relative"},ref:h,children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Client Types"}),e.jsx("div",{onClick:()=>f(!R),style:{width:"100%",padding:"10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",backgroundColor:"white",cursor:"pointer",minHeight:"44px",display:"flex",alignItems:"center",flexWrap:"wrap",gap:"6px"},children:p.clientTypes&&p.clientTypes.length>0?p.clientTypes.map(y=>e.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",background:"#eff6ff",color:"#2563eb",fontWeight:"500",display:"flex",alignItems:"center",gap:"4px"},onClick:I=>{I.stopPropagation(),u({...p,clientTypes:p.clientTypes.filter(_=>_!==y)})},children:[y.replace("_"," "),e.jsx(ce,{size:12})]},y)):e.jsx("span",{style:{color:"#94a3b8"},children:"Select client types..."})}),R&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"white",border:"2px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:W.map(y=>{var _;const I=((_=p.clientTypes)==null?void 0:_.includes(y))||!1;return e.jsxs("div",{onClick:()=>{const F=p.clientTypes||[];u(I?{...p,clientTypes:F.filter(P=>P!==y)}:{...p,clientTypes:[...F,y]})},style:{padding:"10px 12px",cursor:"pointer",background:I?"#eff6ff":"white",color:I?"#2563eb":"#1e293b",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid #f1f5f9"},onMouseOver:F=>{I||(F.currentTarget.style.background="#f8fafc")},onMouseOut:F=>{I||(F.currentTarget.style.background="white")},children:[e.jsx("input",{type:"checkbox",checked:I,onChange:()=>{},style:{cursor:"pointer"}}),e.jsx("span",{children:y.replace("_"," ")})]},y)})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"Start Hour (Peak Hours)"}),e.jsxs($e,{value:p.startHour,onChange:y=>u({...p,startHour:y.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),T.map(y=>e.jsxs("option",{value:y,children:[String(y).padStart(2,"0"),":00"]},y))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"14px",fontWeight:"500"},children:"End Hour (Peak Hours)"}),e.jsxs($e,{value:p.endHour,onChange:y=>u({...p,endHour:y.target.value}),children:[e.jsx("option",{value:"",children:"All Hours"}),T.map(y=>e.jsxs("option",{value:y,children:[String(y).padStart(2,"0"),":00"]},y))]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"24px",paddingTop:"24px",borderTop:"1px solid #e2e8f0"},children:[e.jsx(O,{variant:"outline",icon:ce,onClick:J,children:"Cancel"}),e.jsx(O,{variant:"primary",icon:Le,onClick:Y,children:"Apply Filters"})]})]})}),document.body),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[e.jsx(me,{label:"Total Served",value:t.totalServed}),e.jsx(me,{label:"Average Duration",value:`${Math.floor((t.averageDuration||0)/60)}m ${(t.averageDuration||0)%60}s`})]}),e.jsxs("div",{className:"admin-reports-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"24px"},children:[re.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Category"}),e.jsx(We,{width:"100%",height:300,children:e.jsxs(Je,{data:re,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Fe,{dataKey:"name"}),e.jsx(Ue,{}),e.jsx(Pe,{}),e.jsx(Xe,{dataKey:"value",fill:"#2563eb"})]})})]}),X.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Client Type"}),e.jsx(We,{width:"100%",height:300,children:e.jsxs(ft,{children:[e.jsx(ht,{data:X,cx:"50%",cy:"50%",labelLine:!1,label:({name:y,percent:I})=>`${y}: ${(I*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:X.map((y,I)=>e.jsx(mt,{fill:rt[I%rt.length]},`cell-${I}`))}),e.jsx(Pe,{})]})})]})]}),ue.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"24px"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"Peak Hours"}),e.jsx(We,{width:"100%",height:300,children:e.jsxs($t,{data:ue,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Fe,{dataKey:"hour"}),e.jsx(Ue,{}),e.jsx(Pe,{}),e.jsx(Yt,{type:"monotone",dataKey:"value",stroke:"#2563eb",strokeWidth:2})]})})]}),ae.length>0&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h3",{style:{marginBottom:"16px"},children:"By Staff"}),e.jsx(We,{width:"100%",height:300,children:e.jsxs(Je,{data:ae,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(Fe,{dataKey:"name"}),e.jsx(Ue,{}),e.jsx(Pe,{}),e.jsx(Xe,{dataKey:"value",fill:"#10b981"})]})})]})]})}function hn(){const[t,s]=o.useState(null),[i,n]=o.useState(null),[a,c]=o.useState(null),[j,m]=o.useState(!0),[p,u]=o.useState(!1),[g,r]=o.useState({open:!1}),[w,S]=o.useState(null),[R,f]=o.useState(null),[B,l]=o.useState(!1),[h,W]=o.useState({open:!1}),[T,N]=o.useState([{id:"",name:""},{id:"",name:""},{id:"",name:""}]),[Y,J]=o.useState(""),[te,re]=o.useState(!1),[X,ae]=o.useState("youtube"),[ue,y]=o.useState(!1),[I,_]=o.useState(""),[F,P]=o.useState(!1),[U,Q]=o.useState("50"),[d,A]=o.useState(!1),[M,ne]=o.useState("branding"),[xe,ge]=o.useState({open:!1}),[we,le]=o.useState(!1);o.useEffect(()=>{Se(),Te(),Ce(),Ye(),Ge(),_e()},[]);const Se=async()=>{try{const x=await C.get("/admin/settings/logo");x.data.logoUrl&&c(x.data.logoUrl)}catch(x){console.error("Failed to load logo:",x)}finally{m(!1)}},Te=async()=>{try{const x=await C.get("/admin/settings/ding-sound");x.data.dingSoundUrl&&f(x.data.dingSoundUrl)}catch(x){console.error("Failed to load ding sound:",x)}},Ce=async()=>{var x;try{const v=await C.get("/admin/settings/tts-voices"),D=Array.isArray(v.data.voices)?v.data.voices:[],L=[...D];for(;L.length<3;)L.push({id:"",name:""});N(L.slice(0,3)),v.data.activeVoiceId?J(v.data.activeVoiceId):(x=D[0])!=null&&x.id&&J(D[0].id)}catch(v){console.error("Failed to load TTS voices:",v)}},Ye=async()=>{try{const x=await C.get("/admin/settings/video-source");ae(x.data.videoSource||"youtube")}catch(x){console.error("Failed to load video source:",x)}},_e=async()=>{try{const v=(await C.get("/admin/settings/video-volume")).data.videoVolumePercent;typeof v=="number"&&!Number.isNaN(v)&&Q(String(Math.max(0,Math.min(100,v))))}catch(x){console.error("Failed to load video volume:",x)}},Ge=async()=>{try{const v=(await C.get("/admin/settings/youtube-playlist")).data.urls||[];_(v.join(`
`))}catch(x){console.error("Failed to load YouTube playlist:",x)}},ke=async x=>{var v,D;y(!0);try{await C.post("/admin/settings/video-source",{videoSource:x}),ae(x),ee("Video source updated successfully!")}catch(L){V(((D=(v=L.response)==null?void 0:v.data)==null?void 0:D.error)||"Failed to save video source")}finally{y(!1)}},b=async x=>{var D,L;x.preventDefault();const v=I.split(`
`).map(H=>H.trim()).filter(H=>H);P(!0);try{await C.post("/admin/settings/youtube-playlist",{urls:v}),ee("YouTube playlist saved!")}catch(H){V(((L=(D=H.response)==null?void 0:D.data)==null?void 0:L.error)||"Failed to save playlist")}finally{P(!1)}},E=x=>{const v=x.target.files[0];if(v){s(v);const D=new FileReader;D.onloadend=()=>{n(D.result)},D.readAsDataURL(v)}},k=async x=>{var v,D;if(x.preventDefault(),!!t){u(!0);try{const L=new FormData;L.append("logo",t);const H=await C.post("/admin/settings/logo",L,{headers:{"Content-Type":"multipart/form-data"}});c(H.data.logoUrl),s(null),n(null),ee("Logo uploaded successfully!")}catch(L){console.error("Failed to upload logo:",L),V(((D=(v=L.response)==null?void 0:v.data)==null?void 0:D.error)||"Failed to upload logo")}finally{u(!1)}}},q=async()=>{r({open:!0,title:"Delete Logo",message:"Are you sure you want to delete the current logo?",onConfirm:async()=>{var x,v;r({open:!1});try{await C.delete("/admin/settings/logo"),c(null),s(null),n(null),ee("Logo deleted successfully!")}catch(D){console.error("Failed to delete logo:",D),V(((v=(x=D.response)==null?void 0:x.data)==null?void 0:v.error)||"Failed to delete logo")}},onCancel:()=>r({open:!1})})},$=x=>{const v=x.target.files[0];v&&S(v)},K=async x=>{var v,D;if(x.preventDefault(),!!w){l(!0);try{const L=new FormData;L.append("sound",w);const H=await C.post("/admin/settings/ding-sound",L,{headers:{"Content-Type":"multipart/form-data"}});f(H.data.dingSoundUrl),S(null),ee("Ding sound uploaded successfully!")}catch(L){console.error("Failed to upload ding sound:",L),V(((D=(v=L.response)==null?void 0:v.data)==null?void 0:D.error)||"Failed to upload ding sound")}finally{l(!1)}}},G=async()=>{W({open:!0,title:"Delete Ding Sound",message:"Are you sure you want to delete the current ding sound?",onConfirm:async()=>{var x,v;W({open:!1});try{await C.delete("/admin/settings/ding-sound"),f(null),S(null),ee("Ding sound deleted successfully!")}catch(D){console.error("Failed to delete ding sound:",D),V(((v=(x=D.response)==null?void 0:x.data)==null?void 0:v.error)||"Failed to delete ding sound")}},onCancel:()=>W({open:!1})})},Z=async x=>{const v=typeof x=="string"?x.trim():"";if(!v){V("Please enter a voice ID first");return}const D="Window 1 will now serve number 123, or John Doe.";try{const H=(await C.post("/tts",{text:D,voiceId:v},{responseType:"arraybuffer"})).data;if(!H)return;const pe=new Blob([H],{type:"audio/mpeg"}),se=URL.createObjectURL(pe);new Audio(se).play().catch(de=>{console.error("Failed to play preview TTS audio:",de)}).finally(()=>{URL.revokeObjectURL(se)})}catch(L){console.error("Failed to preview TTS voice:",L),V("Failed to preview this voice. Please check your ElevenLabs settings.")}},z=(x,v,D)=>{N(L=>{const H=[...L];return H[x]={...H[x],[v]:D},H})},oe=async x=>{var v,D;x.preventDefault(),re(!0);try{const L=T.map(de=>({id:(de.id||"").trim(),name:(de.name||"").trim()})).filter(de=>de.id);if(L.length===0){V("Please enter at least one ElevenLabs voice ID"),re(!1);return}const H=Y&&L.some(de=>de.id===Y)?Y:L[0].id,pe=await C.post("/admin/settings/tts-voices",{voices:L,activeVoiceId:H}),fe=[...Array.isArray(pe.data.voices)?pe.data.voices:L];for(;fe.length<3;)fe.push({id:"",name:""});N(fe.slice(0,3)),J(pe.data.activeVoiceId||H),ee("TTS voices updated successfully!")}catch(L){console.error("Failed to save TTS voices:",L),V(((D=(v=L.response)==null?void 0:v.data)==null?void 0:D.error)||"Failed to save TTS voices")}finally{re(!1)}};return j?e.jsx(be,{}):e.jsxs("div",{children:[e.jsx(ze,{...g}),e.jsx(ze,{...h}),e.jsx(ze,{...xe}),e.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"16px"},children:"Settings"}),e.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"24px",borderBottom:"1px solid #e2e8f0",paddingBottom:"4px",overflowX:"auto"},children:[{id:"branding",label:"Branding"},{id:"audio",label:"Audio & TTS"},{id:"videos",label:"Videos"},{id:"data",label:"Data"}].map(x=>{const v=M===x.id;return e.jsx("button",{type:"button",onClick:()=>ne(x.id),style:{padding:"8px 16px",borderRadius:"9999px",border:"none",backgroundColor:v?"#1d4ed8":"transparent",color:v?"#ffffff":"#475569",fontSize:"14px",fontWeight:v?600:500,cursor:"pointer",boxShadow:v?"0 1px 3px rgba(15, 23, 42, 0.25)":"none",whiteSpace:"nowrap"},children:x.label},x.id)})}),M==="branding"&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #2563eb"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Logo"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a logo to display across all pages. Supported formats: JPG, PNG, GIF, SVG, WebP (max 5MB)"}),a&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Logo:"}),e.jsx("img",{src:a,alt:"Current logo",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Logo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:E,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),i&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Preview:"}),e.jsx("img",{src:i,alt:"Preview",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px"}})]}),e.jsxs("div",{className:"admin-settings-buttons",style:{display:"flex",gap:"8px"},children:[e.jsx(O,{type:"submit",disabled:!t||p,children:p?"Uploading...":"Upload Logo"}),a&&e.jsx(O,{variant:"danger",onClick:q,children:"Delete Logo"})]})]})]})}),M==="audio"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #f97316"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Ding Sound (Announcement Chime)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Upload a short audio file to play before each queue announcement on the public monitoring page. Supported formats: MP3, WAV, OGG, M4A, AAC (max 2MB). Keep it brief (under 2 seconds) for best results."}),R&&e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"8px"},children:"Current Ding Sound:"}),e.jsx("audio",{controls:!0,src:R,style:{width:"100%",maxWidth:"400px"},children:"Your browser does not support the audio element."})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Upload New Ding Sound"}),e.jsx("input",{type:"file",accept:"audio/*",onChange:$,style:{width:"100%",padding:"8px",border:"2px solid #e2e8f0",borderRadius:"8px",fontSize:"14px"}})]}),e.jsxs("div",{className:"admin-settings-buttons",style:{display:"flex",gap:"8px"},children:[e.jsx(O,{type:"submit",disabled:!w||B,children:B?"Uploading...":"Upload Ding Sound"}),R&&e.jsx(O,{variant:"danger",onClick:G,children:"Delete Ding Sound"})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #10b981"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Text-to-Speech Voices (ElevenLabs)"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:"Configure up to three ElevenLabs voice IDs and choose which one is active for queue announcements. Voice IDs can be copied from your ElevenLabs dashboard."}),e.jsxs("form",{onSubmit:oe,children:[T.map((x,v)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1.2fr) minmax(0, 1.4fr) auto",gap:"12px",marginBottom:"12px",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",v+1," Name (optional)"]}),e.jsx("input",{type:"text",value:x.name||"",onChange:D=>z(v,"name",D.target.value),placeholder:"e.g. Front Desk Female",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"13px",fontWeight:"500"},children:["Voice ",v+1," ID"]}),e.jsx("input",{type:"text",value:x.id||"",onChange:D=>z(v,"id",D.target.value),placeholder:"ElevenLabs voice ID",style:{width:"100%",padding:"8px 10px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"6px"},children:[e.jsx("button",{type:"button",onClick:()=>Z(x.id),disabled:!x.id,style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",backgroundColor:x.id?"#eff6ff":"#f8fafc",color:x.id?"#2563eb":"#94a3b8",fontSize:"12px",fontWeight:500,cursor:x.id?"pointer":"not-allowed"},children:"Preview Voice"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px"},children:[e.jsx("input",{type:"radio",name:"activeVoice",checked:!!x.id&&Y===x.id,disabled:!x.id,onChange:()=>{x.id&&J(x.id)}}),"Active"]})]})]},v)),e.jsx("div",{style:{marginTop:"16px",display:"flex",gap:"8px"},children:e.jsx(O,{type:"submit",disabled:te,children:te?"Saving Voices...":"Save Voices"})})]})]})]}),M==="videos"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #6366f1"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Video Source"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"20px"},children:[e.jsx("strong",{children:"YouTube"})," plays videos from a playlist you define. ",e.jsx("strong",{children:"Local"})," lets the display pick a folder on that computer."]}),e.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",border:`2px solid ${X==="youtube"?"#6366f1":"#e2e8f0"}`,borderRadius:"8px",cursor:"pointer",backgroundColor:X==="youtube"?"#eef2ff":"transparent"},children:[e.jsx("input",{type:"radio",name:"videoSource",value:"youtube",checked:X==="youtube",onChange:()=>ke("youtube"),disabled:ue}),e.jsxs("span",{children:[e.jsx("strong",{children:"YouTube"})," â€“ Playlist from admin-defined URLs"]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",border:`2px solid ${X==="local"?"#6366f1":"#e2e8f0"}`,borderRadius:"8px",cursor:"pointer",backgroundColor:X==="local"?"#eef2ff":"transparent"},children:[e.jsx("input",{type:"radio",name:"videoSource",value:"local",checked:X==="local",onChange:()=>ke("local"),disabled:ue}),e.jsxs("span",{children:[e.jsx("strong",{children:"Local"})," â€“ Folder on the display computer"]})]})]})]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #0ea5e9"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px"},children:"Default video volume"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"16px"},children:"Set the default playback volume for monitor videos (0 to 100%). This is applied when the monitor page starts."}),e.jsxs("form",{onSubmit:async x=>{var D,L;x.preventDefault();const v=Number(U);if(!Number.isFinite(v)||v<0||v>100){V("Volume must be a number between 0 and 100.");return}A(!0);try{await C.post("/admin/settings/video-volume",{videoVolumePercent:v}),Q(String(Math.round(v))),ee("Default video volume saved.")}catch(H){V(((L=(D=H.response)==null?void 0:D.data)==null?void 0:L.error)||"Failed to save video volume")}finally{A(!1)}},style:{maxWidth:"260px",display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx("label",{style:{fontSize:"14px",fontWeight:"500",color:"#1e293b"},children:"Volume (0â€“100%)"}),e.jsx("input",{type:"number",min:0,max:100,value:U,onChange:x=>Q(x.target.value.replace(/[^\d]/g,"").slice(0,3)),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px"}}),e.jsx("div",{style:{fontSize:"12px",color:"#94a3b8"},children:"Example: 0 = muted, 50 = half volume, 100 = full volume."}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx(O,{type:"submit",disabled:d,children:d?"Saving...":"Save volume"})})]})]}),X==="youtube"&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #6366f1"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"YouTube Playlist"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"List YouTube URLs (one per line). Videos play in order on the monitor. Supports youtube.com/watch?v= and youtu.be/ links."}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"YouTube URLs"}),e.jsx("textarea",{value:I,onChange:x=>_(x.target.value),placeholder:`https://www.youtube.com/watch?v=VIDEO_ID
https://youtu.be/VIDEO_ID`,rows:8,style:{width:"100%",padding:"12px 16px",borderRadius:"8px",border:"2px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",color:"#1e293b",resize:"vertical",boxSizing:"border-box"},onFocus:x=>{x.target.style.borderColor="#2563eb",x.target.style.backgroundColor="#ffffff"},onBlur:x=>{x.target.style.borderColor="#e2e8f0",x.target.style.backgroundColor="#f8fafc"}})]}),e.jsx(O,{type:"submit",disabled:F,children:F?"Saving...":"Save Playlist"})]})]}),X==="local"&&e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderLeft:"4px solid #22c55e"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px"},children:"Local videos"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:"When the monitoring page loads, the user will select a folder containing video files. Videos play directly from that computer. Works in Chrome and Edge."})]})]}),M==="data"&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderTop:"3px solid #dc2626"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"Reset queue stats"}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",marginBottom:"24px"},children:"Permanently delete all queue entries, serving logs, and daily queue counters. Staff, windows, and categories are not affected. This cannot be undone."}),e.jsx(O,{variant:"danger",disabled:we,onClick:()=>{ge({open:!0,title:"Reset all queue stats?",message:"This will delete all queue entries, serving logs, and daily counters. Staff, windows, and categories will be kept. This action cannot be undone.",onConfirm:async()=>{var x,v;ge({open:!1}),le(!0);try{await C.post("/admin/settings/reset-queue-stats"),ee("Queue stats reset successfully.")}catch(D){V(((v=(x=D.response)==null?void 0:x.data)==null?void 0:v.error)||"Failed to reset queue stats")}finally{le(!1)}},onCancel:()=>ge({open:!1})})},children:we?"Resetting...":"Reset queue stats"})]})})]})}function mn(){const t=ye(),[s,i]=o.useState(!0),[n,a]=o.useState(null),[c,j]=o.useState(""),[m,p]=o.useState(!1),[u,g]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[r,w]=o.useState(!1),[S,R]=o.useState(!1);o.useEffect(()=>{const h=localStorage.getItem("token"),W=Ie();if(!h||(W==null?void 0:W.role)!=="ADMIN"){t("/admin/login");return}f()},[t]),o.useEffect(()=>{j((n==null?void 0:n.name)??"")},[n==null?void 0:n.name]);const f=async()=>{var h;try{const W=await C.get("/admin/profile");a(W.data.admin)}catch(W){console.error("Failed to load profile:",W),((h=W.response)==null?void 0:h.status)===401&&t("/admin/login")}finally{i(!1)}},B=async h=>{var T,N,Y,J,te,re;h.preventDefault();const W=(c??"").trim();R(!0);try{const X=await C.put("/admin/profile",{name:W||null});a(X.data.admin);const ae=Ie();ae&&(ae.name=X.data.admin.name??null,localStorage.setItem("user",JSON.stringify(ae))),ee("Name updated successfully")}catch(X){V(((N=(T=X.response)==null?void 0:T.data)==null?void 0:N.error)||((re=(te=(J=(Y=X.response)==null?void 0:Y.data)==null?void 0:J.errors)==null?void 0:te[0])==null?void 0:re.msg)||"Failed to update name")}finally{R(!1)}},l=async h=>{var W,T;if(h.preventDefault(),u.newPassword!==u.confirmPassword){V("New passwords do not match");return}if(u.newPassword.length<6){V("Password must be at least 6 characters");return}w(!0);try{await C.post("/admin/profile/change-password",{currentPassword:u.currentPassword,newPassword:u.newPassword}),ee("Password changed successfully!"),p(!1),g({currentPassword:"",newPassword:"",confirmPassword:""})}catch(N){V(((T=(W=N.response)==null?void 0:W.data)==null?void 0:T.error)||"Failed to change password")}finally{w(!1)}};return s?e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(be,{})}):e.jsxs("div",{className:"admin-profile-root",style:{minHeight:"100vh",background:"#f8fafc"},children:[e.jsx("style",{children:`
        .admin-profile-root { padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
        @media (max-width: 768px) {
          .admin-profile-header { flex-wrap: wrap; gap: 12px; padding: 12px 16px !important; }
          .admin-profile-content { margin: 24px auto !important; padding: 0 16px !important; }
          .admin-profile-card { padding: 24px !important; }
        }
      `}),e.jsxs("div",{className:"admin-profile-header",style:{background:"white",borderBottom:"1px solid #e2e8f0",padding:"16px 24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ve,{size:"small"}),e.jsx(O,{variant:"outline",icon:ct,onClick:()=>t("/admin/dashboard"),children:"Back to Dashboard"})]}),e.jsx("div",{className:"admin-profile-content",style:{maxWidth:"600px",margin:"40px auto",padding:"0 24px"},children:e.jsxs("div",{className:"admin-profile-card",style:{background:"white",borderRadius:"12px",padding:"32px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"24px",color:"#1e293b"},children:"Admin Profile"}),e.jsxs("form",{onSubmit:B,children:[e.jsx(ie,{label:"Name",value:c,onChange:h=>j(h.target.value),placeholder:"Your display name"}),e.jsx(O,{type:"submit",icon:pt,disabled:S,style:{marginTop:"16px"},children:S?"Saving...":"Save name"})]}),e.jsx("div",{style:{marginTop:"24px"},children:e.jsx(ie,{label:"Username",value:(n==null?void 0:n.username)||"",disabled:!0,readOnly:!0,style:{background:"#f1f5f9",color:"#64748b",cursor:"not-allowed",border:"2px solid #e2e8f0",borderRadius:"8px",padding:"12px"}})}),e.jsxs("div",{style:{marginTop:"32px",paddingTop:"32px",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Change Password"}),e.jsx(O,{variant:"outline",icon:et,onClick:()=>{p(!m),m&&g({currentPassword:"",newPassword:"",confirmPassword:""})},children:m?"Cancel":"Change Password"})]}),m&&e.jsxs("form",{onSubmit:l,children:[e.jsx(ie,{label:"Current Password",type:"password",value:u.currentPassword,onChange:h=>g({...u,currentPassword:h.target.value}),required:!0}),e.jsx(ie,{label:"New Password",type:"password",value:u.newPassword,onChange:h=>g({...u,newPassword:h.target.value}),required:!0}),e.jsx(ie,{label:"Confirm New Password",type:"password",value:u.confirmPassword,onChange:h=>g({...u,confirmPassword:h.target.value}),required:!0}),e.jsx(O,{type:"submit",icon:ut,disabled:r,style:{marginTop:"16px"},children:r?"Changing...":"Change Password"})]})]})]})})]})}function yn(){return o.useEffect(()=>{let t=document.querySelector('link[rel="icon"]');t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t));const s=c=>{const j=c&&!c.startsWith("http")&&!c.startsWith("data:")?c.startsWith("/")?window.location.origin+c:window.location.origin+"/"+c:c;t.href=j},i="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23667eea' rx='12'/%3E%3Ctext x='50' y='68' font-size='60' font-weight='bold' dominant-baseline='middle' text-anchor='middle' fill='white' font-family='system-ui,sans-serif'%3EQ%3C/text%3E%3C/svg%3E",n=async()=>{var c;try{const j=await C.get("/admin/settings/logo");(c=j.data)!=null&&c.logoUrl?s(j.data.logoUrl):s(i)}catch{s(i)}};n();const a=setInterval(n,3e4);return()=>clearInterval(a)},[]),null}function bn(){return e.jsxs(e.Fragment,{children:[e.jsx(yn,{}),e.jsx(on,{}),e.jsxs(Ut,{children:[e.jsx(he,{path:"/",element:e.jsx(Qt,{})}),e.jsx(he,{path:"/success",element:e.jsx(Jt,{})}),e.jsx(he,{path:"/thank-you",element:e.jsx(Xt,{})}),e.jsx(he,{path:"/monitor",element:e.jsx(Zt,{})}),e.jsx(he,{path:"/staff/login",element:e.jsx(en,{})}),e.jsx(he,{path:"/staff/dashboard",element:e.jsx(an,{})}),e.jsx(he,{path:"/staff/profile",element:e.jsx(sn,{})}),e.jsx(he,{path:"/admin/login",element:e.jsx(rn,{})}),e.jsx(he,{path:"/admin/dashboard",element:e.jsx(cn,{})}),e.jsx(he,{path:"/admin/profile",element:e.jsx(mn,{})})]})]})}Vt.createRoot(document.getElementById("root")).render(e.jsx(Ht.StrictMode,{children:e.jsx(qt,{children:e.jsx(bn,{})})}));
